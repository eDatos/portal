/*! stat4you-web 2013-07-25 */
function css_browser_selector(t){var e=t.toLowerCase(),n=function(t){return e.indexOf(t)>-1},i="gecko",r="webkit",a="safari",s="opera",o="mobile",l=document.documentElement,u=[!/opera|webtv/i.test(e)&&/msie\s(\d)/.test(e)?"ie ie"+RegExp.$1:n("firefox/2")?i+" ff2":n("firefox/3.5")?i+" ff3 ff3_5":n("firefox/3.6")?i+" ff3 ff3_6":n("firefox/3")?i+" ff3":n("gecko/")?i:n("opera")?s+(/version\/(\d+)/.test(e)?" "+s+RegExp.$1:/opera(\s|\/)(\d+)/.test(e)?" "+s+RegExp.$2:""):n("konqueror")?"konqueror":n("blackberry")?o+" blackberry":n("android")?o+" android":n("chrome")?r+" chrome":n("iron")?r+" iron":n("applewebkit/")?r+" "+a+(/version\/(\d+)/.test(e)?" "+a+RegExp.$1:""):n("mozilla/")?i:"",n("j2me")?o+" j2me":n("iphone")?o+" iphone":n("ipod")?o+" ipod":n("ipad")?o+" ipad":n("mac")?"mac":n("darwin")?"mac":n("webtv")?"webtv":n("win")?"win"+(n("windows nt 6.0")?" vista":""):n("freebsd")?"freebsd":n("x11")||n("linux")?"linux":"","js"];return c=u.join(" "),l.className+=" "+c,c}function LRUCache(t){this.size=0,this.limit=t,this._keymap={}}checkOverflow=function(t){var e=t.style.overflow;e&&"visible"!==e||(t.style.overflow="hidden");var n=t.clientWidth<t.scrollWidth||t.clientHeight<t.scrollHeight;return t.style.overflow=e,n},function($){var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};$.toJSON="object"==typeof JSON&&JSON.stringify?JSON.stringify:function(t){if(null===t)return"null";var e=typeof t;if("undefined"===e)return void 0;if("number"===e||"boolean"===e)return""+t;if("string"===e)return $.quoteString(t);if("object"===e){if("function"==typeof t.toJSON)return $.toJSON(t.toJSON());if(t.constructor===Date){var n=t.getUTCMonth()+1,i=t.getUTCDate(),r=t.getUTCFullYear(),a=t.getUTCHours(),s=t.getUTCMinutes(),o=t.getUTCSeconds(),l=t.getUTCMilliseconds();return 10>n&&(n="0"+n),10>i&&(i="0"+i),10>a&&(a="0"+a),10>s&&(s="0"+s),10>o&&(o="0"+o),100>l&&(l="0"+l),10>l&&(l="0"+l),'"'+r+"-"+n+"-"+i+"T"+a+":"+s+":"+o+"."+l+'Z"'}if(t.constructor===Array){for(var c=[],u=0;t.length>u;u++)c.push($.toJSON(t[u])||"null");return"["+c.join(",")+"]"}var h,d,f=[];for(var p in t){if(e=typeof p,"number"===e)h='"'+p+'"';else{if("string"!==e)continue;h=$.quoteString(p)}e=typeof t[p],"function"!==e&&"undefined"!==e&&(d=$.toJSON(t[p]),f.push(h+":"+d))}return"{"+f.join(",")+"}"}},$.evalJSON="object"==typeof JSON&&JSON.parse?JSON.parse:function(src){return eval("("+src+")")},$.secureEvalJSON="object"==typeof JSON&&JSON.parse?JSON.parse:function(src){var filtered=src.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"");if(/^[\],:{}\s]*$/.test(filtered))return eval("("+src+")");throw new SyntaxError("Error parsing JSON, source is not valid.")},$.quoteString=function(t){return t.match(escapeable)?'"'+t.replace(escapeable,function(t){var e=meta[t];return"string"==typeof e?e:(e=t.charCodeAt(),"\\u00"+Math.floor(e/16).toString(16)+(e%16).toString(16))})+'"':'"'+t+'"'}}(jQuery),function(t){t.fn.disableTextSelect=function(){return this.each(function(){t(this).bind("mousedown.disableTextSelect",function(){return!1}),t(this).bind("selectstart.disableTextSelect",function(){return!1})})},t.fn.enableTextSelect=function(){return this.each(function(){t(this).unbind("mousedown.disableTextSelect"),t(this).unbind("selectstart.disableTextSelect")})}}(jQuery),css_browser_selector(navigator.userAgent),function(t,e,n){function i(t,n){var i,r=e.createElement(t||"div");for(i in n)r[i]=n[i];return r}function r(t){for(var e=1,n=arguments.length;n>e;e++)t.appendChild(arguments[e]);return t}function a(t,e,n,i){var r=["opacity",e,~~(100*t),n,i].join("-"),a=.01+100*(n/i),s=Math.max(1-(1-t)/e*(100-a),t),o=u.substring(0,u.indexOf("Animation")).toLowerCase(),l=o&&"-"+o+"-"||"";return d[r]||(f.insertRule("@"+l+"keyframes "+r+"{"+"0%{opacity:"+s+"}"+a+"%{opacity:"+t+"}"+(a+.01)+"%{opacity:1}"+(a+e)%100+"%{opacity:"+t+"}"+"100%{opacity:"+s+"}"+"}",0),d[r]=1),r}function s(t,e){var i,r,a=t.style;if(a[e]!==n)return e;for(e=e.charAt(0).toUpperCase()+e.slice(1),r=0;h.length>r;r++)if(i=h[r]+e,a[i]!==n)return i}function o(t,e){for(var n in e)t.style[s(t,n)||n]=e[n];return t}function l(t){for(var e=1;arguments.length>e;e++){var i=arguments[e];for(var r in i)t[r]===n&&(t[r]=i[r])}return t}function c(t){for(var e={x:t.offsetLeft,y:t.offsetTop};t=t.offsetParent;)e.x+=t.offsetLeft,e.y+=t.offsetTop;return e}var u,h=["webkit","Moz","ms","O"],d={},f=function(){var t=i("style");return r(e.getElementsByTagName("head")[0],t),t.sheet||t.styleSheet}(),p={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto"},g=function m(t){return this.spin?(this.opts=l(t||{},m.defaults,p),void 0):new m(t)};g.defaults={},l(g.prototype,{spin:function(t){this.stop();var e,n,r=this,a=r.opts,s=r.el=o(i(0,{className:a.className}),{position:"relative",zIndex:a.zIndex}),l=a.radius+a.length+a.width;if(t&&(t.insertBefore(s,t.firstChild||null),n=c(t),e=c(s),o(s,{left:("auto"==a.left?n.x-e.x+(t.offsetWidth>>1):a.left+l)+"px",top:("auto"==a.top?n.y-e.y+(t.offsetHeight>>1):a.top+l)+"px"})),s.setAttribute("aria-role","progressbar"),r.lines(s,r.opts),!u){var h=0,d=a.fps,f=d/a.speed,p=(1-a.opacity)/(f*a.trail/100),g=f/a.lines;!function m(){h++;for(var t=a.lines;t;t--){var e=Math.max(1-(h+t*g)%f*p,a.opacity);r.opacity(s,a.lines-t,e,a)}r.timeout=r.el&&setTimeout(m,~~(1e3/d))}()}return r},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=n),this},lines:function(t,e){function n(t,n){return o(i(),{position:"absolute",width:e.length+e.width+"px",height:e.width+"px",background:t,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/e.lines*l+e.rotate)+"deg) translate("+e.radius+"px"+",0)",borderRadius:(e.width>>1)+"px"})}for(var s,l=0;e.lines>l;l++)s=o(i(),{position:"absolute",top:1+~(e.width/2)+"px",transform:e.hwaccel?"translate3d(0,0,0)":"",opacity:e.opacity,animation:u&&a(e.opacity,e.trail,l,e.lines)+" "+1/e.speed+"s linear infinite"}),e.shadow&&r(s,o(n("#000","0 0 4px #000"),{top:"2px"})),r(t,r(s,n(e.color,"0 0 1px rgba(0,0,0,.1)")));return t},opacity:function(t,e,n){t.childNodes.length>e&&(t.childNodes[e].style.opacity=n)}}),!function(){function t(t,e){return i("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',e)}var e=o(i("group"),{behavior:"url(#default#VML)"});!s(e,"transform")&&e.adj?(f.addRule(".spin-vml","behavior:url(#default#VML)"),g.prototype.lines=function(e,n){function i(){return o(t("group",{coordsize:c+" "+c,coordorigin:-l+" "+-l}),{width:c,height:c})}function a(e,a,s){r(h,r(o(i(),{rotation:360/n.lines*e+"deg",left:~~a}),r(o(t("roundrect",{arcsize:1}),{width:l,height:n.width,left:n.radius,top:-n.width>>1,filter:s}),t("fill",{color:n.color,opacity:n.opacity}),t("stroke",{opacity:0}))))}var s,l=n.length+n.width,c=2*l,u=2*-(n.width+n.length)+"px",h=o(i(),{position:"absolute",top:u,left:u});if(n.shadow)for(s=1;n.lines>=s;s++)a(s,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(s=1;n.lines>=s;s++)a(s);return r(e,h)},g.prototype.opacity=function(t,e,n,i){var r=t.firstChild;i=i.shadow&&i.lines||0,r&&r.childNodes.length>e+i&&(r=r.childNodes[e+i],r=r&&r.firstChild,r=r&&r.firstChild,r&&(r.opacity=n))}):u=s(e,"animation")}(),t.Spinner=g}(window,document),function(){function t(t,e){var n;t||(t={});for(n in e)t[n]=e[n];return t}function e(){var t,e=arguments.length,n={},i=function(t,e){var n,r;for(r in e)e.hasOwnProperty(r)&&(n=e[r],"object"!=typeof t&&(t={}),t[r]=n&&"object"==typeof n&&"[object Array]"!==Object.prototype.toString.call(n)&&"number"!=typeof n.nodeType?i(t[r]||{},n):e[r]);return t};for(t=0;e>t;t++)n=i(n,arguments[t]);return n}function n(){for(var t=0,e=arguments,n=e.length,i={};n>t;t++)i[e[t++]]=e[t];return i}function i(t,e){return parseInt(t,e||10)}function r(t){return"string"==typeof t}function a(t){return"object"==typeof t}function s(t){return"[object Array]"===Object.prototype.toString.call(t)}function o(t){return"number"==typeof t}function l(t){return me.log(t)/me.LN10}function c(t){return me.pow(10,t)}function u(t,e){for(var n=t.length;n--;)if(t[n]===e){t.splice(n,1);break}}function h(t){return t!==W&&null!==t}function d(t,e,n){var i,s,o="setAttribute";if(r(e))h(n)?t[o](e,n):t&&t.getAttribute&&(s=t.getAttribute(e));else if(h(e)&&a(e))for(i in e)t[o](i,e[i]);return s}function f(t){return s(t)?t:[t]}function p(){var t,e,n=arguments,i=n.length;for(t=0;i>t;t++)if(e=n[t],e!==void 0&&null!==e)return e}function g(e,n){Oe&&n&&n.opacity!==W&&(n.filter="alpha(opacity="+100*n.opacity+")"),t(e.style,n)}function m(e,n,i,r,a){var s=pe.createElement(e);return n&&t(s,n),a&&g(s,{padding:0,border:Ke,margin:0}),i&&g(s,i),r&&r.appendChild(s),s}function v(e,n){var i=function(){};return i.prototype=new e,t(i.prototype,n),i}function y(t){return t=""+(t||0),t.indexOf(".")>-1?t.split(".")[1].length:0}function b(t,e,n,r){var a=J.lang,s=t,o=-1===e?y(t):isNaN(e=Te(e))?2:e,l=void 0===n?a.decimalPoint:n,c=void 0===r?a.thousandsSep:r,u=0>s?"-":"",h=i(s=Te(+s||0).toFixed(o))+"",d=h.length>3?h.length%3:0;return u+(d?h.substr(0,d)+c:"")+h.substr(d).replace(/(\d{3})(?=\d)/g,"$1"+c)+(o?l+Te(s-h).toFixed(o).slice(2):"")}function x(t,e){return Array((e||2)+1-(t+"").length).join(0)+t}function w(t,e,n){var i=t[e];t[e]=function(){var t=Array.prototype.slice.call(arguments);return t.unshift(i),n.apply(this,t)}}function T(t,e){var n,i=/f$/,r=/\.([0-9])/,a=J.lang;return i.test(t)?(n=t.match(r),n=n?n[1]:6,e=b(e,n,a.decimalPoint,t.indexOf(",")>-1?a.thousandsSep:"")):e=K(t,e),e}function S(t,e){for(var n,i,r,a,s,o,l,c="{",u=!1,h=[];-1!==(l=t.indexOf(c));){if(n=t.slice(0,l),u){for(i=n.split(":"),r=i.shift().split("."),s=r.length,o=e,a=0;s>a;a++)o=o[r[a]];i.length&&(o=T(i.join(":"),o)),h.push(o)}else h.push(n);t=t.slice(l+1),u=!u,c=u?"}":"{"}return h.push(t),h.join("")}function _(t,e,n,i){var r,a;for(n=p(n,1),r=t/n,e||(e=[1,2,2.5,5,10],i&&i.allowDecimals===!1&&(1===n?e=[1,2,5,10]:.1>=n&&(e=[1/n]))),a=0;e.length>a&&(t=e[a],!((e[a]+(e[a+1]||e[a]))/2>=r));a++);return t*=n}function A(t,e){var n,i,r=e||[[sn,[1,2,5,10,20,25,50,100,200,500]],[on,[1,2,5,10,15,30]],[ln,[1,2,5,10,15,30]],[cn,[1,2,3,4,6,8,12]],[un,[1,2]],[hn,[1,2]],[dn,[1,2,3,4,6]],[fn,null]],a=r[r.length-1],s=ee[a[0]],o=a[1];for(i=0;r.length>i;i++)if(a=r[i],s=ee[a[0]],o=a[1],r[i+1]){var l=(s*o[o.length-1]+ee[r[i+1][0]])/2;if(l>=t)break}return s===ee[fn]&&5*s>t&&(o=[1,2,5]),s===ee[fn]&&5*s>t&&(o=[1,2,5]),n=_(t/s,o),{unitRange:s,count:n,unitName:a[0]}}function C(e,n,i,r){var a,s,o=[],l={},c=J.global.useUTC,u=new Date(n),d=e.unitRange,f=e.count;if(h(n)){d>=ee[on]&&(u.setMilliseconds(0),u.setSeconds(d>=ee[ln]?0:f*ye(u.getSeconds()/f))),d>=ee[ln]&&u[ce](d>=ee[cn]?0:f*ye(u[ie]()/f)),d>=ee[cn]&&u[ue](d>=ee[un]?0:f*ye(u[re]()/f)),d>=ee[un]&&u[he](d>=ee[dn]?1:f*ye(u[se]()/f)),d>=ee[dn]&&(u[de](d>=ee[fn]?0:f*ye(u[oe]()/f)),s=u[le]()),d>=ee[fn]&&(s-=s%f,u[fe](s)),d===ee[hn]&&u[he](u[se]()-u[ae]()+p(r,1)),a=1,s=u[le]();for(var g=u.getTime(),m=u[oe](),v=u[se](),y=c?0:(864e5+1e3*60*u.getTimezoneOffset())%864e5;i>g;)o.push(g),d===ee[fn]?g=ne(s+a*f,0):d===ee[dn]?g=ne(s,m+a*f):c||d!==ee[un]&&d!==ee[hn]?(g+=d*f,ee[cn]>=d&&g%ee[un]===y&&(l[g]=un)):g=ne(s,m,v+a*f*(d===ee[un]?1:7)),a++;o.push(g)}return o.info=t(e,{higherRanks:l,totalRange:d*f}),o}function M(){this.color=0,this.symbol=0}function k(t,e){var n,i,r=t.length;for(i=0;r>i;i++)t[i].ss_i=i;for(t.sort(function(t,i){return n=e(t,i),0===n?t.ss_i-i.ss_i:n}),i=0;r>i;i++)delete t[i].ss_i}function O(t){for(var e=t.length,n=t[0];e--;)n>t[e]&&(n=t[e]);return n}function D(t){for(var e=t.length,n=t[0];e--;)t[e]>n&&(n=t[e]);return n}function P(t,e){var n;for(n in t)t[n]&&t[n]!==e&&t[n].destroy&&t[n].destroy(),delete t[n]}function E(t){G||(G=m(je)),t&&G.appendChild(t),G.innerHTML=""}function Y(t,e){var n="Highcharts error #"+t+": www.highcharts.com/errors/"+t;if(e)throw n;ge.console&&console.log(n)}function U(t){return parseFloat(t.toPrecision(14))}function z(t,e){Q=p(t,e.animation)}function F(){var t=J.global.useUTC,e=t?"getUTC":"get",n=t?"setUTC":"set";ne=t?Date.UTC:function(t,e,n,i,r,a){return new Date(t,e,p(n,1),p(i,0),p(r,0),p(a,0)).getTime()},ie=e+"Minutes",re=e+"Hours",ae=e+"Day",se=e+"Date",oe=e+"Month",le=e+"FullYear",ce=n+"Minutes",ue=n+"Hours",he=n+"Date",de=n+"Month",fe=n+"FullYear"}function L(t){return J=e(J,t),F(),J}function $(){return J}function I(){}function N(t,e,n,i){this.axis=t,this.pos=e,this.type=n||"",this.isNew=!0,n||i||this.addLabel()}function R(t,e){this.axis=t,e&&(this.options=e,this.id=e.id)}function H(t,e,n,i,r,a){var s=t.chart.inverted;this.axis=t,this.isNegative=n,this.options=e,this.x=i,this.stack=r,this.percent="percent"===a,this.alignOptions={align:e.align||(s?n?"left":"right":"center"),verticalAlign:e.verticalAlign||(s?"middle":n?"bottom":"top"),y:p(e.y,s?4:n?14:-6),x:p(e.x,s?n?-6:6:0)},this.textAlign=e.textAlign||(s?n?"right":"left":"center")}function B(){this.init.apply(this,arguments)}function V(){this.init.apply(this,arguments)}function j(t,e){this.init(t,e)}function q(t,e){this.init(t,e)}function Z(){this.init.apply(this,arguments)}var W,X,G,J,K,Q,te,ee,ne,ie,re,ae,se,oe,le,ce,ue,he,de,fe,pe=document,ge=window,me=Math,ve=me.round,ye=me.floor,be=me.ceil,xe=me.max,we=me.min,Te=me.abs,Se=me.cos,_e=me.sin,Ae=me.PI,Ce=2*Ae/360,Me=navigator.userAgent,ke=ge.opera,Oe=/msie/i.test(Me)&&!ke,De=8===pe.documentMode,Pe=/AppleWebKit/.test(Me),Ee=/Firefox/.test(Me),Ye=/(Mobile|Android|Windows Phone)/.test(Me),Ue="http://www.w3.org/2000/svg",ze=!!pe.createElementNS&&!!pe.createElementNS(Ue,"svg").createSVGRect,Fe=Ee&&4>parseInt(Me.split("Firefox/")[1],10),Le=!ze&&!Oe&&!!pe.createElement("canvas").getContext,$e=pe.documentElement.ontouchstart!==W,Ie={},Ne=0,Re=function(){},He=[],Be="Highcharts",Ve="3.0.0",je="div",qe="absolute",Ze="relative",We="hidden",Xe="highcharts-",Ge="visible",Je="px",Ke="none",Qe="M",tn="L",en="rgba(192,192,192,"+(ze?1e-4:.002)+")",nn="",rn="hover",an="select",sn="millisecond",on="second",ln="minute",cn="hour",un="day",hn="week",dn="month",fn="year",pn="stroke-width",gn={};ge.Highcharts=ge.Highcharts?Y(16,!0):{},K=function(e,n,i){if(!h(n)||isNaN(n))return"Invalid date";e=p(e,"%Y-%m-%d %H:%M:%S");var r,a=new Date(n),s=a[re](),o=a[ae](),l=a[se](),c=a[oe](),u=a[le](),d=J.lang,f=d.weekdays,g=t({a:f[o].substr(0,3),A:f[o],d:x(l),e:l,b:d.shortMonths[c],B:d.months[c],m:x(c+1),y:(""+u).substr(2,2),Y:u,H:x(s),I:x(s%12||12),l:s%12||12,M:x(a[ie]()),p:12>s?"AM":"PM",P:12>s?"am":"pm",S:x(a.getSeconds()),L:x(ve(n%1e3),3)},Highcharts.dateFormats);for(r in g)for(;-1!==e.indexOf("%"+r);)e=e.replace("%"+r,"function"==typeof g[r]?g[r](n):g[r]);return i?e.substr(0,1).toUpperCase()+e.substr(1):e},M.prototype={wrapColor:function(t){this.color>=t&&(this.color=0)},wrapSymbol:function(t){this.symbol>=t&&(this.symbol=0)}},ee=n(sn,1,on,1e3,ln,6e4,cn,36e5,un,864e5,hn,6048e5,dn,26784e5,fn,31556952e3),te={init:function(t,e,n){e=e||"";var i,r,a,s,o,l=t.shift,c=e.indexOf("C")>-1,u=c?7:3,h=e.split(" "),d=[].concat(n),f=function(t){for(a=t.length;a--;)t[a]===Qe&&t.splice(a+1,0,t[a+1],t[a+2],t[a+1],t[a+2])};if(c&&(f(h),f(d)),t.isArea&&(s=h.splice(h.length-6,6),o=d.splice(d.length-6,6)),d.length/u>=l)for(;l--;)d=[].concat(d).splice(0,u).concat(d);if(t.shift=0,h.length)for(i=d.length;i>h.length;)r=[].concat(h).splice(h.length-u,u),c&&(r[u-6]=r[u-2],r[u-5]=r[u-1]),h=h.concat(r);return s&&(h=h.concat(s),d=d.concat(o)),[h,d]},step:function(t,e,n,i){var r,a=[],s=t.length;if(1===n)a=i;else if(s===e.length&&1>n)for(;s--;)r=parseFloat(t[s]),a[s]=isNaN(r)?t[s]:n*parseFloat(e[s]-r)+r;else a=e;return a}},function(e){ge.HighchartsAdapter=ge.HighchartsAdapter||e&&{init:function(t){var n,i=e.fx,a=i.step,s=e.Tween,o=s&&s.propHooks;e.extend(e.easing,{easeOutQuad:function(t,e,n,i,r){return-i*(e/=r)*(e-2)+n}}),e.each(["cur","_default","width","height","opacity"],function(t,e){var n,r,l=a;"cur"===e?l=i.prototype:"_default"===e&&s&&(l=o[e],e="set"),n=l[e],n&&(l[e]=function(i){return i=t?i:this,r=i.elem,r.attr?r.attr(i.prop,"cur"===e?W:i.now):n.apply(this,arguments)})}),n=function(e){var n,i=e.elem;e.started||(n=t.init(i,i.d,i.toD),e.start=n[0],e.end=n[1],e.started=!0),i.attr("d",t.step(e.start,e.end,e.pos,i.toD))},s?o.d={set:n}:a.d=n,this.each=Array.prototype.forEach?function(t,e){return Array.prototype.forEach.call(t,e)}:function(t,e){for(var n=0,i=t.length;i>n;n++)if(e.call(t[n],t[n],n,t)===!1)return n},e.fn.highcharts=function(){var t,e,n,i="Chart",a=arguments;return r(a[0])&&(i=a[0],a=Array.prototype.slice.call(a,1)),t=a[0],t!==W&&(t.chart=t.chart||{},t.chart.renderTo=this[0],n=new Highcharts[i](t,a[1]),e=this),t===W&&(e=He[d(this[0],"data-highcharts-chart")]),e}},getScript:e.getScript,inArray:e.inArray,adapterRun:function(t,n){return e(t)[n]()},grep:e.grep,map:function(t,e){for(var n=[],i=0,r=t.length;r>i;i++)n[i]=e.call(t[i],t[i],i,t);return n},offset:function(t){return e(t).offset()},addEvent:function(t,n,i){e(t).bind(n,i)},removeEvent:function(t,n,i){var r=pe.removeEventListener?"removeEventListener":"detachEvent";pe[r]&&!t[r]&&(t[r]=function(){}),e(t).unbind(n,i)},fireEvent:function(n,i,r,a){var s,o=e.Event(i),l="detached"+i;!Oe&&r&&(delete r.layerX,delete r.layerY),t(o,r),n[i]&&(n[l]=n[i],n[i]=null),e.each(["preventDefault","stopPropagation"],function(t,e){var n=o[e];o[e]=function(){try{n.call(o)}catch(t){"preventDefault"===e&&(s=!0)}}}),e(n).trigger(o),n[l]&&(n[i]=n[l],n[l]=null),!a||o.isDefaultPrevented()||s||a(o)},washMouseEvent:function(t){var e=t.originalEvent||t;return e.pageX===W&&(e.pageX=t.pageX,e.pageY=t.pageY),e},animate:function(t,n,i){var r=e(t);n.d&&(t.toD=n.d,n.d=1),r.stop(),n.opacity!==W&&t.attr&&(n.opacity+="px"),r.animate(n,i)},stop:function(t){e(t).stop()}}}(ge.jQuery);var mn=ge.HighchartsAdapter,vn=mn||{};mn&&mn.init.call(mn,te);var yn=vn.adapterRun,bn=vn.getScript,xn=vn.inArray,wn=vn.each,Tn=vn.grep,Sn=vn.offset,_n=vn.map,An=vn.addEvent,Cn=vn.removeEvent,Mn=vn.fireEvent,kn=vn.washMouseEvent,On=vn.animate,Dn=vn.stop,Pn={enabled:!0,align:"center",x:0,y:15,style:{color:"#666",cursor:"default",fontSize:"11px",lineHeight:"14px"}};J={colors:["#2f7ed8","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],symbols:["circle","diamond","square","triangle","triangle-down"],lang:{loading:"Loading...",months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],decimalPoint:".",numericSymbols:["k","M","G","T","P","E"],resetZoom:"Reset zoom",resetZoomTitle:"Reset zoom level 1:1",thousandsSep:","},global:{useUTC:!0,canvasToolsURL:"http://code.highcharts.com/3.0.0/modules/canvas-tools.js",VMLRadialGradientURL:"http://code.highcharts.com/3.0.0/gfx/vml-radial-gradient.png"},chart:{borderColor:"#4572A7",borderRadius:5,defaultSeriesType:"line",ignoreHiddenSeries:!0,spacingTop:10,spacingRight:10,spacingBottom:15,spacingLeft:10,style:{fontFamily:'"Lucida Grande", "Lucida Sans Unicode", Verdana, Arial, Helvetica, sans-serif',fontSize:"12px"},backgroundColor:"#FFFFFF",plotBorderColor:"#C0C0C0",resetZoomButton:{theme:{zIndex:20},position:{align:"right",x:-10,y:10}}},title:{text:"Chart title",align:"center",y:15,style:{color:"#274b6d",fontSize:"16px"}},subtitle:{text:"",align:"center",y:30,style:{color:"#4d759e"}},plotOptions:{line:{allowPointSelect:!1,showCheckbox:!1,animation:{duration:1e3},events:{},lineWidth:2,marker:{enabled:!0,lineWidth:0,radius:4,lineColor:"#FFFFFF",states:{hover:{enabled:!0},select:{fillColor:"#FFFFFF",lineColor:"#000000",lineWidth:2}}},point:{events:{}},dataLabels:e(Pn,{enabled:!1,formatter:function(){return this.y},verticalAlign:"bottom",y:0}),cropThreshold:300,pointRange:0,showInLegend:!0,states:{hover:{marker:{}},select:{marker:{}}},stickyTracking:!0}},labels:{style:{position:qe,color:"#3E576F"}},legend:{enabled:!0,align:"center",layout:"horizontal",labelFormatter:function(){return this.name},borderWidth:1,borderColor:"#909090",borderRadius:5,navigation:{activeColor:"#274b6d",inactiveColor:"#CCC"},shadow:!1,itemStyle:{cursor:"pointer",color:"#274b6d",fontSize:"12px"},itemHoverStyle:{color:"#000"},itemHiddenStyle:{color:"#CCC"},itemCheckboxStyle:{position:qe,width:"13px",height:"13px"},symbolWidth:16,symbolPadding:5,verticalAlign:"bottom",x:0,y:0,title:{style:{fontWeight:"bold"}}},loading:{labelStyle:{fontWeight:"bold",position:Ze,top:"1em"},style:{position:qe,backgroundColor:"white",opacity:.5,textAlign:"center"}},tooltip:{enabled:!0,animation:ze,backgroundColor:"rgba(255, 255, 255, .85)",borderWidth:1,borderRadius:3,dateTimeLabelFormats:{millisecond:"%A, %b %e, %H:%M:%S.%L",second:"%A, %b %e, %H:%M:%S",minute:"%A, %b %e, %H:%M",hour:"%A, %b %e, %H:%M",day:"%A, %b %e, %Y",week:"Week from %A, %b %e, %Y",month:"%B %Y",year:"%Y"},headerFormat:'<span style="font-size: 10px">{point.key}</span><br/>',pointFormat:'<span style="color:{series.color}">{series.name}</span>: <b>{point.y}</b><br/>',shadow:!0,snap:Ye?25:10,style:{color:"#333333",cursor:"default",fontSize:"12px",padding:"8px",whiteSpace:"nowrap"}},credits:{enabled:!0,text:"Highcharts.com",href:"http://www.highcharts.com",position:{align:"right",x:-10,verticalAlign:"bottom",y:-5},style:{cursor:"pointer",color:"#909090",fontSize:"9px"}}};var En=J.plotOptions,Yn=En.line;F();var Un=function(t){function n(t){t&&t.stops?c=_n(t.stops,function(t){return Un(t[1])}):(l=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]?(?:\.[0-9]+)?)\s*\)/.exec(t),l?u=[i(l[1]),i(l[2]),i(l[3]),parseFloat(l[4],10)]:(l=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t),l?u=[i(l[1],16),i(l[2],16),i(l[3],16),1]:(l=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t),l&&(u=[i(l[1]),i(l[2]),i(l[3]),1]))))}function r(n){var i;return c?(i=e(t),i.stops=[].concat(i.stops),wn(c,function(t,e){i.stops[e]=[i.stops[e][0],t.get(n)]})):i=u&&!isNaN(u[0])?"rgb"===n?"rgb("+u[0]+","+u[1]+","+u[2]+")":"a"===n?u[3]:"rgba("+u.join(",")+")":t,i}function a(t){if(c)wn(c,function(e){e.brighten(t)});else if(o(t)&&0!==t){var e;for(e=0;3>e;e++)u[e]+=i(255*t),0>u[e]&&(u[e]=0),u[e]>255&&(u[e]=255)}return this}function s(t){return u[3]=t,this}var l,c,u=[];return n(t),{get:r,brighten:a,rgba:u,setOpacity:s}};I.prototype={init:function(t,e){var n=this;n.element="span"===e?m(e):pe.createElementNS(Ue,e),n.renderer=t,n.attrSetters={}},opacity:1,animate:function(t,n,i){var r=p(n,Q,!0);Dn(this),r?(r=e(r),i&&(r.complete=i),On(this,t,r)):(this.attr(t),i&&i())},attr:function(t,e){var n,a,s,o,l,c,u,f,p,g=this,m=g.element,v=m.nodeName.toLowerCase(),y=g.renderer,b=g.attrSetters,x=g.shadows,w=g;if(r(t)&&h(e)&&(n=t,t={},t[n]=e),r(t))n=t,"circle"===v?n={x:"cx",y:"cy"}[n]||n:"strokeWidth"===n&&(n="stroke-width"),w=d(m,n)||g[n]||0,"d"!==n&&"visibility"!==n&&(w=parseFloat(w));else{for(n in t)if(c=!1,a=t[n],s=b[n]&&b[n].call(g,a,n),s!==!1){if(s!==W&&(a=s),"d"===n)a&&a.join&&(a=a.join(" ")),/(NaN| {2}|^$)/.test(a)&&(a="M 0 0");else if("x"===n&&"text"===v)for(o=0;m.childNodes.length>o;o++)l=m.childNodes[o],d(l,"x")===d(m,"x")&&d(l,"x",a);else if(!g.rotation||"x"!==n&&"y"!==n)if("fill"===n)a=y.color(a,m,n);else if("circle"!==v||"x"!==n&&"y"!==n)if("rect"===v&&"r"===n)d(m,{rx:a,ry:a}),c=!0;else if("translateX"===n||"translateY"===n||"rotation"===n||"verticalAlign"===n||"scaleX"===n||"scaleY"===n)p=!0,c=!0;else if("stroke"===n)a=y.color(a,m,n);else if("dashstyle"===n){if(n="stroke-dasharray",a=a&&a.toLowerCase(),"solid"===a)a=Ke;else if(a){for(a=a.replace("shortdashdotdot","3,1,1,1,1,1,").replace("shortdashdot","3,1,1,1").replace("shortdot","1,1,").replace("shortdash","3,1,").replace("longdash","8,3,").replace(/dot/g,"1,3,").replace("dash","4,3,").replace(/,$/,"").split(","),o=a.length;o--;)a[o]=i(a[o])*t["stroke-width"];a=a.join(",")}}else"width"===n?a=i(a):"align"===n?(n="text-anchor",a={left:"start",center:"middle",right:"end"}[a]):"title"===n&&(u=m.getElementsByTagName("title")[0],u||(u=pe.createElementNS(Ue,"title"),m.appendChild(u)),u.textContent=a);else n={x:"cx",y:"cy"}[n]||n;else p=!0;if("strokeWidth"===n&&(n="stroke-width"),("stroke-width"===n||"stroke"===n)&&(g[n]=a,g.stroke&&g["stroke-width"]?(d(m,"stroke",g.stroke),d(m,"stroke-width",g["stroke-width"]),g.hasStroke=!0):"stroke-width"===n&&0===a&&g.hasStroke&&(m.removeAttribute("stroke"),g.hasStroke=!1),c=!0),g.symbolName&&/^(x|y|width|height|r|start|end|innerR|anchorX|anchorY)/.test(n)&&(f||(g.symbolAttr(t),f=!0),c=!0),x&&/^(width|height|visibility|x|y|d|transform)$/.test(n))for(o=x.length;o--;)d(x[o],n,"height"===n?xe(a-(x[o].cutHeight||0),0):a);("width"===n||"height"===n)&&"rect"===v&&0>a&&(a=0),g[n]=a,"text"===n?(a!==g.textStr&&delete g.bBox,g.textStr=a,g.added&&y.buildText(g)):c||d(m,n,a)}p&&g.updateTransform()}return w},addClass:function(t){return d(this.element,"class",d(this.element,"class")+" "+t),this},symbolAttr:function(t){var e=this;wn(["x","y","r","start","end","width","height","innerR","anchorX","anchorY"],function(n){e[n]=p(t[n],e[n])}),e.attr({d:e.renderer.symbols[e.symbolName](e.x,e.y,e.width,e.height,e)})},clip:function(t){return this.attr("clip-path",t?"url("+this.renderer.url+"#"+t.id+")":Ke)},crisp:function(t,e,n,i,r){var a,s,o=this,l={},c={};t=t||o.strokeWidth||o.attr&&o.attr("stroke-width")||0,s=ve(t)%2/2,c.x=ye(e||o.x||0)+s,c.y=ye(n||o.y||0)+s,c.width=ye((i||o.width||0)-2*s),c.height=ye((r||o.height||0)-2*s),c.strokeWidth=t;for(a in c)o[a]!==c[a]&&(o[a]=l[a]=c[a]);return l},css:function(e){var n,i=this,r=i.element,a=e&&e.width&&"text"===r.nodeName.toLowerCase(),s="",o=function(t,e){return"-"+e.toLowerCase()};if(e&&e.color&&(e.fill=e.color),e=t(i.styles,e),i.styles=e,Le&&a&&delete e.width,Oe&&!ze)a&&delete e.width,g(i.element,e);else{for(n in e)s+=n.replace(/([A-Z])/g,o)+":"+e[n]+";";i.attr({style:s})}return a&&i.added&&i.renderer.buildText(i),i},on:function(t,e){return $e&&"click"===t&&(this.element.ontouchstart=function(t){t.preventDefault(),e()}),this.element["on"+t]=e,this},setRadialReference:function(t){return this.element.radialReference=t,this},translate:function(t,e){return this.attr({translateX:t,translateY:e})},invert:function(){var t=this;return t.inverted=!0,t.updateTransform(),t},htmlCss:function(e){var n=this,i=n.element,r=e&&"SPAN"===i.tagName&&e.width;return r&&(delete e.width,n.textWidth=r,n.updateTransform()),n.styles=t(n.styles,e),g(n.element,e),n},htmlGetBBox:function(){var t=this,e=t.element,n=t.bBox;return n||("text"===e.nodeName&&(e.style.position=qe),n=t.bBox={x:e.offsetLeft,y:e.offsetTop,width:e.offsetWidth,height:e.offsetHeight}),n},htmlUpdateTransform:function(){if(!this.added)return this.alignOnAdd=!0,void 0;var t=this,e=t.renderer,n=t.element,r=t.translateX||0,a=t.translateY||0,s=t.x||0,o=t.y||0,l=t.textAlign||"left",c={left:0,center:.5,right:1}[l],u=l&&"left"!==l,d=t.shadows;if((r||a)&&(g(n,{marginLeft:r,marginTop:a}),d&&wn(d,function(t){g(t,{marginLeft:r+1,marginTop:a+1})})),t.inverted&&wn(n.childNodes,function(t){e.invertChild(t,n)}),"SPAN"===n.tagName){var f,m,v,y,b,x=t.rotation,w=0,T=1,S=0,_=i(t.textWidth),A=t.xCorr||0,C=t.yCorr||0,M=[x,l,n.innerHTML,t.textWidth].join(","),k={};M!==t.cTT&&(h(x)&&(e.isSVG?(b=Oe?"-ms-transform":Pe?"-webkit-transform":Ee?"MozTransform":ke?"-o-transform":"",k[b]=k.transform="rotate("+x+"deg)"):(w=x*Ce,T=Se(w),S=_e(w),k.filter=x?["progid:DXImageTransform.Microsoft.Matrix(M11=",T,", M12=",-S,", M21=",S,", M22=",T,", sizingMethod='auto expand')"].join(""):Ke),g(n,k)),f=p(t.elemWidth,n.offsetWidth),m=p(t.elemHeight,n.offsetHeight),f>_&&/[ \-]/.test(n.textContent||n.innerText)&&(g(n,{width:_+Je,display:"block",whiteSpace:"normal"}),f=_),v=e.fontMetrics(n.style.fontSize).b,A=0>T&&-f,C=0>S&&-m,y=0>T*S,A+=S*v*(y?1-c:c),C-=T*v*(x?y?c:1-c:1),u&&(A-=f*c*(0>T?-1:1),x&&(C-=m*c*(0>S?-1:1)),g(n,{textAlign:l})),t.xCorr=A,t.yCorr=C),g(n,{left:s+A+Je,top:o+C+Je}),Pe&&(m=n.offsetHeight),t.cTT=M}},updateTransform:function(){var t=this,e=t.translateX||0,n=t.translateY||0,i=t.scaleX,r=t.scaleY,a=t.inverted,s=t.rotation,o=[];a&&(e+=t.attr("width"),n+=t.attr("height")),(e||n)&&o.push("translate("+e+","+n+")"),a?o.push("rotate(90) scale(-1,1)"):s&&o.push("rotate("+s+" "+(t.x||0)+" "+(t.y||0)+")"),(h(i)||h(r))&&o.push("scale("+p(i,1)+" "+p(r,1)+")"),o.length&&d(t.element,"transform",o.join(" "))},toFront:function(){var t=this.element;return t.parentNode.appendChild(t),this},align:function(t,e,n){var i,a,s,o,l,c={},h=this.renderer,d=h.alignedObjects;return t?(this.alignOptions=t,this.alignByTranslate=e,(!n||r(n))&&(this.alignTo=l=n||"renderer",u(d,this),d.push(this),n=null)):(t=this.alignOptions,e=this.alignByTranslate,l=this.alignTo),n=p(n,h[l],h),i=t.align,a=t.verticalAlign,s=(n.x||0)+(t.x||0),o=(n.y||0)+(t.y||0),("right"===i||"center"===i)&&(s+=(n.width-(t.width||0))/{right:1,center:2}[i]),c[e?"translateX":"x"]=ve(s),("bottom"===a||"middle"===a)&&(o+=(n.height-(t.height||0))/({bottom:1,middle:2}[a]||1)),c[e?"translateY":"y"]=ve(o),this[this.placed?"animate":"attr"](c),this.placed=!0,this.alignAttr=c,this},getBBox:function(){var e,n,i=this,r=i.bBox,a=i.renderer,s=i.rotation,o=i.element,l=i.styles,c=s*Ce;if(!r){if(o.namespaceURI===Ue||a.forExport){try{r=o.getBBox?t({},o.getBBox()):{width:o.offsetWidth,height:o.offsetHeight}}catch(u){}(!r||0>r.width)&&(r={width:0,height:0})}else r=i.htmlGetBBox();a.isSVG&&(e=r.width,n=r.height,Oe&&l&&"11px"===l.fontSize&&22.7===n.toPrecision(3)&&(r.height=n=14),s&&(r.width=Te(n*_e(c))+Te(e*Se(c)),r.height=Te(n*Se(c))+Te(e*_e(c)))),i.bBox=r}return r},show:function(){return this.attr({visibility:Ge})},hide:function(){return this.attr({visibility:We})},fadeOut:function(t){var e=this;e.animate({opacity:0},{duration:t||150,complete:function(){e.hide()}})},add:function(t){var e,n,r,a,s=this.renderer,o=t||s,l=o.element||s.box,c=l.childNodes,u=this.element,f=d(u,"zIndex");if(t&&(this.parentGroup=t),this.parentInverted=t&&t.inverted,void 0!==this.textStr&&s.buildText(this),f&&(o.handleZ=!0,f=i(f)),o.handleZ)for(r=0;c.length>r;r++)if(e=c[r],n=d(e,"zIndex"),e!==u&&(i(n)>f||!h(f)&&h(n))){l.insertBefore(u,e),a=!0;break}return a||l.appendChild(u),this.added=!0,Mn(this,"add"),this},safeRemoveChild:function(t){var e=t.parentNode;e&&e.removeChild(t)},destroy:function(){var t,e,n=this,i=n.element||{},r=n.shadows;if(i.onclick=i.onmouseout=i.onmouseover=i.onmousemove=i.point=null,Dn(n),n.clipPath&&(n.clipPath=n.clipPath.destroy()),n.stops){for(e=0;n.stops.length>e;e++)n.stops[e]=n.stops[e].destroy();n.stops=null}n.safeRemoveChild(i),r&&wn(r,function(t){n.safeRemoveChild(t)}),n.alignTo&&u(n.renderer.alignedObjects,n);for(t in n)delete n[t];return null},shadow:function(t,e,n){var i,r,a,s,o,l,c=[],u=this.element;if(t){for(s=p(t.width,3),o=(t.opacity||.15)/s,l=this.parentInverted?"(-1,-1)":"("+p(t.offsetX,1)+", "+p(t.offsetY,1)+")",i=1;s>=i;i++)r=u.cloneNode(0),a=2*s+1-2*i,d(r,{isShadow:"true",stroke:t.color||"black","stroke-opacity":o*i,"stroke-width":a,transform:"translate"+l,fill:Ke}),n&&(d(r,"height",xe(d(r,"height")-a,0)),r.cutHeight=a),e?e.element.appendChild(r):u.parentNode.insertBefore(r,u),c.push(r);this.shadows=c}return this}};var zn=function(){this.init.apply(this,arguments)};zn.prototype={Element:I,init:function(t,e,n,i){var r,a,s=this,o=location;r=s.createElement("svg").attr({xmlns:Ue,version:"1.1"}),t.appendChild(r.element),s.isSVG=!0,s.box=r.element,s.boxWrapper=r,s.alignedObjects=[],s.url=(Ee||Pe)&&pe.getElementsByTagName("base").length?o.href.replace(/#.*?$/,"").replace(/([\('\)])/g,"\\$1").replace(/ /g,"%20"):"",a=this.createElement("desc").add(),a.element.appendChild(pe.createTextNode("Created with "+Be+" "+Ve)),s.defs=this.createElement("defs").add(),s.forExport=i,s.gradients={},s.setSize(e,n,!1);var l,c;Ee&&t.getBoundingClientRect&&(s.subPixelFix=l=function(){g(t,{left:0,top:0}),c=t.getBoundingClientRect(),g(t,{left:be(c.left)-c.left+Je,top:be(c.top)-c.top+Je})
},l(),An(ge,"resize",l))},isHidden:function(){return!this.boxWrapper.getBBox().width},destroy:function(){var t=this,e=t.defs;return t.box=null,t.boxWrapper=t.boxWrapper.destroy(),P(t.gradients||{}),t.gradients=null,e&&(t.defs=e.destroy()),t.subPixelFix&&Cn(ge,"resize",t.subPixelFix),t.alignedObjects=null,null},createElement:function(t){var e=new this.Element;return e.init(this,t),e},draw:function(){},buildText:function(t){for(var e=t.element,n=this,r=n.forExport,a=(""+p(t.textStr,"")).replace(/<(b|strong)>/g,'<span style="font-weight:bold">').replace(/<(i|em)>/g,'<span style="font-style:italic">').replace(/<a/g,"<span").replace(/<\/(b|strong|i|em|a)>/g,"</span>").split(/<br.*?>/g),s=e.childNodes,o=/style="([^"]+)"/,l=/href="([^"]+)"/,c=d(e,"x"),u=t.styles,h=u&&u.width&&i(u.width),f=u&&u.lineHeight,m=s.length;m--;)e.removeChild(s[m]);h&&!t.added&&this.box.appendChild(e),""===a[a.length-1]&&a.pop(),wn(a,function(i,a){var s,p=0;i=i.replace(/<span/g,"|||<span").replace(/<\/span>/g,"</span>|||"),s=i.split("|||"),wn(s,function(i){if(""!==i||1===s.length){var m,v={},y=pe.createElementNS(Ue,"tspan");if(o.test(i)&&(m=i.match(o)[1].replace(/(;| |^)color([ :])/,"$1fill$2"),d(y,"style",m)),l.test(i)&&!r&&(d(y,"onclick",'location.href="'+i.match(l)[1]+'"'),g(y,{cursor:"pointer"})),i=(i.replace(/<(.|\n)*?>/g,"")||" ").replace(/&lt;/g,"<").replace(/&gt;/g,">"),y.appendChild(pe.createTextNode(i)),p?v.dx=0:v.x=c,d(y,v),!p&&a&&(!ze&&r&&g(y,{display:"block"}),d(y,"dy",f||n.fontMetrics(/px$/.test(y.style.fontSize)?y.style.fontSize:u.fontSize).h,Pe&&y.offsetHeight)),e.appendChild(y),p++,h)for(var b,x,w=i.replace(/([^\^])-/g,"$1- ").split(" "),T=[];w.length||T.length;)delete t.bBox,x=t.getBBox().width,b=x>h,b&&1!==w.length?(y.removeChild(y.firstChild),T.unshift(w.pop())):(w=T,T=[],w.length&&(y=pe.createElementNS(Ue,"tspan"),d(y,{dy:f||16,x:c}),m&&d(y,"style",m),e.appendChild(y),x>h&&(h=x))),w.length&&y.appendChild(pe.createTextNode(w.join(" ").replace(/- /g,"-")))}})})},button:function(n,i,r,a,s,o,l){var c,u,h,d,f,p=this.label(n,i,r,null,null,null,null,null,"button"),g=0,m="style",v={x1:0,y1:0,x2:0,y2:1};return s=e({"stroke-width":1,stroke:"#CCCCCC",fill:{linearGradient:v,stops:[[0,"#FEFEFE"],[1,"#F6F6F6"]]},r:2,padding:5,style:{color:"black"}},s),h=s[m],delete s[m],o=e(s,{stroke:"#68A",fill:{linearGradient:v,stops:[[0,"#FFF"],[1,"#ACF"]]}},o),d=o[m],delete o[m],l=e(s,{stroke:"#68A",fill:{linearGradient:v,stops:[[0,"#9BD"],[1,"#CDF"]]}},l),f=l[m],delete l[m],An(p.element,"mouseenter",function(){p.attr(o).css(d)}),An(p.element,"mouseleave",function(){c=[s,o,l][g],u=[h,d,f][g],p.attr(c).css(u)}),p.setState=function(t){g=t,t?2===t&&p.attr(l).css(f):p.attr(s).css(h)},p.on("click",function(){a.call(p)}).attr(s).css(t({cursor:"default"},h))},crispLine:function(t,e){return t[1]===t[4]&&(t[1]=t[4]=ve(t[1])-e%2/2),t[2]===t[5]&&(t[2]=t[5]=ve(t[2])+e%2/2),t},path:function(e){var n={fill:Ke};return s(e)?n.d=e:a(e)&&t(n,e),this.createElement("path").attr(n)},circle:function(t,e,n){var i=a(t)?t:{x:t,y:e,r:n};return this.createElement("circle").attr(i)},arc:function(t,e,n,i,r,s){return a(t)&&(e=t.y,n=t.r,i=t.innerR,r=t.start,s=t.end,t=t.x),this.symbol("arc",t||0,e||0,n||0,n||0,{innerR:i||0,start:r||0,end:s||0})},rect:function(t,e,n,i,r,s){r=a(t)?t.r:r;var o=this.createElement("rect").attr({rx:r,ry:r,fill:Ke});return o.attr(a(t)?t:o.crisp(s,t,e,xe(n,0),xe(i,0)))},setSize:function(t,e,n){var i=this,r=i.alignedObjects,a=r.length;for(i.width=t,i.height=e,i.boxWrapper[p(n,!0)?"animate":"attr"]({width:t,height:e});a--;)r[a].align()},g:function(t){var e=this.createElement("g");return h(t)?e.attr({"class":Xe+t}):e},image:function(e,n,i,r,a){var s,o={preserveAspectRatio:Ke};return arguments.length>1&&t(o,{x:n,y:i,width:r,height:a}),s=this.createElement("image").attr(o),s.element.setAttributeNS?s.element.setAttributeNS("http://www.w3.org/1999/xlink","href",e):s.element.setAttribute("hc-svg-href",e),s},symbol:function(e,n,i,r,a,s){var o,l,c,u,h,d=this.symbols[e],f=d&&d(ve(n),ve(i),r,a,s),p=/^url\((.*?)\)$/;return f?(o=this.path(f),t(o,{symbolName:e,x:n,y:i,width:r,height:a}),s&&t(o,s)):p.test(e)&&(h=function(t,e){t.element&&(t.attr({width:e[0],height:e[1]}),t.alignByTranslate||t.translate(ve((r-e[0])/2),ve((a-e[1])/2)))},c=e.match(p)[1],u=Ie[c],o=this.image(c).attr({x:n,y:i}),u?h(o,u):(o.attr({width:0,height:0}),l=m("img",{onload:function(){h(o,Ie[c]=[this.width,this.height])},src:c}))),o},symbols:{circle:function(t,e,n,i){var r=.166*n;return[Qe,t+n/2,e,"C",t+n+r,e,t+n+r,e+i,t+n/2,e+i,"C",t-r,e+i,t-r,e,t+n/2,e,"Z"]},square:function(t,e,n,i){return[Qe,t,e,tn,t+n,e,t+n,e+i,t,e+i,"Z"]},triangle:function(t,e,n,i){return[Qe,t+n/2,e,tn,t+n,e+i,t,e+i,"Z"]},"triangle-down":function(t,e,n,i){return[Qe,t,e,tn,t+n,e,t+n/2,e+i,"Z"]},diamond:function(t,e,n,i){return[Qe,t+n/2,e,tn,t+n,e+i/2,t+n/2,e+i,t,e+i/2,"Z"]},arc:function(t,e,n,i,r){var a=r.start,s=r.r||n||i,o=r.end-.001,l=r.innerR,c=r.open,u=Se(a),h=_e(a),d=Se(o),f=_e(o),p=Ae>r.end-a?0:1;return[Qe,t+s*u,e+s*h,"A",s,s,0,p,1,t+s*d,e+s*f,c?Qe:tn,t+l*d,e+l*f,"A",l,l,0,p,0,t+l*u,e+l*h,c?"":"Z"]}},clipRect:function(t,e,n,i){var r,a=Xe+Ne++,s=this.createElement("clipPath").attr({id:a}).add(this.defs);return r=this.rect(t,e,n,i,0).add(s),r.id=a,r.clipPath=s,r},color:function(t,n,i){var r,a,o,l,c,u,f,p,g,m,v,y=this,b=/^rgba/,x=[];if(t&&t.linearGradient?a="linearGradient":t&&t.radialGradient&&(a="radialGradient"),a){o=t[a],l=y.gradients,u=t.stops,g=n.radialReference,s(o)&&(t[a]=o={x1:o[0],y1:o[1],x2:o[2],y2:o[3],gradientUnits:"userSpaceOnUse"}),"radialGradient"===a&&g&&!h(o.gradientUnits)&&(o=e(o,{cx:g[0]-g[2]/2+o.cx*g[2],cy:g[1]-g[2]/2+o.cy*g[2],r:o.r*g[2],gradientUnits:"userSpaceOnUse"}));for(m in o)"id"!==m&&x.push(m,o[m]);for(m in u)x.push(u[m]);return x=x.join(","),l[x]?v=l[x].id:(o.id=v=Xe+Ne++,l[x]=c=y.createElement(a).attr(o).add(y.defs),c.stops=[],wn(u,function(t){var e;b.test(t[1])?(r=Un(t[1]),f=r.get("rgb"),p=r.get("a")):(f=t[1],p=1),e=y.createElement("stop").attr({offset:t[0],"stop-color":f,"stop-opacity":p}).add(c),c.stops.push(e)})),"url("+y.url+"#"+v+")"}return b.test(t)?(r=Un(t),d(n,i+"-opacity",r.get("a")),r.get("rgb")):(n.removeAttribute(i+"-opacity"),t)},text:function(t,e,n,i){var r,a=this,s=J.chart.style,o=Le||!ze&&a.forExport;return i&&!a.forExport?a.html(t,e,n):(e=ve(p(e,0)),n=ve(p(n,0)),r=a.createElement("text").attr({x:e,y:n,text:t}).css({fontFamily:s.fontFamily,fontSize:s.fontSize}),o&&r.css({position:qe}),r.x=e,r.y=n,r)},html:function(e,n,i){var r=J.chart.style,a=this.createElement("span"),s=a.attrSetters,o=a.element,l=a.renderer;return s.text=function(t){return t!==o.innerHTML&&delete this.bBox,o.innerHTML=t,!1},s.x=s.y=s.align=function(t,e){return"align"===e&&(e="textAlign"),a[e]=t,a.htmlUpdateTransform(),!1},a.attr({text:e,x:ve(n),y:ve(i)}).css({position:qe,whiteSpace:"nowrap",fontFamily:r.fontFamily,fontSize:r.fontSize}),a.css=a.htmlCss,l.isSVG&&(a.add=function(e){var n,i,r=l.box.parentNode,s=[];if(e){if(n=e.div,!n){for(i=e;i;)s.push(i),i=i.parentGroup;wn(s.reverse(),function(e){var i;n=e.div=e.div||m(je,{className:d(e.element,"class")},{position:qe,left:(e.translateX||0)+Je,top:(e.translateY||0)+Je},n||r),i=n.style,t(e.attrSetters,{translateX:function(t){i.left=t+Je},translateY:function(t){i.top=t+Je},visibility:function(t,e){i[e]=t}})})}}else n=r;return n.appendChild(o),a.added=!0,a.alignOnAdd&&a.htmlUpdateTransform(),a}),a},fontMetrics:function(t){t=i(t||11);var e=24>t?t+4:ve(1.2*t),n=ve(.8*e);return{h:e,b:n}},label:function(n,i,r,a,s,o,l,c,u){function d(){var t,n,i=C.element.style;v=(void 0===y||void 0===b||A.styles.textAlign)&&C.getBBox(),A.width=(y||v.width||0)+2*k+O,A.height=(b||v.height||0)+2*k,T=k+_.fontMetrics(i&&i.fontSize).b,S&&(m||(t=ve(-M*k),n=c?-T:0,A.box=m=a?_.symbol(a,t,n,A.width,A.height):_.rect(t,n,A.width,A.height,0,P[pn]),m.add(A)),m.attr(e({width:A.width,height:A.height},P)),P=null)}function f(){var t,e=A.styles,n=e&&e.textAlign,i=O+k*(1-M);t=c?0:T,!h(y)||"center"!==n&&"right"!==n||(i+={center:.5,right:1}[n]*(y-v.width)),(i!==C.x||t!==C.y)&&C.attr({x:i,y:t}),C.x=i,C.y=t}function p(t,e){m?m.attr(t,e):P[t]=e}function g(){C.add(A),A.attr({text:n,x:i,y:r}),m&&h(s)&&A.attr({anchorX:s,anchorY:o})}var m,v,y,b,x,w,T,S,_=this,A=_.g(u),C=_.text("",0,0,l).attr({zIndex:1}),M=0,k=3,O=0,D=0,P={},E=A.attrSetters;An(A,"add",g),E.width=function(t){return y=t,!1},E.height=function(t){return b=t,!1},E.padding=function(t){return h(t)&&t!==k&&(k=t,f()),!1},E.paddingLeft=function(t){return h(t)&&t!==O&&(O=t,f()),!1},E.align=function(t){return M={left:0,center:.5,right:1}[t],!1},E.text=function(t,e){return C.attr(e,t),d(),f(),!1},E[pn]=function(t,e){return S=!0,D=t%2/2,p(e,t),!1},E.stroke=E.fill=E.r=function(t,e){return"fill"===e&&(S=!0),p(e,t),!1},E.anchorX=function(t,e){return s=t,p(e,t+D-x),!1},E.anchorY=function(t,e){return o=t,p(e,t-w),!1},E.x=function(t){return A.x=t,t-=M*((y||v.width)+k),x=ve(t),A.attr("translateX",x),!1},E.y=function(t){return w=A.y=ve(t),A.attr("translateY",w),!1};var Y=A.css;return t(A,{css:function(t){if(t){var n={};t=e(t),wn(["fontSize","fontWeight","fontFamily","color","lineHeight","width"],function(e){t[e]!==W&&(n[e]=t[e],delete t[e])}),C.css(n)}return Y.call(A,t)},getBBox:function(){return{width:v.width+2*k,height:v.height+2*k,x:v.x-k,y:v.y-k}},shadow:function(t){return m&&m.shadow(t),A},destroy:function(){Cn(A,"add",g),Cn(A.element,"mouseenter"),Cn(A.element,"mouseleave"),C&&(C=C.destroy()),m&&(m=m.destroy()),I.prototype.destroy.call(A),A=_=d=f=p=g=null}})}},X=zn;var Fn,Ln;if(!ze&&!Le){Highcharts.VMLElement=Ln={init:function(t,e){var n=this,i=["<",e,' filled="f" stroked="f"'],r=["position: ",qe,";"],a=e===je;("shape"===e||a)&&r.push("left:0;top:0;width:1px;height:1px;"),r.push("visibility: ",a?We:Ge),i.push(' style="',r.join(""),'"/>'),e&&(i=a||"span"===e||"img"===e?i.join(""):t.prepVML(i),n.element=m(i)),n.renderer=t,n.attrSetters={}},add:function(t){var e=this,n=e.renderer,i=e.element,r=n.box,a=t&&t.inverted,s=t?t.element||t:r;return a&&n.invertChild(i,s),s.appendChild(i),e.added=!0,e.alignOnAdd&&!e.deferUpdateTransform&&e.updateTransform(),Mn(e,"add"),e},updateTransform:I.prototype.htmlUpdateTransform,attr:function(t,e){var n,i,a,s,l,c,u=this,f=u.element||{},p=f.style,g=f.nodeName,v=u.renderer,y=u.symbolName,b=u.shadows,x=u.attrSetters,w=u;if(r(t)&&h(e)&&(n=t,t={},t[n]=e),r(t))n=t,w="strokeWidth"===n||"stroke-width"===n?u.strokeweight:u[n];else for(n in t)if(i=t[n],c=!1,s=x[n]&&x[n].call(u,i,n),s!==!1&&null!==i){if(s!==W&&(i=s),y&&/^(x|y|r|start|end|width|height|innerR|anchorX|anchorY)/.test(n))l||(u.symbolAttr(t),l=!0),c=!0;else if("d"===n){i=i||[],u.d=i.join(" "),a=i.length;for(var T=[];a--;)o(i[a])?T[a]=ve(10*i[a])-5:"Z"===i[a]?T[a]="x":(T[a]=i[a],("wa"===i[a]||"at"===i[a])&&(T[a+5]===T[a+7]&&(T[a+7]-=1),T[a+6]===T[a+8]&&(T[a+8]-=1)));if(i=T.join(" ")||"x",f.path=i,b)for(a=b.length;a--;)b[a].path=b[a].cutOff?this.cutOffPath(i,b[a].cutOff):i;c=!0}else if("visibility"===n){if(b)for(a=b.length;a--;)b[a].style[n]=i;"DIV"===g&&(i=i===We?"-999em":0,De||(p[n]=i?We:Ge),n="top"),p[n]=i,c=!0}else if("zIndex"===n)i&&(p[n]=i),c=!0;else if(-1!==xn(n,["x","y","width","height"]))u[n]=i,"x"===n||"y"===n?n={x:"left",y:"top"}[n]:i=xe(0,i),u.updateClipping?(u[n]=i,u.updateClipping()):p[n]=i,c=!0;else if("class"===n&&"DIV"===g)f.className=i;else if("stroke"===n)i=v.color(i,f,n),n="strokecolor";else if("stroke-width"===n||"strokeWidth"===n)f.stroked=i?!0:!1,n="strokeweight",u[n]=i,o(i)&&(i+=Je);else if("dashstyle"===n){var S=f.getElementsByTagName("stroke")[0]||m(v.prepVML(["<stroke/>"]),null,null,f);S[n]=i||"solid",u.dashstyle=i,c=!0}else"fill"===n?"SPAN"===g?p.color=i:"IMG"!==g&&(f.filled=i!==Ke?!0:!1,i=v.color(i,f,n,u),n="fillcolor"):"opacity"===n?c=!0:"shape"===g&&"rotation"===n?(u[n]=i,f.style.left=-ve(_e(i*Ce)+1)+Je,f.style.top=ve(Se(i*Ce))+Je):"translateX"===n||"translateY"===n||"rotation"===n?(u[n]=i,u.updateTransform(),c=!0):"text"===n&&(this.bBox=null,f.innerHTML=i,c=!0);c||(De?f[n]=i:d(f,n,i))}return w},clip:function(t){var e,n,i=this;return t?(e=t.members,u(e,i),e.push(i),i.destroyClip=function(){u(e,i)},n=t.getCSS(i)):(i.destroyClip&&i.destroyClip(),n={clip:De?"inherit":"rect(auto)"}),i.css(n)},css:I.prototype.htmlCss,safeRemoveChild:function(t){t.parentNode&&E(t)},destroy:function(){return this.destroyClip&&this.destroyClip(),I.prototype.destroy.apply(this)},on:function(t,e){return this.element["on"+t]=function(){var t=ge.event;t.target=t.srcElement,e(t)},this},cutOffPath:function(t,e){var n;return t=t.split(/[ ,]/),n=t.length,(9===n||11===n)&&(t[n-4]=t[n-2]=i(t[n-2])-10*e),t.join(" ")},shadow:function(t,e,n){var r,a,s,o,l,c,u,h=[],d=this.element,f=this.renderer,g=d.style,v=d.path;if(v&&"string"!=typeof v.value&&(v="x"),l=v,t){for(c=p(t.width,3),u=(t.opacity||.15)/c,r=1;3>=r;r++)o=2*c+1-2*r,n&&(l=this.cutOffPath(v.value,o+.5)),s=['<shape isShadow="true" strokeweight="',o,'" filled="false" path="',l,'" coordsize="10 10" style="',d.style.cssText,'" />'],a=m(f.prepVML(s),null,{left:i(g.left)+p(t.offsetX,1),top:i(g.top)+p(t.offsetY,1)}),n&&(a.cutOff=o+1),s=['<stroke color="',t.color||"black",'" opacity="',u*r,'"/>'],m(f.prepVML(s),null,null,a),e?e.element.appendChild(a):d.parentNode.insertBefore(a,d),h.push(a);this.shadows=h}return this}},Ln=v(I,Ln);var $n={Element:Ln,isIE8:Me.indexOf("MSIE 8.0")>-1,init:function(t,e,n){var i,r,a=this;a.alignedObjects=[],i=a.createElement(je),r=i.element,r.style.position=Ze,t.appendChild(i.element),a.isVML=!0,a.box=r,a.boxWrapper=i,a.setSize(e,n,!1),pe.namespaces.hcv||(pe.namespaces.add("hcv","urn:schemas-microsoft-com:vml"),pe.createStyleSheet().cssText="hcv\\:fill, hcv\\:path, hcv\\:shape, hcv\\:stroke{ behavior:url(#default#VML); display: inline-block; } ")},isHidden:function(){return!this.box.offsetWidth},clipRect:function(e,n,i,r){var s=this.createElement(),o=a(e);return t(s,{members:[],left:o?e.x:e,top:o?e.y:n,width:o?e.width:i,height:o?e.height:r,getCSS:function(e){var n=e.element,i=n.nodeName,r="shape"===i,a=e.inverted,s=this,o=s.top-(r?n.offsetTop:0),l=s.left,c=l+s.width,u=o+s.height,h={clip:"rect("+ve(a?l:o)+"px,"+ve(a?u:c)+"px,"+ve(a?c:u)+"px,"+ve(a?o:l)+"px)"};return!a&&De&&"DIV"===i&&t(h,{width:c+Je,height:u+Je}),h},updateClipping:function(){wn(s.members,function(t){t.css(s.getCSS(t))})}})},color:function(t,e,n,i){var r,a,s,o=this,l=/^rgba/,c=Ke;if(t&&t.linearGradient?s="gradient":t&&t.radialGradient&&(s="pattern"),s){var u,h,d,f,p,g,v,y,b,x,w,T,S=t.linearGradient||t.radialGradient,_="",A=t.stops,C=[],M=function(){a=['<fill colors="'+C.join(",")+'" opacity="',y,'" o:opacity2="',v,'" type="',s,'" ',_,'focus="100%" method="any" />'],m(o.prepVML(a),null,null,e)};if(w=A[0],T=A[A.length-1],w[0]>0&&A.unshift([0,w[1]]),1>T[0]&&A.push([1,T[1]]),wn(A,function(t,e){l.test(t[1])?(r=Un(t[1]),u=r.get("rgb"),h=r.get("a")):(u=t[1],h=1),C.push(100*t[0]+"% "+u),e?(y=h,b=u):(v=h,x=u)}),"fill"===n)if("gradient"===s)d=S.x1||S[0]||0,f=S.y1||S[1]||0,p=S.x2||S[2]||0,g=S.y2||S[3]||0,_='angle="'+(90-180*me.atan((g-f)/(p-d))/Ae)+'"',M();else{var k,O=S.r,D=2*O,P=2*O,E=S.cx,Y=S.cy,U=e.radialReference,z=function(){U&&(k=i.getBBox(),E+=(U[0]-k.x)/k.width-.5,Y+=(U[1]-k.y)/k.height-.5,D*=U[2]/k.width,P*=U[2]/k.height),_='src="'+J.global.VMLRadialGradientURL+'" '+'size="'+D+","+P+'" '+'origin="0.5,0.5" '+'position="'+E+","+Y+'" '+'color2="'+x+'" ',M()};i.added?z():An(i,"add",z),c=b}else c=u}else if(l.test(t)&&"IMG"!==e.tagName)r=Un(t),a=["<",n,' opacity="',r.get("a"),'"/>'],m(this.prepVML(a),null,null,e),c=r.get("rgb");else{var F=e.getElementsByTagName(n);F.length&&(F[0].opacity=1,F[0].type="solid"),c=t}return c},prepVML:function(t){var e="display:inline-block;behavior:url(#default#VML);",n=this.isIE8;return t=t.join(""),n?(t=t.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),t=-1===t.indexOf('style="')?t.replace("/>",' style="'+e+'" />'):t.replace('style="','style="'+e)):t=t.replace("<","<hcv:"),t},text:zn.prototype.html,path:function(e){var n={coordsize:"10 10"};return s(e)?n.d=e:a(e)&&t(n,e),this.createElement("shape").attr(n)},circle:function(t,e,n){return a(t)&&(n=t.r,e=t.y,t=t.x),this.symbol("circle").attr({x:t-n,y:e-n,width:2*n,height:2*n})},g:function(t){var e,n;return t&&(n={className:Xe+t,"class":Xe+t}),e=this.createElement(je).attr(n)},image:function(t,e,n,i,r){var a=this.createElement("img").attr({src:t});return arguments.length>1&&a.attr({x:e,y:n,width:i,height:r}),a},rect:function(t,e,n,i,r,s){a(t)&&(e=t.y,n=t.width,i=t.height,s=t.strokeWidth,t=t.x);var o=this.symbol("rect");return o.r=r,o.attr(o.crisp(s,t,e,xe(n,0),xe(i,0)))},invertChild:function(t,e){var n=e.style;g(t,{flip:"x",left:i(n.width)-1,top:i(n.height)-1,rotation:-90})},symbols:{arc:function(t,e,n,i,r){var a,s=r.start,o=r.end,l=r.r||n||i,c=r.innerR,u=Se(s),h=_e(s),d=Se(o),f=_e(o);return 0===o-s?["x"]:(a=["wa",t-l,e-l,t+l,e+l,t+l*u,e+l*h,t+l*d,e+l*f],r.open&&!c&&a.push("e",Qe,t,e),a.push("at",t-c,e-c,t+c,e+c,t+c*d,e+c*f,t+c*u,e+c*h,"x","e"),a)},circle:function(t,e,n,i){return["wa",t,e,t+n,e+i,t+n,e+i/2,t+n,e+i/2,"e"]},rect:function(t,e,n,i,r){var a,s,o=t+n,l=e+i;return h(r)&&r.r?(s=we(r.r,n,i),a=[Qe,t+s,e,tn,o-s,e,"wa",o-2*s,e,o,e+2*s,o-s,e,o,e+s,tn,o,l-s,"wa",o-2*s,l-2*s,o,l,o,l-s,o-s,l,tn,t+s,l,"wa",t,l-2*s,t+2*s,l,t+s,l,t,l-s,tn,t,e+s,"wa",t,e,t+2*s,e+2*s,t,e+s,t+s,e,"x","e"]):a=zn.prototype.symbols.square.apply(0,arguments),a}}};Highcharts.VMLRenderer=Fn=function(){this.init.apply(this,arguments)},Fn.prototype=e(zn.prototype,$n),X=Fn}var In,Nn;Le&&(Highcharts.CanVGRenderer=In=function(){Ue="http://www.w3.org/1999/xhtml"},In.prototype.symbols={},Nn=function(){function t(){var t,n=e.length;for(t=0;n>t;t++)e[t]();e=[]}var e=[];return{push:function(n,i){0===e.length&&bn(i,t),e.push(n)}}}(),X=In),N.prototype={addLabel:function(){var e,n,i,r,a=this,s=a.axis,l=s.options,u=s.chart,d=s.horiz,f=s.categories,g=s.series[0]&&s.series[0].names,m=a.pos,v=l.labels,y=s.tickPositions,b=d&&f&&!v.step&&!v.staggerLines&&!v.rotation&&u.plotWidth/y.length||!d&&u.plotWidth/2,x=m===y[0],w=m===y[y.length-1],T=f?p(f[m],g&&g[m],m):m,S=a.label,_=y.info;s.isDatetimeAxis&&_&&(r=l.dateTimeLabelFormats[_.higherRanks[m]||_.unitName]),a.isFirst=x,a.isLast=w,e=s.labelFormatter.call({axis:s,chart:u,isFirst:x,isLast:w,dateTimeLabelFormat:r,value:s.isLog?U(c(T)):T}),n=b&&{width:xe(1,ve(b-2*(v.padding||10)))+Je},n=t(n,v.style),h(S)?S&&S.attr({text:e}).css(n):(i={align:v.align},o(v.rotation)&&(i.rotation=v.rotation),a.label=h(e)&&v.enabled?u.renderer.text(e,0,0,v.useHTML).attr(i).css(n).add(s.labelGroup):null)},getLabelSize:function(){var t=this.label,e=this.axis;return t?(this.labelBBox=t.getBBox())[e.horiz?"height":"width"]:0},getLabelSides:function(){var t=this.labelBBox,e=this.axis,n=e.options,i=n.labels,r=t.width,a=r*{left:0,center:.5,right:1}[i.align]-i.x;return[-a,r-a]},handleOverflow:function(t,e){var n=!0,i=this.axis,r=i.chart,a=this.isFirst,s=this.isLast,o=e.x,l=i.reversed,c=i.tickPositions;if(a||s){var u=this.getLabelSides(),h=u[0],d=u[1],f=r.plotLeft,p=f+i.len,g=i.ticks[c[t+(a?1:-1)]],m=g&&g.label.xy&&g.label.xy.x+g.getLabelSides()[a?0:1];a&&!l||s&&l?f>o+h&&(o=f-h,g&&o+d>m&&(n=!1)):o+d>p&&(o=p-d,g&&m>o+h&&(n=!1)),e.x=o}return n},getPosition:function(t,e,n,i){var r=this.axis,a=r.chart,s=i&&a.oldChartHeight||a.chartHeight;return{x:t?r.translate(e+n,null,null,i)+r.transB:r.left+r.offset+(r.opposite?(i&&a.oldChartWidth||a.chartWidth)-r.right-r.left:0),y:t?s-r.bottom+r.offset-(r.opposite?r.height:0):s-r.translate(e+n,null,null,i)-r.transB}},getLabelPosition:function(t,e,n,r,a,s,o,l){var c=this.axis,u=c.transA,d=c.reversed,f=c.staggerLines;return t=t+a.x-(s&&r?s*u*(d?-1:1):0),e=e+a.y-(s&&!r?s*u*(d?1:-1):0),h(a.y)||(e+=.9*i(n.styles.lineHeight)-n.getBBox().height/2),f&&(e+=16*(o/(l||1)%f)),{x:t,y:e}},getMarkPath:function(t,e,n,i,r,a){return a.crispLine([Qe,t,e,tn,t+(r?0:-n),e+(r?n:0)],i)},render:function(t,e,n){var i,r,a,s=this,o=s.axis,l=o.options,c=o.chart,u=c.renderer,h=o.horiz,d=s.type,f=s.label,g=s.pos,m=l.labels,v=s.gridLine,y=d?d+"Grid":"grid",b=d?d+"Tick":"tick",x=l[y+"LineWidth"],w=l[y+"LineColor"],T=l[y+"LineDashStyle"],S=l[b+"Length"],_=l[b+"Width"]||0,A=l[b+"Color"],C=l[b+"Position"],M=s.mark,k=m.step,O=!0,D=o.tickmarkOffset,P=s.getPosition(h,g,D,e),E=P.x,Y=P.y,U=h&&E===o.pos||!h&&Y===o.pos+o.len?-1:1,z=o.staggerLines;this.isActive=!0,x&&(i=o.getPlotLinePath(g+D,x*U,e,!0),v===W&&(a={stroke:w,"stroke-width":x},T&&(a.dashstyle=T),d||(a.zIndex=1),e&&(a.opacity=0),s.gridLine=v=x?u.path(i).attr(a).add(o.gridGroup):null),!e&&v&&i&&v[s.isNew?"attr":"animate"]({d:i,opacity:n})),_&&S&&("inside"===C&&(S=-S),o.opposite&&(S=-S),r=s.getMarkPath(E,Y,S,_*U,h,u),M?M.animate({d:r,opacity:n}):s.mark=u.path(r).attr({stroke:A,"stroke-width":_,opacity:n}).add(o.axisGroup)),f&&!isNaN(E)&&(f.xy=P=s.getLabelPosition(E,Y,f,h,m,D,t,k),s.isFirst&&!p(l.showFirstLabel,1)||s.isLast&&!p(l.showLastLabel,1)?O=!1:z||!h||"justify"!==m.overflow||s.handleOverflow(t,P)||(O=!1),k&&t%k&&(O=!1),O&&!isNaN(P.y)?(P.opacity=n,f[s.isNew?"attr":"animate"](P),s.isNew=!1):f.attr("y",-9999))},destroy:function(){P(this,this.axis)}},R.prototype={render:function(){var t,n,i,r,a,s,o,c=this,u=c.axis,d=u.horiz,f=(u.pointRange||0)/2,g=c.options,m=g.label,v=c.label,y=g.width,b=g.to,x=g.from,w=h(x)&&h(b),T=g.value,S=g.dashStyle,_=c.svgElem,A=[],C=g.color,M=g.zIndex,k=g.events,P=u.chart.renderer;if(u.isLog&&(x=l(x),b=l(b),T=l(T)),y)A=u.getPlotLinePath(T,y),o={stroke:C,"stroke-width":y},S&&(o.dashstyle=S);else{if(!w)return;x=xe(x,u.min-f),b=we(b,u.max+f),A=u.getPlotBandPath(x,b,g),o={fill:C},g.borderWidth&&(o.stroke=g.borderColor,o["stroke-width"]=g.borderWidth)}if(h(M)&&(o.zIndex=M),_)A?_.animate({d:A},null,_.onGetPath):(_.hide(),_.onGetPath=function(){_.show()});else if(A&&A.length&&(c.svgElem=_=P.path(A).attr(o).add(),k)){t=function(t){_.on(t,function(e){k[t].apply(c,[e])})};for(n in k)t(n)}return m&&h(m.text)&&A&&A.length&&u.width>0&&u.height>0?(m=e({align:d&&w&&"center",x:d?!w&&4:10,verticalAlign:!d&&w&&"middle",y:d?w?16:10:w?6:-4,rotation:d&&!w&&90},m),v||(c.label=v=P.text(m.text,0,0).attr({align:m.textAlign||m.align,rotation:m.rotation,zIndex:M}).css(m.style).add()),i=[A[1],A[4],p(A[6],A[1])],r=[A[2],A[5],p(A[7],A[2])],a=O(i),s=O(r),v.align(m,!1,{x:a,y:s,width:D(i)-a,height:D(r)-s}),v.show()):v&&v.hide(),c},destroy:function(){var t=this,e=t.axis;u(e.plotLinesAndBands,t),P(t,this.axis)}},H.prototype={destroy:function(){P(this,this.axis)},setTotal:function(t){this.total=t,this.cum=t},render:function(t){var e=this.options,n=e.formatter.call(this);this.label?this.label.attr({text:n,visibility:We}):this.label=this.axis.chart.renderer.text(n,0,0,e.useHTML).css(e.style).attr({align:this.textAlign,rotation:e.rotation,visibility:We}).add(t)},setOffset:function(t,e){var n,i=this,r=i.axis,a=r.chart,s=a.inverted,o=this.isNegative,l=r.translate(this.percent?100:this.total,0,0,0,1),c=r.translate(0),u=Te(l-c),h=a.xAxis[0].translate(this.x)+t,d=a.plotHeight,f={x:s?o?l:l-u:h,y:s?d-h-e:o?d-l-u:d-l,width:s?u:e,height:s?e:u},p=this.label;p&&(p.align(this.alignOptions,null,f),n=p.alignAttr,p.attr({visibility:this.options.crop===!1||a.isInsidePlot(n.x,n.y)?ze?"inherit":Ge:We}))}},B.prototype={defaultOptions:{dateTimeLabelFormats:{millisecond:"%H:%M:%S.%L",second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%e. %b",week:"%e. %b",month:"%b '%y",year:"%Y"},endOnTick:!1,gridLineColor:"#C0C0C0",labels:Pn,lineColor:"#C0D0E0",lineWidth:1,minPadding:.01,maxPadding:.01,minorGridLineColor:"#E0E0E0",minorGridLineWidth:1,minorTickColor:"#A0A0A0",minorTickLength:2,minorTickPosition:"outside",startOfWeek:1,startOnTick:!1,tickColor:"#C0D0E0",tickLength:5,tickmarkPlacement:"between",tickPixelInterval:100,tickPosition:"outside",tickWidth:1,title:{align:"middle",style:{color:"#4d759e",fontWeight:"bold"}},type:"linear"},defaultYAxisOptions:{endOnTick:!0,gridLineWidth:1,tickPixelInterval:72,showLastLabel:!0,labels:{align:"right",x:-8,y:3},lineWidth:0,maxPadding:.05,minPadding:.05,startOnTick:!0,tickWidth:0,title:{rotation:270,text:"Values"},stackLabels:{enabled:!1,formatter:function(){return this.total},style:Pn.style}},defaultLeftAxisOptions:{labels:{align:"right",x:-8,y:null},title:{rotation:270}},defaultRightAxisOptions:{labels:{align:"left",x:8,y:null},title:{rotation:90}},defaultBottomAxisOptions:{labels:{align:"center",x:0,y:14},title:{rotation:0}},defaultTopAxisOptions:{labels:{align:"center",x:0,y:-5},title:{rotation:0}},init:function(t,e){var n=e.isX,i=this;i.horiz=t.inverted?!n:n,i.isXAxis=n,i.xOrY=n?"x":"y",i.opposite=e.opposite,i.side=i.horiz?i.opposite?0:2:i.opposite?1:3,i.setOptions(e);var r=this.options,a=r.type,s="datetime"===a;i.labelFormatter=r.labels.formatter||i.defaultLabelFormatter,i.staggerLines=i.horiz&&r.labels.staggerLines,i.userOptions=e,i.minPixelPadding=0,i.chart=t,i.reversed=r.reversed,i.zoomEnabled=r.zoomEnabled!==!1,i.categories=r.categories||"category"===a,i.isLog="logarithmic"===a,i.isDatetimeAxis=s,i.isLinked=h(r.linkedTo),i.tickmarkOffset=i.categories&&"between"===r.tickmarkPlacement?.5:0,i.ticks={},i.minorTicks={},i.plotLinesAndBands=[],i.alternateBands={},i.len=0,i.minRange=i.userMinRange=r.minRange||r.maxZoom,i.range=r.range,i.offset=r.offset||0,i.stacks={},i._stacksTouched=0,i.max=null,i.min=null;var o,u=i.options.events;-1===xn(i,t.axes)&&(t.axes.push(i),t[n?"xAxis":"yAxis"].push(i)),i.series=i.series||[],t.inverted&&n&&i.reversed===W&&(i.reversed=!0),i.removePlotBand=i.removePlotBandOrLine,i.removePlotLine=i.removePlotBandOrLine;for(o in u)An(i,o,u[o]);i.isLog&&(i.val2lin=l,i.lin2val=c)},setOptions:function(t){this.options=e(this.defaultOptions,this.isXAxis?{}:this.defaultYAxisOptions,[this.defaultTopAxisOptions,this.defaultRightAxisOptions,this.defaultBottomAxisOptions,this.defaultLeftAxisOptions][this.side],e(J[this.isXAxis?"xAxis":"yAxis"],t))},update:function(t,n){var i=this.chart;t=i.options[this.xOrY+"Axis"][this.options.index]=e(this.userOptions,t),this.destroy(),this._addedPlotLB=!1,this.init(i,t),i.isDirtyBox=!0,p(n,!0)&&i.redraw()},remove:function(t){var e=this.chart,n=this.xOrY+"Axis";wn(this.series,function(t){t.remove(!1)}),u(e.axes,this),u(e[n],this),e.options[n].splice(this.options.index,1),this.destroy(),e.isDirtyBox=!0,p(t,!0)&&e.redraw()},defaultLabelFormatter:function(){var t,e,n=this.axis,i=this.value,r=n.categories,a=this.dateTimeLabelFormat,s=J.lang.numericSymbols,o=s&&s.length,l=n.options.labels.format,c=n.isLog?i:n.tickInterval;if(l)e=S(l,this);else if(r)e=i;else if(a)e=K(a,i);else if(o&&c>=1e3)for(;o--&&e===W;)t=Math.pow(1e3,o+1),c>=t&&null!==s[o]&&(e=b(i/t,-1)+s[o]);return e===W&&(e=i>=1e3?b(i,0):b(i,-1)),e},getSeriesExtremes:function(){var t,e,n=this,i=n.chart,r=n.stacks,a=[],s=[],o=n._stacksTouched=n._stacksTouched+1;n.hasVisibleSeries=!1,n.dataMin=n.dataMax=null,wn(n.series,function(t){if(t.visible||!i.options.chart.ignoreHiddenSeries){var l,c,u,d,f,g,m,v,y,b,x,w,T,S=t.options,_=S.threshold,A=[],C=0;if(n.hasVisibleSeries=!0,n.isLog&&0>=_&&(_=S.threshold=null),n.isXAxis)m=t.xData,m.length&&(n.dataMin=we(p(n.dataMin,m[0]),O(m)),n.dataMax=xe(p(n.dataMax,m[0]),D(m)));else{var M,k,P,E,Y=t.cropped,z=t.xAxis.getExtremes(),F=!!t.modifyValue;for(l=S.stacking,n.usePercentage="percent"===l,l&&(f=S.stack,d=t.type+p(f,""),g="-"+d,t.stackKey=d,c=a[d]||[],a[d]=c,u=s[g]||[],s[g]=u),n.usePercentage&&(n.dataMin=0,n.dataMax=99),m=t.processedXData,v=t.processedYData,x=v.length,e=0;x>e;e++)if(y=m[e],b=v[e],l&&(M=_>b,k=M?u:c,P=M?g:d,h(k[y])?(k[y]=U(k[y]+b),b=[b,k[y]]):k[y]=b,r[P]||(r[P]={}),r[P][y]||(r[P][y]=new H(n,n.options.stackLabels,M,y,f,l)),r[P][y].setTotal(k[y]),r[P][y].touched=o),null!==b&&b!==W&&(!n.isLog||b>0)&&(F&&(b=t.modifyValue(b)),t.getExtremesFromAll||Y||(m[e+1]||y)>=z.min&&(m[e-1]||y)<=z.max))if(E=b.length)for(;E--;)null!==b[E]&&(A[C++]=b[E]);else A[C++]=b;!n.usePercentage&&A.length&&(t.dataMin=w=O(A),t.dataMax=T=D(A),n.dataMin=we(p(n.dataMin,w),w),n.dataMax=xe(p(n.dataMax,T),T)),h(_)&&(n.dataMin>=_?(n.dataMin=_,n.ignoreMinPadding=!0):_>n.dataMax&&(n.dataMax=_,n.ignoreMaxPadding=!0))}}});for(t in r)for(e in r[t])o>r[t][e].touched&&(r[t][e].destroy(),delete r[t][e])},translate:function(t,e,n,i,r,a){var s,o=this,l=o.len,c=1,u=0,h=i?o.oldTransA:o.transA,d=i?o.oldMin:o.min,f=o.minPixelPadding,p=(o.options.ordinal||o.isLog&&r)&&o.lin2val;return h||(h=o.transA),n&&(c*=-1,u=l),o.reversed&&(c*=-1,u-=c*l),e?(t=t*c+u,t-=f,s=t/h+d,p&&(s=o.lin2val(s))):(p&&(t=o.val2lin(t)),s=c*(t-d)*h+u+c*f+(a?h*o.pointRange/2:0)),s},toPixels:function(t,e){return this.translate(t,!1,!this.horiz,null,!0)+(e?0:this.pos)},toValue:function(t,e){return this.translate(t-(e?0:this.pos),!0,!this.horiz,null,!0)},getPlotLinePath:function(t,e,n,i){var r,a,s,o,l,c=this,u=c.chart,h=c.left,d=c.top,f=c.translate(t,null,null,n),p=n&&u.oldChartHeight||u.chartHeight,g=n&&u.oldChartWidth||u.chartWidth,m=c.transB;return r=s=ve(f+m),a=o=ve(p-f-m),isNaN(f)?l=!0:c.horiz?(a=d,o=p-c.bottom,(h>r||r>h+c.width)&&(l=!0)):(r=h,s=g-c.right,(d>a||a>d+c.height)&&(l=!0)),l&&!i?null:u.renderer.crispLine([Qe,r,a,tn,s,o],e||0)},getPlotBandPath:function(t,e){var n=this.getPlotLinePath(e),i=this.getPlotLinePath(t);return i&&n?i.push(n[4],n[5],n[1],n[2]):i=null,i},getLinearTickPositions:function(t,e,n){var i,r,a=U(ye(e/t)*t),s=U(be(n/t)*t),o=[];for(i=a;s>=i&&(o.push(i),i=U(i+t),i!==r);)r=i;return o},getLogTickPositions:function(t,e,n,i){var r=this,a=r.options,s=r.len,o=[];if(i||(r._minorAutoInterval=null),t>=.5)t=ve(t),o=r.getLinearTickPositions(t,e,n);else if(t>=.08){var u,h,d,f,g,m,v,y=ye(e);for(u=t>.3?[1,2,4]:t>.15?[1,2,4,6,8]:[1,2,3,4,5,6,7,8,9],h=y;n+1>h&&!v;h++)for(f=u.length,d=0;f>d&&!v;d++)g=l(c(h)*u[d]),g>e&&n>=m&&o.push(m),m>n&&(v=!0),m=g}else{var b=c(e),x=c(n),w=a[i?"minorTickInterval":"tickInterval"],T="auto"===w?null:w,S=a.tickPixelInterval/(i?5:1),A=i?s/r.tickPositions.length:s;t=p(T,r._minorAutoInterval,(x-b)*S/(A||1)),t=_(t,null,me.pow(10,ye(me.log(t)/me.LN10))),o=_n(r.getLinearTickPositions(t,b,x),l),i||(r._minorAutoInterval=t/5)}return i||(r.tickInterval=t),o},getMinorTickPositions:function(){var t,e,n,i=this,r=i.options,a=i.tickPositions,s=i.minorTickInterval,o=[];if(i.isLog)for(n=a.length,e=1;n>e;e++)o=o.concat(i.getLogTickPositions(s,a[e-1],a[e],!0));else if(i.isDatetimeAxis&&"auto"===r.minorTickInterval)o=o.concat(C(A(s),i.min,i.max,r.startOfWeek)),o[0]<i.min&&o.shift();else for(t=i.min+(a[0]-i.min)%s;i.max>=t;t+=s)o.push(t);return o},adjustForMinRange:function(){var t,e,n,i,r,a,s,o,l=this,c=l.options,u=l.min,d=l.max,f=l.dataMax-l.dataMin>=l.minRange;if(l.isXAxis&&l.minRange===W&&!l.isLog&&(h(c.min)||h(c.max)?l.minRange=null:(wn(l.series,function(t){for(r=t.xData,a=t.xIncrement?1:r.length-1,n=a;n>0;n--)i=r[n]-r[n-1],(e===W||e>i)&&(e=i)}),l.minRange=we(5*e,l.dataMax-l.dataMin))),l.minRange>d-u){var g=l.minRange;t=(g-d+u)/2,s=[u-t,p(c.min,u-t)],f&&(s[2]=l.dataMin),u=D(s),o=[u+g,p(c.max,u+g)],f&&(o[2]=l.dataMax),d=O(o),g>d-u&&(s[0]=d-g,s[1]=p(c.min,d-g),u=D(s))}l.min=u,l.max=d},setAxisTranslation:function(t){var e,n=this,i=n.max-n.min,r=0,a=0,s=0,o=n.linkedParent,l=n.transA;n.isXAxis&&(o?(a=o.minPointOffset,s=o.pointRangePadding):wn(n.series,function(t){var n=t.pointRange,o=t.options.pointPlacement,l=t.closestPointRange;n>i&&(n=0),r=xe(r,n),a=xe(a,o?0:n/2),s=xe(s,"on"===o?0:n),!t.noSharedTooltip&&h(l)&&(e=h(e)?we(e,l):l)}),n.minPointOffset=a,n.pointRangePadding=s,n.pointRange=we(r,i),n.closestPointRange=e),t&&(n.oldTransA=l),n.translationSlope=n.transA=l=n.len/(i+s||1),n.transB=n.horiz?n.left:n.bottom,n.minPixelPadding=l*a},setTickPositions:function(t){var e,n,i,r,a=this,s=a.chart,o=a.options,c=a.isLog,u=a.isDatetimeAxis,d=a.isXAxis,f=a.isLinked,g=a.options.tickPositioner,m=o.maxPadding,v=o.minPadding,y=o.tickInterval,b=o.minTickInterval,x=o.tickPixelInterval,w=a.categories;if(f?(a.linkedParent=s[d?"xAxis":"yAxis"][o.linkedTo],i=a.linkedParent.getExtremes(),a.min=p(i.min,i.dataMin),a.max=p(i.max,i.dataMax),o.type!==a.linkedParent.options.type&&Y(11,1)):(a.min=p(a.userMin,o.min,a.dataMin),a.max=p(a.userMax,o.max,a.dataMax)),c&&(!t&&0>=we(a.min,p(a.dataMin,a.min))&&Y(10,1),a.min=U(l(a.min)),a.max=U(l(a.max))),a.range&&(a.userMin=a.min=xe(a.min,a.max-a.range),a.userMax=a.max,t&&(a.range=null)),a.beforePadding&&a.beforePadding(),a.adjustForMinRange(),w||a.usePercentage||f||!h(a.min)||!h(a.max)||(n=a.max-a.min,n&&(h(o.min)||h(a.userMin)||!v||!(0>a.dataMin)&&a.ignoreMinPadding||(a.min-=n*v),h(o.max)||h(a.userMax)||!m||!(a.dataMax>0)&&a.ignoreMaxPadding||(a.max+=n*m))),a.tickInterval=a.min===a.max||void 0===a.min||void 0===a.max?1:f&&!y&&x===a.linkedParent.options.tickPixelInterval?a.linkedParent.tickInterval:p(y,w?1:(a.max-a.min)*x/(a.len||1)),d&&!t&&wn(a.series,function(t){t.processData(a.min!==a.oldMin||a.max!==a.oldMax)
}),a.setAxisTranslation(!0),a.beforeSetTickPositions&&a.beforeSetTickPositions(),a.postProcessTickInterval&&(a.tickInterval=a.postProcessTickInterval(a.tickInterval)),!y&&b>a.tickInterval&&(a.tickInterval=b),u||c||(e=me.pow(10,ye(me.log(a.tickInterval)/me.LN10)),y||(a.tickInterval=_(a.tickInterval,null,e,o))),a.minorTickInterval="auto"===o.minorTickInterval&&a.tickInterval?a.tickInterval/5:o.minorTickInterval,a.tickPositions=r=o.tickPositions?[].concat(o.tickPositions):g&&g.apply(a,[a.min,a.max]),r||(r=u?(a.getNonLinearTimeTicks||C)(A(a.tickInterval,o.units),a.min,a.max,o.startOfWeek,a.ordinalPositions,a.closestPointRange,!0):c?a.getLogTickPositions(a.tickInterval,a.min,a.max):a.getLinearTickPositions(a.tickInterval,a.min,a.max),a.tickPositions=r),!f){var T,S=r[0],M=r[r.length-1],k=a.minPointOffset||0;o.startOnTick?a.min=S:a.min-k>S&&r.shift(),o.endOnTick?a.max=M:M>a.max+k&&r.pop(),1===r.length&&(T=.001,a.min-=T,a.max+=T)}},setMaxTicks:function(){var t=this.chart,e=t.maxTicks||{},n=this.tickPositions,i=this._maxTicksKey=[this.xOrY,this.pos,this.len].join("-");!this.isLinked&&!this.isDatetimeAxis&&n&&n.length>(e[i]||0)&&this.options.alignTicks!==!1&&(e[i]=n.length),t.maxTicks=e},adjustTickAmount:function(){var t=this,e=t.chart,n=t._maxTicksKey,i=t.tickPositions,r=e.maxTicks;if(r&&r[n]&&!t.isDatetimeAxis&&!t.categories&&!t.isLinked&&t.options.alignTicks!==!1){var a,s=t.tickAmount,o=i.length;if(t.tickAmount=a=r[n],a>o){for(;a>i.length;)i.push(U(i[i.length-1]+t.tickInterval));t.transA*=(o-1)/(a-1),t.max=i[i.length-1]}h(s)&&a!==s&&(t.isDirty=!0)}},setScale:function(){var t,e,n,i,r=this,a=r.stacks;if(r.oldMin=r.min,r.oldMax=r.max,r.oldAxisLength=r.len,r.setAxisSize(),i=r.len!==r.oldAxisLength,wn(r.series,function(t){(t.isDirtyData||t.isDirty||t.xAxis.isDirty)&&(n=!0)}),(i||n||r.isLinked||r.forceRedraw||r.userMin!==r.oldUserMin||r.userMax!==r.oldUserMax)&&(r.forceRedraw=!1,r.getSeriesExtremes(),r.setTickPositions(),r.oldUserMin=r.userMin,r.oldUserMax=r.userMax,r.isDirty||(r.isDirty=i||r.min!==r.oldMin||r.max!==r.oldMax)),!r.isXAxis)for(t in a)for(e in a[t])a[t][e].cum=a[t][e].total;r.setMaxTicks()},setExtremes:function(e,n,i,r,a){var s=this,o=s.chart;i=p(i,!0),a=t(a,{min:e,max:n}),Mn(s,"setExtremes",a,function(){s.userMin=e,s.userMax=n,s.isDirtyExtremes=!0,i&&o.redraw(r)})},zoom:function(t,e){return this.dataMin>=t&&(t=W),e>=this.dataMax&&(e=W),this.displayBtn=t!==W||e!==W,this.setExtremes(t,e,!1,W,{trigger:"zoom"}),!0},setAxisSize:function(){var t,e,n,i,r=this.chart,a=this.options,s=a.offsetLeft||0,o=a.offsetRight||0,l=this.horiz;this.left=i=p(a.left,r.plotLeft+s),this.top=n=p(a.top,r.plotTop),this.width=t=p(a.width,r.plotWidth-s+o),this.height=e=p(a.height,r.plotHeight),this.bottom=r.chartHeight-e-n,this.right=r.chartWidth-t-i,this.len=xe(l?t:e,0),this.pos=l?i:n},getExtremes:function(){var t=this,e=t.isLog;return{min:e?U(c(t.min)):t.min,max:e?U(c(t.max)):t.max,dataMin:t.dataMin,dataMax:t.dataMax,userMin:t.userMin,userMax:t.userMax}},getThreshold:function(t){var e=this,n=e.isLog,i=n?c(e.min):e.min,r=n?c(e.max):e.max;return i>t||null===t?t=i:t>r&&(t=r),e.translate(t,0,1,0,1)},addPlotBand:function(t){this.addPlotBandOrLine(t,"plotBands")},addPlotLine:function(t){this.addPlotBandOrLine(t,"plotLines")},addPlotBandOrLine:function(t,e){var n=new R(this,t).render(),i=this.userOptions;return e&&(i[e]=i[e]||[],i[e].push(t)),this.plotLinesAndBands.push(n),n},getOffset:function(){var t,e,n,i,r=this,a=r.chart,s=a.renderer,o=r.options,l=r.tickPositions,c=r.ticks,u=r.horiz,d=r.side,f=a.inverted?[1,0,3,2][d]:d,g=0,m=0,v=o.title,y=o.labels,b=0,x=a.axisOffset,w=a.clipOffset,T=[-1,1,1,-1][d];if(r.hasData=t=r.hasVisibleSeries||h(r.min)&&h(r.max)&&!!l,r.showAxis=e=t||p(o.showEmpty,!0),r.axisGroup||(r.gridGroup=s.g("grid").attr({zIndex:o.gridZIndex||1}).add(),r.axisGroup=s.g("axis").attr({zIndex:o.zIndex||2}).add(),r.labelGroup=s.g("axis-labels").attr({zIndex:y.zIndex||7}).add()),t||r.isLinked)wn(l,function(t){c[t]?c[t].addLabel():c[t]=new N(r,t)}),wn(l,function(t){(0===d||2===d||{1:"left",3:"right"}[d]===y.align)&&(b=xe(c[t].getLabelSize(),b))}),r.staggerLines&&(b+=16*(r.staggerLines-1));else for(i in c)c[i].destroy(),delete c[i];v&&v.text&&v.enabled!==!1&&(r.axisTitle||(r.axisTitle=s.text(v.text,0,0,v.useHTML).attr({zIndex:7,rotation:v.rotation||0,align:v.textAlign||{low:"left",middle:"center",high:"right"}[v.align]}).css(v.style).add(r.axisGroup),r.axisTitle.isNew=!0),e&&(g=r.axisTitle.getBBox()[u?"height":"width"],m=p(v.margin,u?5:10),n=v.offset),r.axisTitle[e?"show":"hide"]()),r.offset=T*p(o.offset,x[d]),r.axisTitleMargin=p(n,b+m+(2!==d&&b&&T*o.labels[u?"y":"x"])),x[d]=xe(x[d],r.axisTitleMargin+g+T*r.offset),w[f]=xe(w[f],o.lineWidth)},getLinePath:function(t){var e=this.chart,n=this.opposite,i=this.offset,r=this.horiz,a=this.left+(n?this.width:0)+i,s=e.chartHeight-this.bottom-(n?this.height:0)+i;return this.lineTop=s,n||(t*=-1),e.renderer.crispLine([Qe,r?this.left:a,r?s:this.top,tn,r?e.chartWidth-this.right:a,r?s:e.chartHeight-this.bottom],t)},getTitlePosition:function(){var t=this.horiz,e=this.left,n=this.top,r=this.len,a=this.options.title,s=t?e:n,o=this.opposite,l=this.offset,c=i(a.style.fontSize||12),u={low:s+(t?0:r),middle:s+r/2,high:s+(t?r:0)}[a.align],h=(t?n+this.height:e)+(t?1:-1)*(o?-1:1)*this.axisTitleMargin+(2===this.side?c:0);return{x:t?u:h+(o?this.width:0)+l+(a.x||0),y:t?h-(o?this.height:0)+l:u+(a.y||0)}},render:function(){var t,e,n,i=this,r=i.chart,a=r.renderer,s=i.options,o=i.isLog,l=i.isLinked,u=i.tickPositions,d=i.axisTitle,f=i.stacks,p=i.ticks,g=i.minorTicks,m=i.alternateBands,v=s.stackLabels,y=s.alternateGridColor,b=i.tickmarkOffset,x=s.lineWidth,w=r.hasRendered,T=w&&h(i.oldMin)&&!isNaN(i.oldMin),S=i.hasData,_=i.showAxis;if((S||l)&&(wn([p,g,m],function(t){var e;for(e in t)t[e].isActive=!1}),i.minorTickInterval&&!i.categories&&wn(i.getMinorTickPositions(),function(t){g[t]||(g[t]=new N(i,t,"minor")),T&&g[t].isNew&&g[t].render(null,!0),g[t].render(null,!1,1)}),u.length&&(wn(u.slice(1).concat([u[0]]),function(t,e){e=e===u.length-1?0:e+1,(!l||t>=i.min&&i.max>=t)&&(p[t]||(p[t]=new N(i,t)),T&&p[t].isNew&&p[t].render(e,!0),p[t].render(e,!1,1))}),b&&0===i.min&&(p[-1]||(p[-1]=new N(i,-1,null,!0)),p[-1].render(-1))),y&&wn(u,function(t,r){0===r%2&&i.max>t&&(m[t]||(m[t]=new R(i)),e=t+b,n=u[r+1]!==W?u[r+1]+b:i.max,m[t].options={from:o?c(e):e,to:o?c(n):n,color:y},m[t].render(),m[t].isActive=!0)}),i._addedPlotLB||(wn((s.plotLines||[]).concat(s.plotBands||[]),function(t){i.addPlotBandOrLine(t)}),i._addedPlotLB=!0)),wn([p,g,m],function(t){var e,n,i=[],a=Q?Q.duration||500:0,s=function(){for(n=i.length;n--;)t[i[n]]&&!t[i[n]].isActive&&(t[i[n]].destroy(),delete t[i[n]])};for(e in t)t[e].isActive||(t[e].render(e,!1,0),t[e].isActive=!1,i.push(e));t!==m&&r.hasRendered&&a?a&&setTimeout(s,a):s()}),x&&(t=i.getLinePath(x),i.axisLine?i.axisLine.animate({d:t}):i.axisLine=a.path(t).attr({stroke:s.lineColor,"stroke-width":x,zIndex:7}).add(i.axisGroup),i.axisLine[_?"show":"hide"]()),d&&_&&(d[d.isNew?"attr":"animate"](i.getTitlePosition()),d.isNew=!1),v&&v.enabled){var A,C,M,k=i.stackTotalGroup;k||(i.stackTotalGroup=k=a.g("stack-labels").attr({visibility:Ge,zIndex:6}).add()),k.translate(r.plotLeft,r.plotTop);for(A in f){C=f[A];for(M in C)C[M].render(k)}}i.isDirty=!1},removePlotBandOrLine:function(t){for(var e=this.plotLinesAndBands,n=e.length;n--;)e[n].id===t&&e[n].destroy()},setTitle:function(t,e){this.update({title:t},e)},redraw:function(){var t=this,e=t.chart,n=e.pointer;n.reset&&n.reset(!0),t.render(),wn(t.plotLinesAndBands,function(t){t.render()}),wn(t.series,function(t){t.isDirty=!0})},setCategories:function(t,e){this.update({categories:t},e)},destroy:function(){var t,e=this,n=e.stacks;Cn(e);for(t in n)P(n[t]),n[t]=null;wn([e.ticks,e.minorTicks,e.alternateBands,e.plotLinesAndBands],function(t){P(t)}),wn(["stackTotalGroup","axisLine","axisGroup","gridGroup","labelGroup","axisTitle"],function(t){e[t]&&(e[t]=e[t].destroy())})}},V.prototype={init:function(t,e){var n=e.borderWidth,r=e.style,a=i(r.padding);this.chart=t,this.options=e,this.crosshairs=[],this.now={x:0,y:0},this.isHidden=!0,this.label=t.renderer.label("",0,0,e.shape,null,null,e.useHTML,null,"tooltip").attr({padding:a,fill:e.backgroundColor,"stroke-width":n,r:e.borderRadius,zIndex:8}).css(r).css({padding:0}).hide().add(),Le||this.label.shadow(e.shadow),this.shared=e.shared},destroy:function(){wn(this.crosshairs,function(t){t&&t.destroy()}),this.label&&(this.label=this.label.destroy())},move:function(e,n,i,r){var a=this,s=a.now,o=a.options.animation!==!1&&!a.isHidden;t(s,{x:o?(2*s.x+e)/3:e,y:o?(s.y+n)/2:n,anchorX:o?(2*s.anchorX+i)/3:i,anchorY:o?(s.anchorY+r)/2:r}),a.label.attr(s),o&&(Te(e-s.x)>1||Te(n-s.y)>1)&&(clearTimeout(this.tooltipTimeout),this.tooltipTimeout=setTimeout(function(){a&&a.move(e,n,i,r)},32))},hide:function(){var t,e=this;this.isHidden||(t=this.chart.hoverPoints,this.hideTimer=setTimeout(function(){e.label.fadeOut(),e.isHidden=!0},p(this.options.hideDelay,500)),t&&wn(t,function(t){t.setState()}),this.chart.hoverPoints=null)},hideCrosshairs:function(){wn(this.crosshairs,function(t){t&&t.hide()})},getAnchor:function(t,e){var n,i,r=this.chart,a=r.inverted,s=r.plotTop,o=0,l=0;return t=f(t),n=t[0].tooltipPos,this.followPointer&&e&&(e.chartX===W&&(e=r.pointer.normalize(e)),n=[e.chartX-r.plotLeft,e.chartY-s]),n||(wn(t,function(t){i=t.series.yAxis,o+=t.plotX,l+=(t.plotLow?(t.plotLow+t.plotHigh)/2:t.plotY)+(!a&&i?i.top-s:0)}),o/=t.length,l/=t.length,n=[a?r.plotWidth-l:o,this.shared&&!a&&t.length>1&&e?e.chartY-s:a?r.plotHeight-o:l]),_n(n,ve)},getPosition:function(t,e,n){var i,r=this.chart,a=r.plotLeft,s=r.plotTop,o=r.plotWidth,l=r.plotHeight,c=p(this.options.distance,12),u=n.plotX,h=n.plotY,d=u+a+(r.inverted?c:-t-c),f=h-e+s+15;return 7>d&&(d=a+xe(u,0)+c),d+t>a+o&&(d-=d+t-(a+o),f=h-e+s-c,i=!0),s+5>f&&(f=s+5,i&&h>=f&&f+e>=h&&(f=h+s+c)),f+e>s+l&&(f=xe(s,s+l-e-c)),{x:d,y:f}},defaultFormatter:function(t){var e,n=this.points||f(this),i=n[0].series;return e=[i.tooltipHeaderFormatter(n[0])],wn(n,function(t){i=t.series,e.push(i.tooltipFormatter&&i.tooltipFormatter(t)||t.point.tooltipFormatter(i.tooltipOptions.pointFormat))}),e.push(t.options.footerFormat||""),e.join("")},refresh:function(t,e){var n,i,r,a,s,o,l,c=this,u=c.chart,h=c.label,d=c.options,g={},m=[],v=d.formatter||c.defaultFormatter,y=u.hoverPoints,b=d.crosshairs,x=c.shared;if(clearTimeout(this.hideTimer),c.followPointer=f(t)[0].series.tooltipOptions.followPointer,a=c.getAnchor(t,e),n=a[0],i=a[1],!x||t.series&&t.series.noSharedTooltip?g=t.getLabelConfig():(u.hoverPoints=t,y&&wn(y,function(t){t.setState()}),wn(t,function(t){t.setState(rn),m.push(t.getLabelConfig())}),g={x:t[0].category,y:t[0].y},g.points=m,t=t[0]),s=v.call(g,c),l=t.series,r=x||!l.isCartesian||l.tooltipOutsidePlot||u.isInsidePlot(n,i),s!==!1&&r?(c.isHidden&&(Dn(h),h.attr("opacity",1).show()),h.attr({text:s}),o=d.borderColor||t.color||l.color||"#606060",h.attr({stroke:o}),c.updatePosition({plotX:n,plotY:i}),this.isHidden=!1):this.hide(),b){b=f(b);for(var w,T,S,_=b.length;_--;)S=t.series[_?"yAxis":"xAxis"],b[_]&&S&&(w=S.getPlotLinePath(_?p(t.stackY,t.y):t.x,1),c.crosshairs[_]?c.crosshairs[_].attr({d:w,visibility:Ge}):(T={"stroke-width":b[_].width||1,stroke:b[_].color||"#C0C0C0",zIndex:b[_].zIndex||2},b[_].dashStyle&&(T.dashstyle=b[_].dashStyle),c.crosshairs[_]=u.renderer.path(w).attr(T).add()))}Mn(u,"tooltipRefresh",{text:s,x:n+u.plotLeft,y:i+u.plotTop,borderColor:o})},updatePosition:function(t){var e=this.chart,n=this.label,i=(this.options.positioner||this.getPosition).call(this,n.width,n.height,t);this.move(ve(i.x),ve(i.y),t.plotX+e.plotLeft,t.plotY+e.plotTop)}},j.prototype={init:function(t,e){var n,i,r=Le?"":e.chart.zoomType,a=t.inverted;this.options=e,this.chart=t,this.zoomX=n=/x/.test(r),this.zoomY=i=/y/.test(r),this.zoomHor=n&&!a||i&&a,this.zoomVert=i&&!a||n&&a,this.pinchDown=[],this.lastValidTouch={},e.tooltip.enabled&&(t.tooltip=new V(t,e.tooltip)),this.setDOMEvents()},normalize:function(e){var n,i,r,a;return e=e||ge.event,e.target||(e.target=e.srcElement),e=kn(e),a=e.touches?e.touches.item(0):e,this.chartPosition=n=Sn(this.chart.container),a.pageX===W?(i=e.x,r=e.y):(i=a.pageX-n.left,r=a.pageY-n.top),t(e,{chartX:ve(i),chartY:ve(r)})},getCoordinates:function(t){var e={xAxis:[],yAxis:[]};return wn(this.chart.axes,function(n){e[n.isXAxis?"xAxis":"yAxis"].push({axis:n,value:n.toValue(t[n.horiz?"chartX":"chartY"])})}),e},getIndex:function(t){var e=this.chart;return e.inverted?e.plotHeight+e.plotTop-t.chartY:t.chartX-e.plotLeft},runPointActions:function(t){var e,n,i,r,a,s=this,o=s.chart,l=o.series,c=o.tooltip,u=o.hoverPoint,h=o.hoverSeries,d=o.chartWidth,f=s.getIndex(t);if(c&&s.options.tooltip.shared&&(!h||!h.noSharedTooltip)){for(n=[],i=l.length,r=0;i>r;r++)l[r].visible&&l[r].options.enableMouseTracking!==!1&&!l[r].noSharedTooltip&&l[r].tooltipPoints.length&&(e=l[r].tooltipPoints[f],e.series&&(e._dist=Te(f-e.clientX),d=we(d,e._dist),n.push(e)));for(i=n.length;i--;)n[i]._dist>d&&n.splice(i,1);n.length&&n[0].clientX!==s.hoverX&&(c.refresh(n,t),s.hoverX=n[0].clientX)}h&&h.tracker?(e=h.tooltipPoints[f],e&&e!==u&&e.onMouseOver(t)):c&&c.followPointer&&!c.isHidden&&(a=c.getAnchor([{}],t),c.updatePosition({plotX:a[0],plotY:a[1]}))},reset:function(t){var e=this,n=e.chart,i=n.hoverSeries,r=n.hoverPoint,a=n.tooltip,s=a&&a.shared?n.hoverPoints:r;t=t&&a&&s,t&&f(s)[0].plotX===W&&(t=!1),t?a.refresh(s):(r&&r.onMouseOut(),i&&i.onMouseOut(),a&&(a.hide(),a.hideCrosshairs()),e.hoverX=null)},scaleGroups:function(t,e){var n=this.chart;wn(n.series,function(i){i.xAxis.zoomEnabled&&(i.group.attr(t),i.markerGroup&&(i.markerGroup.attr(t),i.markerGroup.clip(e?n.clipRect:null)),i.dataLabelsGroup&&i.dataLabelsGroup.attr(t))}),n.clipRect.attr(e||n.clipBox)},pinchTranslateDirection:function(t,e,n,i,r,a,s){var o,l,c,u,h,d,f=this.chart,p=t?"x":"y",g=t?"X":"Y",m="chart"+g,v=t?"width":"height",y=f["plot"+(t?"Left":"Top")],b=1,x=f.inverted,w=f.bounds[t?"h":"v"],T=1===e.length,S=e[0][m],_=n[0][m],A=!T&&e[1][m],C=!T&&n[1][m],M=function(){!T&&Te(S-A)>20&&(b=Te(_-C)/Te(S-A)),c=(y-_)/b+S,o=f["plot"+(t?"Width":"Height")]/b};M(),l=c,w.min>l?(l=w.min,u=!0):l+o>w.max&&(l=w.max-o,u=!0),u?(_-=.8*(_-s[p][0]),T||(C-=.8*(C-s[p][1])),M()):s[p]=[_,C],x||(a[p]=c-y,a[v]=o),d=x?t?"scaleY":"scaleX":"scale"+g,h=x?1/b:b,r[v]=o,r[p]=l,i[d]=b,i["translate"+g]=h*y+(_-h*S)},pinch:function(e){var n=this,i=n.chart,r=n.pinchDown,a=e.touches,s=n.lastValidTouch,o=n.zoomHor||n.pinchHor,l=n.zoomVert||n.pinchVert,c=n.selectionMarker,u={},h={};"touchstart"===e.type&&(n.inClass(e.target,Xe+"tracker")?i.runTrackerClick||e.preventDefault():i.runChartClick||e.preventDefault()),_n(a,function(t){return n.normalize(t)}),"touchstart"===e.type?(wn(a,function(t,e){r[e]={chartX:t.chartX,chartY:t.chartY}}),s.x=[r[0].chartX,r[1]&&r[1].chartX],s.y=[r[0].chartY,r[1]&&r[1].chartY],wn(i.axes,function(t){if(t.zoomEnabled){var e=i.bounds[t.horiz?"h":"v"],n=t.minPixelPadding,r=t.toPixels(t.dataMin),a=t.toPixels(t.dataMax),s=we(r,a),o=xe(r,a);e.min=we(t.pos,s-n),e.max=xe(t.pos+t.len,o+n)}})):r.length&&(c||(n.selectionMarker=c=t({destroy:Re},i.plotBox)),o&&n.pinchTranslateDirection(!0,r,a,u,c,h,s),l&&n.pinchTranslateDirection(!1,r,a,u,c,h,s),n.hasPinched=o||l,n.scaleGroups(u,h))},dragStart:function(t){var e=this.chart;e.mouseIsDown=t.type,e.cancelClick=!1,e.mouseDownX=this.mouseDownX=t.chartX,this.mouseDownY=t.chartY},drag:function(t){var e,n,i=this.chart,r=i.options.chart,a=t.chartX,s=t.chartY,o=this.zoomHor,l=this.zoomVert,c=i.plotLeft,u=i.plotTop,h=i.plotWidth,d=i.plotHeight,f=this.mouseDownX,p=this.mouseDownY;c>a?a=c:a>c+h&&(a=c+h),u>s?s=u:s>u+d&&(s=u+d),this.hasDragged=Math.sqrt(Math.pow(f-a,2)+Math.pow(p-s,2)),this.hasDragged>10&&(e=i.isInsidePlot(f-c,p-u),i.hasCartesianSeries&&(this.zoomX||this.zoomY)&&e&&(this.selectionMarker||(this.selectionMarker=i.renderer.rect(c,u,o?1:h,l?1:d,0).attr({fill:r.selectionMarkerFill||"rgba(69,114,167,0.25)",zIndex:7}).add())),this.selectionMarker&&o&&(n=a-f,this.selectionMarker.attr({width:Te(n),x:(n>0?0:n)+f})),this.selectionMarker&&l&&(n=s-p,this.selectionMarker.attr({height:Te(n),y:(n>0?0:n)+p})),e&&!this.selectionMarker&&r.panning&&i.pan(a))},drop:function(e){var n=this.chart,i=this.hasPinched;if(this.selectionMarker){var r,a={xAxis:[],yAxis:[],originalEvent:e.originalEvent||e},s=this.selectionMarker,o=s.x,l=s.y;(this.hasDragged||i)&&(wn(n.axes,function(t){if(t.zoomEnabled){var e=t.horiz,n=t.minPixelPadding,i=t.toValue((e?o:l)+n),c=t.toValue((e?o+s.width:l+s.height)-n);isNaN(i)||isNaN(c)||(a[t.xOrY+"Axis"].push({axis:t,min:we(i,c),max:xe(i,c)}),r=!0)}}),r&&Mn(n,"selection",a,function(e){n.zoom(t(e,i?{animation:!1}:null))})),this.selectionMarker=this.selectionMarker.destroy(),i&&this.scaleGroups({translateX:n.plotLeft,translateY:n.plotTop,scaleX:1,scaleY:1})}n&&(g(n.container,{cursor:"auto"}),n.cancelClick=this.hasDragged,n.mouseIsDown=this.hasDragged=this.hasPinched=!1,this.pinchDown=[])},onContainerMouseDown:function(t){t=this.normalize(t),t.preventDefault&&t.preventDefault(),this.dragStart(t)},onDocumentMouseUp:function(t){this.drop(t)},onDocumentMouseMove:function(t){var e=this.chart,n=this.chartPosition,i=e.hoverSeries;t=kn(t),n&&i&&i.isCartesian&&!e.isInsidePlot(t.pageX-n.left-e.plotLeft,t.pageY-n.top-e.plotTop)&&this.reset()},onContainerMouseLeave:function(){this.reset(),this.chartPosition=null},onContainerMouseMove:function(t){var e=this.chart;t=this.normalize(t),t.returnValue=!1,"mousedown"===e.mouseIsDown&&this.drag(t),e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)&&this.runPointActions(t)},inClass:function(t,e){for(var n;t;){if(n=d(t,"class")){if(-1!==n.indexOf(e))return!0;if(-1!==n.indexOf(Xe+"container"))return!1}t=t.parentNode}},onTrackerMouseOut:function(t){var e=this.chart.hoverSeries;!e||e.options.stickyTracking||this.inClass(t.toElement||t.relatedTarget,Xe+"tooltip")||e.onMouseOut()},onContainerClick:function(e){var n,i,r,a=this.chart,s=a.hoverPoint,o=a.plotLeft,l=a.plotTop,c=a.inverted;e=this.normalize(e),e.cancelBubble=!0,a.cancelClick||(s&&this.inClass(e.target,Xe+"tracker")?(n=this.chartPosition,i=s.plotX,r=s.plotY,t(s,{pageX:n.left+o+(c?a.plotWidth-r:i),pageY:n.top+l+(c?a.plotHeight-i:r)}),Mn(s.series,"click",t(e,{point:s})),s.firePointEvent("click",e)):(t(e,this.getCoordinates(e)),a.isInsidePlot(e.chartX-o,e.chartY-l)&&Mn(a,"click",e)))},onContainerTouchStart:function(t){var e=this.chart;1===t.touches.length?(t=this.normalize(t),e.isInsidePlot(t.chartX-e.plotLeft,t.chartY-e.plotTop)&&(this.runPointActions(t),this.pinch(t))):2===t.touches.length&&this.pinch(t)},onContainerTouchMove:function(t){(1===t.touches.length||2===t.touches.length)&&this.pinch(t)},onDocumentTouchEnd:function(t){this.drop(t)},setDOMEvents:function(){var t,e=this,n=e.chart.container;this._events=t=[[n,"onmousedown","onContainerMouseDown"],[n,"onmousemove","onContainerMouseMove"],[n,"onclick","onContainerClick"],[n,"mouseleave","onContainerMouseLeave"],[pe,"mousemove","onDocumentMouseMove"],[pe,"mouseup","onDocumentMouseUp"]],$e&&t.push([n,"ontouchstart","onContainerTouchStart"],[n,"ontouchmove","onContainerTouchMove"],[pe,"touchend","onDocumentTouchEnd"]),wn(t,function(t){e["_"+t[2]]=function(n){e[t[2]](n)},0===t[1].indexOf("on")?t[0][t[1]]=e["_"+t[2]]:An(t[0],t[1],e["_"+t[2]])})},destroy:function(){var t=this;wn(t._events,function(e){0===e[1].indexOf("on")?e[0][e[1]]=null:Cn(e[0],e[1],t["_"+e[2]])}),delete t._events,clearInterval(t.tooltipTimeout)}},q.prototype={init:function(t,n){var r=this,a=n.itemStyle,s=p(n.padding,8),o=n.itemMarginTop||0;this.options=n,n.enabled&&(r.baseline=i(a.fontSize)+3+o,r.itemStyle=a,r.itemHiddenStyle=e(a,n.itemHiddenStyle),r.itemMarginTop=o,r.padding=s,r.initialItemX=s,r.initialItemY=s-5,r.maxItemWidth=0,r.chart=t,r.itemHeight=0,r.lastLineHeight=0,r.render(),An(r.chart,"endResize",function(){r.positionCheckboxes()}))},colorizeItem:function(t,e){var n,i,r=this,a=r.options,s=t.legendItem,o=t.legendLine,l=t.legendSymbol,c=r.itemHiddenStyle.color,u=e?a.itemStyle.color:c,h=e?t.color:c,d=t.options&&t.options.marker,f={stroke:h,fill:h};if(s&&s.css({fill:u,color:u}),o&&o.attr({stroke:h}),l){if(d){d=t.convertAttribs(d);for(n in d)i=d[n],i!==W&&(f[n]=i)}l.attr(f)}},positionItem:function(t){var e=this,n=e.options,i=n.symbolPadding,r=!n.rtl,a=t._legendItemPos,s=a[0],o=a[1],l=t.checkbox;t.legendGroup&&t.legendGroup.translate(r?s:e.legendWidth-s-2*i-4,o),l&&(l.x=s,l.y=o)},destroyItem:function(t){var e=t.checkbox;wn(["legendItem","legendLine","legendSymbol","legendGroup"],function(e){t[e]&&t[e].destroy()}),e&&E(t.checkbox)},destroy:function(){var t=this,e=t.group,n=t.box;n&&(t.box=n.destroy()),e&&(t.group=e.destroy())},positionCheckboxes:function(t){var e,n=this.group.alignAttr,i=this.clipHeight||this.legendHeight;n&&(e=n.translateY,wn(this.allItems,function(r){var a,s=r.checkbox;s&&(a=e+s.y+(t||0)+3,g(s,{left:n.translateX+r.legendItemWidth+s.x-20+Je,top:a+Je,display:a>e-6&&e+i-6>a?"":Ke}))}))},renderTitle:function(){var t=this.options,e=this.padding,n=t.title,i=0;n.text&&(this.title||(this.title=this.chart.renderer.label(n.text,e-3,e-4,null,null,null,null,null,"legend-title").attr({zIndex:1}).css(n.style).add(this.group)),i=this.title.getBBox().height,this.contentGroup.attr({translateY:i})),this.titleHeight=i},renderItem:function(t){var n,i,r,a=this,s=a.chart,o=s.renderer,l=a.options,c="horizontal"===l.layout,u=l.symbolWidth,h=l.symbolPadding,d=a.itemStyle,f=a.itemHiddenStyle,p=a.padding,g=!l.rtl,v=l.width,y=l.itemMarginBottom||0,b=a.itemMarginTop,x=a.initialItemX,w=t.legendItem,T=t.series||t,_=T.options,A=_.showCheckbox,C=l.useHTML;w||(t.legendGroup=o.g("legend-item").attr({zIndex:1}).add(a.scrollGroup),T.drawLegendSymbol(a,t),t.legendItem=w=o.text(l.labelFormat?S(l.labelFormat,t):l.labelFormatter.call(t),g?u+h:-h,a.baseline,C).css(e(t.visible?d:f)).attr({align:g?"left":"right",zIndex:2}).add(t.legendGroup),(C?w:t.legendGroup).on("mouseover",function(){t.setState(rn),w.css(a.options.itemHoverStyle)}).on("mouseout",function(){w.css(t.visible?d:f),t.setState()}).on("click",function(e){var n="legendItemClick",i=function(){t.setVisible()};e={browserEvent:e},t.firePointEvent?t.firePointEvent(n,e,i):Mn(t,n,e,i)}),a.colorizeItem(t,t.visible),_&&A&&(t.checkbox=m("input",{type:"checkbox",checked:t.selected,defaultChecked:t.selected},l.itemCheckboxStyle,s.container),An(t.checkbox,"click",function(e){var n=e.target;Mn(t,"checkboxClick",{checked:n.checked},function(){t.select()})}))),i=w.getBBox(),r=t.legendItemWidth=l.itemWidth||u+h+i.width+p+(A?20:0),a.itemHeight=n=i.height,c&&a.itemX-x+r>(v||s.chartWidth-2*p-x)&&(a.itemX=x,a.itemY+=b+a.lastLineHeight+y,a.lastLineHeight=0),a.maxItemWidth=xe(a.maxItemWidth,r),a.lastItemY=b+a.itemY+y,a.lastLineHeight=xe(n,a.lastLineHeight),t._legendItemPos=[a.itemX,a.itemY],c?a.itemX+=r:(a.itemY+=b+n+y,a.lastLineHeight=n),a.offsetWidth=v||xe(c?a.itemX-x:r,a.offsetWidth)},render:function(){var e,n,i,r,a=this,s=a.chart,o=s.renderer,l=a.group,c=a.box,u=a.options,d=a.padding,f=u.borderWidth,p=u.backgroundColor;a.itemX=a.initialItemX,a.itemY=a.initialItemY,a.offsetWidth=0,a.lastItemY=0,l||(a.group=l=o.g("legend").attr({zIndex:7}).add(),a.contentGroup=o.g().attr({zIndex:1}).add(l),a.scrollGroup=o.g().add(a.contentGroup),a.clipRect=o.clipRect(0,0,9999,s.chartHeight),a.contentGroup.clip(a.clipRect)),a.renderTitle(),e=[],wn(s.series,function(t){var n=t.options;n.showInLegend&&!h(n.linkedTo)&&(e=e.concat(t.legendItems||("point"===n.legendType?t.data:t)))}),k(e,function(t,e){return(t.options&&t.options.legendIndex||0)-(e.options&&e.options.legendIndex||0)}),u.reversed&&e.reverse(),a.allItems=e,a.display=n=!!e.length,wn(e,function(t){a.renderItem(t)}),i=u.width||a.offsetWidth,r=a.lastItemY+a.lastLineHeight+a.titleHeight,r=a.handleOverflow(r),(f||p)&&(i+=d,r+=d,c?i>0&&r>0&&(c[c.isNew?"attr":"animate"](c.crisp(null,null,null,i,r)),c.isNew=!1):(a.box=c=o.rect(0,0,i,r,u.borderRadius,f||0).attr({stroke:u.borderColor,"stroke-width":f||0,fill:p||Ke}).add(l).shadow(u.shadow),c.isNew=!0),c[n?"show":"hide"]()),a.legendWidth=i,a.legendHeight=r,wn(e,function(t){a.positionItem(t)}),n&&l.align(t({width:i,height:r},u),!0,"spacingBox"),s.isResizing||this.positionCheckboxes()},handleOverflow:function(t){var e,n,i=this,r=this.chart,a=r.renderer,s=this.options,o=s.y,l="top"===s.verticalAlign,c=r.spacingBox.height+(l?-o:o)-this.padding,u=s.maxHeight,h=this.clipRect,d=s.navigation,f=p(d.animation,!0),g=d.arrowSize||12,m=this.nav;return"horizontal"===s.layout&&(c/=2),u&&(c=we(c,u)),t>c&&!s.useHTML?(this.clipHeight=n=c-20-this.titleHeight,this.pageCount=e=be(t/n),this.currentPage=p(this.currentPage,1),this.fullHeight=t,h.attr({height:n}),m||(this.nav=m=a.g().attr({zIndex:1}).add(this.group),this.up=a.symbol("triangle",0,0,g,g).on("click",function(){i.scroll(-1,f)}).add(m),this.pager=a.text("",15,10).css(d.style).add(m),this.down=a.symbol("triangle-down",0,0,g,g).on("click",function(){i.scroll(1,f)}).add(m)),i.scroll(0),t=c):m&&(h.attr({height:r.chartHeight}),m.hide(),this.scrollGroup.attr({translateY:1}),this.clipHeight=0),t},scroll:function(t,e){var n,i=this.pageCount,r=this.currentPage+t,a=this.clipHeight,s=this.options.navigation,o=s.activeColor,l=s.inactiveColor,c=this.pager,u=this.padding;r>i&&(r=i),r>0&&(e!==W&&z(e,this.chart),this.nav.attr({translateX:u,translateY:a+7+this.titleHeight,visibility:Ge}),this.up.attr({fill:1===r?l:o}).css({cursor:1===r?"default":"pointer"}),c.attr({text:r+"/"+this.pageCount}),this.down.attr({x:18+this.pager.getBBox().width,fill:r===i?l:o}).css({cursor:r===i?"default":"pointer"}),n=-we(a*(r-1),this.fullHeight-a+u)+1,this.scrollGroup.animate({translateY:n}),c.attr({text:r+"/"+i}),this.currentPage=r,this.positionCheckboxes(n))}},Z.prototype={init:function(t,n){var i,r=t.series;t.series=null,i=e(J,t),i.series=t.series=r;var s=i.chart,o=s.margin,l=a(o)?o:[o,o,o,o];this.optionsMarginTop=p(s.marginTop,l[0]),this.optionsMarginRight=p(s.marginRight,l[1]),this.optionsMarginBottom=p(s.marginBottom,l[2]),this.optionsMarginLeft=p(s.marginLeft,l[3]);var c=s.events;this.runChartClick=c&&!!c.click,this.bounds={h:{},v:{}},this.callback=n,this.isResizing=0,this.options=i,this.axes=[],this.series=[],this.hasCartesianSeries=s.showAxes;var u,h=this;if(h.index=He.length,He.push(h),s.reflow!==!1&&An(h,"load",function(){h.initReflow()}),c)for(u in c)An(h,u,c[u]);h.xAxis=[],h.yAxis=[],h.animation=Le?!1:p(s.animation,!0),h.pointCount=0,h.counters=new M,h.firstRender()},initSeries:function(t){var e,n=this,i=n.options.chart,r=t.type||i.type||i.defaultSeriesType,a=gn[r];return a||Y(17,!0),e=new a,e.init(this,t),e},addSeries:function(t,e,n){var i,r=this;return t&&(e=p(e,!0),Mn(r,"addSeries",{options:t},function(){i=r.initSeries(t),r.isDirtyLegend=!0,e&&r.redraw(n)})),i},addAxis:function(t,n,i,r){var a,s=n?"xAxis":"yAxis",o=this.options;a=new B(this,e(t,{index:this[s].length})),o[s]=f(o[s]||{}),o[s].push(t),p(i,!0)&&this.redraw(r)},isInsidePlot:function(t,e,n){var i=n?e:t,r=n?t:e;return i>=0&&this.plotWidth>=i&&r>=0&&this.plotHeight>=r},adjustTickAmounts:function(){this.options.chart.alignTicks!==!1&&wn(this.axes,function(t){t.adjustTickAmount()}),this.maxTicks=null},redraw:function(t){var e,n,i=this,r=i.axes,a=i.series,s=i.pointer,o=i.legend,l=i.isDirtyLegend,c=i.isDirtyBox,u=a.length,h=u,d=i.renderer,f=d.isHidden(),p=[];for(z(t,i),f&&i.cloneRenderTo();h--;)if(n=a[h],n.isDirty&&n.options.stacking){e=!0;break}if(e)for(h=u;h--;)n=a[h],n.options.stacking&&(n.isDirty=!0);wn(a,function(t){t.isDirty&&"point"===t.options.legendType&&(l=!0)}),l&&o.options.enabled&&(o.render(),i.isDirtyLegend=!1),i.hasCartesianSeries&&(i.isResizing||(i.maxTicks=null,wn(r,function(t){t.setScale()})),i.adjustTickAmounts(),i.getMargins(),wn(r,function(t){t.isDirtyExtremes&&(t.isDirtyExtremes=!1,p.push(function(){Mn(t,"afterSetExtremes",t.getExtremes())})),(t.isDirty||c||e)&&(t.redraw(),c=!0)})),c&&i.drawChartBox(),wn(a,function(t){t.isDirty&&t.visible&&(!t.isCartesian||t.xAxis)&&t.redraw()}),s&&s.reset&&s.reset(!0),d.draw(),Mn(i,"redraw"),f&&i.cloneRenderTo(!0),wn(p,function(t){t.call()})},showLoading:function(e){var n=this,i=n.options,r=n.loadingDiv,a=i.loading;r||(n.loadingDiv=r=m(je,{className:Xe+"loading"},t(a.style,{left:n.plotLeft+Je,top:n.plotTop+Je,width:n.plotWidth+Je,height:n.plotHeight+Je,zIndex:10,display:Ke}),n.container),n.loadingSpan=m("span",null,a.labelStyle,r)),n.loadingSpan.innerHTML=e||i.lang.loading,n.loadingShown||(g(r,{opacity:0,display:""}),On(r,{opacity:a.style.opacity},{duration:a.showDuration||0}),n.loadingShown=!0)},hideLoading:function(){var t=this.options,e=this.loadingDiv;e&&On(e,{opacity:0},{duration:t.loading.hideDuration||100,complete:function(){g(e,{display:Ke})}}),this.loadingShown=!1},get:function(t){var e,n,i,r=this,a=r.axes,s=r.series;for(e=0;a.length>e;e++)if(a[e].options.id===t)return a[e];for(e=0;s.length>e;e++)if(s[e].options.id===t)return s[e];for(e=0;s.length>e;e++)for(i=s[e].points||[],n=0;i.length>n;n++)if(i[n].id===t)return i[n];return null},getAxes:function(){var t,e,n=this,i=this.options,r=i.xAxis=f(i.xAxis||{}),a=i.yAxis=f(i.yAxis||{});wn(r,function(t,e){t.index=e,t.isX=!0}),wn(a,function(t,e){t.index=e}),t=r.concat(a),wn(t,function(t){e=new B(n,t)}),n.adjustTickAmounts()},getSelectedPoints:function(){var t=[];return wn(this.series,function(e){t=t.concat(Tn(e.points,function(t){return t.selected}))}),t},getSelectedSeries:function(){return Tn(this.series,function(t){return t.selected})},showResetZoom:function(){var t=this,e=J.lang,n=t.options.chart.resetZoomButton,i=n.theme,r=i.states,a="chart"===n.relativeTo?null:"plotBox";this.resetZoomButton=t.renderer.button(e.resetZoom,null,null,function(){t.zoomOut()},i,r&&r.hover).attr({align:n.position.align,title:e.resetZoomTitle}).add().align(n.position,!1,a)},zoomOut:function(){var t=this;Mn(t,"selection",{resetSelection:!0},function(){t.zoom()})},zoom:function(t){var e,n,i=this,r=i.pointer,s=!1;!t||t.resetSelection?wn(i.axes,function(t){e=t.zoom()}):wn(t.xAxis.concat(t.yAxis),function(t){var n=t.axis,i=n.isXAxis;(r[i?"zoomX":"zoomY"]||r[i?"pinchX":"pinchY"])&&(e=n.zoom(t.min,t.max),n.displayBtn&&(s=!0))}),n=i.resetZoomButton,s&&!n?i.showResetZoom():!s&&a(n)&&(i.resetZoomButton=n.destroy()),e&&i.redraw(p(i.options.chart.animation,t&&t.animation,100>i.pointCount))},pan:function(t){var e=this,n=e.xAxis[0],i=e.mouseDownX,r=n.pointRange/2,a=n.getExtremes(),s=n.translate(i-t,!0)+r,o=n.translate(i+e.plotWidth-t,!0)-r,l=e.hoverPoints;l&&wn(l,function(t){t.setState()}),n.series.length&&s>we(a.dataMin,a.min)&&xe(a.dataMax,a.max)>o&&n.setExtremes(s,o,!0,!1,{trigger:"pan"}),e.mouseDownX=t,g(e.container,{cursor:"move"})},setTitle:function(t,n){var i,r,a=this,s=a.options;i=s.title=e(s.title,t),r=s.subtitle=e(s.subtitle,n),wn([["title",t,i],["subtitle",n,r]],function(t){var e=t[0],n=a[e],i=t[1],r=t[2];n&&i&&(a[e]=n=n.destroy()),r&&r.text&&!n&&(a[e]=a.renderer.text(r.text,0,0,r.useHTML).attr({align:r.align,"class":Xe+e,zIndex:r.zIndex||4}).css(r.style).add().align(r,!1,"spacingBox"))})},getChartSize:function(){var t=this,e=t.options.chart,n=t.renderToClone||t.renderTo;t.containerWidth=yn(n,"width"),t.containerHeight=yn(n,"height"),t.chartWidth=xe(0,e.width||t.containerWidth||600),t.chartHeight=xe(0,p(e.height,t.containerHeight>19?t.containerHeight:400))},cloneRenderTo:function(t){var e=this.renderToClone,n=this.container;t?e&&(this.renderTo.appendChild(n),E(e),delete this.renderToClone):(n&&this.renderTo.removeChild(n),this.renderToClone=e=this.renderTo.cloneNode(0),g(e,{position:qe,top:"-9999px",display:"block"}),pe.body.appendChild(e),n&&e.appendChild(n))},getContainer:function(){var e,n,a,s,o,l,c=this,u=c.options.chart,h="data-highcharts-chart";c.renderTo=s=u.renderTo,l=Xe+Ne++,r(s)&&(c.renderTo=s=pe.getElementById(s)),s||Y(13,!0),o=i(d(s,h)),!isNaN(o)&&He[o]&&He[o].destroy(),d(s,h,c.index),s.innerHTML="",s.offsetWidth||c.cloneRenderTo(),c.getChartSize(),n=c.chartWidth,a=c.chartHeight,c.container=e=m(je,{className:Xe+"container"+(u.className?" "+u.className:""),id:l},t({position:Ze,overflow:We,width:n+Je,height:a+Je,textAlign:"left",lineHeight:"normal",zIndex:0},u.style),c.renderToClone||s),c.renderer=u.forExport?new zn(e,n,a,!0):new X(e,n,a),Le&&c.renderer.create(c,e,n,a)
},getMargins:function(){var t,e,n=this,i=n.options.chart,r=i.spacingTop,a=i.spacingRight,s=i.spacingBottom,o=i.spacingLeft,l=n.legend,c=n.optionsMarginTop,u=n.optionsMarginLeft,d=n.optionsMarginRight,f=n.optionsMarginBottom,g=n.options.title,m=n.options.subtitle,v=n.options.legend,y=p(v.margin,10),b=v.x,x=v.y,w=v.align,T=v.verticalAlign;n.resetMargins(),t=n.axisOffset,!n.title&&!n.subtitle||h(n.optionsMarginTop)||(e=xe(n.title&&!g.floating&&!g.verticalAlign&&g.y||0,n.subtitle&&!m.floating&&!m.verticalAlign&&m.y||0),e&&(n.plotTop=xe(n.plotTop,e+p(g.margin,15)+r))),l.display&&!v.floating&&("right"===w?h(d)||(n.marginRight=xe(n.marginRight,l.legendWidth-b+y+a)):"left"===w?h(u)||(n.plotLeft=xe(n.plotLeft,l.legendWidth+b+y+o)):"top"===T?h(c)||(n.plotTop=xe(n.plotTop,l.legendHeight+x+y+r)):"bottom"===T&&(h(f)||(n.marginBottom=xe(n.marginBottom,l.legendHeight-x+y+s)))),n.extraBottomMargin&&(n.marginBottom+=n.extraBottomMargin),n.extraTopMargin&&(n.plotTop+=n.extraTopMargin),n.hasCartesianSeries&&wn(n.axes,function(t){t.getOffset()}),h(u)||(n.plotLeft+=t[3]),h(c)||(n.plotTop+=t[0]),h(f)||(n.marginBottom+=t[2]),h(d)||(n.marginRight+=t[1]),n.setChartSize()},initReflow:function(){function t(t){var a=i.width||yn(r,"width"),s=i.height||yn(r,"height"),o=t?t.target:ge;n.hasUserSize||!a||!s||o!==ge&&o!==pe||((a!==n.containerWidth||s!==n.containerHeight)&&(clearTimeout(e),n.reflowTimeout=e=setTimeout(function(){n.container&&(n.setSize(a,s,!1),n.hasUserSize=null)},100)),n.containerWidth=a,n.containerHeight=s)}var e,n=this,i=n.options.chart,r=n.renderTo;An(ge,"resize",t),An(n,"destroy",function(){Cn(ge,"resize",t)})},setSize:function(t,e,n){var i,r,a,s=this;s.isResizing+=1,a=function(){s&&Mn(s,"endResize",null,function(){s.isResizing-=1})},z(n,s),s.oldChartHeight=s.chartHeight,s.oldChartWidth=s.chartWidth,h(t)&&(s.chartWidth=i=xe(0,ve(t)),s.hasUserSize=!!i),h(e)&&(s.chartHeight=r=xe(0,ve(e))),g(s.container,{width:i+Je,height:r+Je}),s.setChartSize(!0),s.renderer.setSize(i,r,n),s.maxTicks=null,wn(s.axes,function(t){t.isDirty=!0,t.setScale()}),wn(s.series,function(t){t.isDirty=!0}),s.isDirtyLegend=!0,s.isDirtyBox=!0,s.getMargins(),s.redraw(n),s.oldChartHeight=null,Mn(s,"resize"),Q===!1?a():setTimeout(a,Q&&Q.duration||500)},setChartSize:function(t){var e,n,i,r,a,s,o,l=this,c=l.inverted,u=l.renderer,h=l.chartWidth,d=l.chartHeight,f=l.options.chart,p=f.spacingTop,g=f.spacingRight,m=f.spacingBottom,v=f.spacingLeft,y=l.clipOffset;l.plotLeft=i=ve(l.plotLeft),l.plotTop=r=ve(l.plotTop),l.plotWidth=a=xe(0,ve(h-i-l.marginRight)),l.plotHeight=s=xe(0,ve(d-r-l.marginBottom)),l.plotSizeX=c?s:a,l.plotSizeY=c?a:s,l.plotBorderWidth=o=f.plotBorderWidth||0,l.spacingBox=u.spacingBox={x:v,y:p,width:h-v-g,height:d-p-m},l.plotBox=u.plotBox={x:i,y:r,width:a,height:s},e=be(xe(o,y[3])/2),n=be(xe(o,y[0])/2),l.clipBox={x:e,y:n,width:ye(l.plotSizeX-xe(o,y[1])/2-e),height:ye(l.plotSizeY-xe(o,y[2])/2-n)},t||wn(l.axes,function(t){t.setAxisSize(),t.setAxisTranslation()})},resetMargins:function(){var t=this,e=t.options.chart,n=e.spacingTop,i=e.spacingRight,r=e.spacingBottom,a=e.spacingLeft;t.plotTop=p(t.optionsMarginTop,n),t.marginRight=p(t.optionsMarginRight,i),t.marginBottom=p(t.optionsMarginBottom,r),t.plotLeft=p(t.optionsMarginLeft,a),t.axisOffset=[0,0,0,0],t.clipOffset=[0,0,0,0]},drawChartBox:function(){var t,e,n=this,i=n.options.chart,r=n.renderer,a=n.chartWidth,s=n.chartHeight,o=n.chartBackground,l=n.plotBackground,c=n.plotBorder,u=n.plotBGImage,h=i.borderWidth||0,d=i.backgroundColor,f=i.plotBackgroundColor,p=i.plotBackgroundImage,g=i.plotBorderWidth||0,m=n.plotLeft,v=n.plotTop,y=n.plotWidth,b=n.plotHeight,x=n.plotBox,w=n.clipRect,T=n.clipBox;t=h+(i.shadow?8:0),(h||d)&&(o?o.animate(o.crisp(null,null,null,a-t,s-t)):(e={fill:d||Ke},h&&(e.stroke=i.borderColor,e["stroke-width"]=h),n.chartBackground=r.rect(t/2,t/2,a-t,s-t,i.borderRadius,h).attr(e).add().shadow(i.shadow))),f&&(l?l.animate(x):n.plotBackground=r.rect(m,v,y,b,0).attr({fill:f}).add().shadow(i.plotShadow)),p&&(u?u.animate(x):n.plotBGImage=r.image(p,m,v,y,b).add()),w?w.animate({width:T.width,height:T.height}):n.clipRect=r.clipRect(T),g&&(c?c.animate(c.crisp(null,m,v,y,b)):n.plotBorder=r.rect(m,v,y,b,0,g).attr({stroke:i.plotBorderColor,"stroke-width":g,zIndex:1}).add()),n.isDirtyBox=!1},propFromSeries:function(){var t,e,n,i=this,r=i.options.chart,a=i.options.series;wn(["inverted","angular","polar"],function(s){for(t=gn[r.type||r.defaultSeriesType],n=i[s]||r[s]||t&&t.prototype[s],e=a&&a.length;!n&&e--;)t=gn[a[e].type],t&&t.prototype[s]&&(n=!0);i[s]=n})},render:function(){var e,n=this,r=n.axes,a=n.renderer,s=n.options,o=s.labels,l=s.credits;n.setTitle(),n.legend=new q(n,s.legend),wn(r,function(t){t.setScale()}),n.getMargins(),n.maxTicks=null,wn(r,function(t){t.setTickPositions(!0),t.setMaxTicks()}),n.adjustTickAmounts(),n.getMargins(),n.drawChartBox(),n.hasCartesianSeries&&wn(r,function(t){t.render()}),n.seriesGroup||(n.seriesGroup=a.g("series-group").attr({zIndex:3}).add()),wn(n.series,function(t){t.translate(),t.setTooltipPoints(),t.render()}),o.items&&wn(o.items,function(e){var r=t(o.style,e.style),s=i(r.left)+n.plotLeft,l=i(r.top)+n.plotTop+12;delete r.left,delete r.top,a.text(e.html,s,l).attr({zIndex:2}).css(r).add()}),l.enabled&&!n.credits&&(e=l.href,n.credits=a.text(l.text,0,0).on("click",function(){e&&(location.href=e)}).attr({align:l.position.align,zIndex:8}).css(l.style).add().align(l.position)),n.hasRendered=!0},destroy:function(){var t,e=this,n=e.axes,i=e.series,r=e.container,a=r&&r.parentNode;for(Mn(e,"destroy"),He[e.index]=W,e.renderTo.removeAttribute("data-highcharts-chart"),Cn(e),t=n.length;t--;)n[t]=n[t].destroy();for(t=i.length;t--;)i[t]=i[t].destroy();wn(["title","subtitle","chartBackground","plotBackground","plotBGImage","plotBorder","seriesGroup","clipRect","credits","pointer","scroller","rangeSelector","legend","resetZoomButton","tooltip","renderer"],function(t){var n=e[t];n&&n.destroy&&(e[t]=n.destroy())}),r&&(r.innerHTML="",Cn(r),a&&E(r));for(t in e)delete e[t]},isReadyToRender:function(){var t=this;return!ze&&ge==ge.top&&"complete"!==pe.readyState||Le&&!ge.canvg?(Le?Nn.push(function(){t.firstRender()},t.options.global.canvasToolsURL):pe.attachEvent("onreadystatechange",function(){pe.detachEvent("onreadystatechange",t.firstRender),"complete"===pe.readyState&&t.firstRender()}),!1):!0},firstRender:function(){var t=this,e=t.options,n=t.callback;t.isReadyToRender()&&(t.getContainer(),Mn(t,"init"),t.resetMargins(),t.setChartSize(),t.propFromSeries(),t.getAxes(),wn(e.series||[],function(e){t.initSeries(e)}),Mn(t,"beforeRender"),t.pointer=new j(t,e),t.render(),t.renderer.draw(),n&&n.apply(t,[t]),wn(t.callbacks,function(e){e.apply(t,[t])}),t.cloneRenderTo(!0),Mn(t,"load"))}},Z.prototype.callbacks=[];var Rn=function(){};Rn.prototype={init:function(t,e,n){var i,r=this;return r.series=t,r.applyOptions(e,n),r.pointAttr={},t.options.colorByPoint&&(i=t.options.colors||t.chart.options.colors,r.color=r.color||i[t.colorCounter++],t.colorCounter===i.length&&(t.colorCounter=0)),t.chart.pointCount++,r},applyOptions:function(e,n){var i=this,r=i.series,a=r.pointValKey;return e=Rn.prototype.optionsToObject.call(this,e),t(i,e),i.options=i.options?t(i.options,e):e,a&&(i.y=i[a]),i.x===W&&r&&(i.x=n===W?r.autoIncrement():n),i},optionsToObject:function(t){var e,n,i=this.series,r=i.pointArrayMap||["y"],a=r.length,o=0,l=0;if("number"==typeof t||null===t)e={y:t};else if(s(t))for(e={},t.length>a&&(n=typeof t[0],"string"===n?e.name=t[0]:"number"===n&&(e.x=t[0]),o++);a>l;)e[r[l++]]=t[o++];else"object"==typeof t&&(e=t,t.dataLabels&&(i._hasPointLabels=!0),t.marker&&(i._hasPointMarkers=!0));return e},destroy:function(){var t,e=this,n=e.series,i=n.chart,r=i.hoverPoints;i.pointCount--,r&&(e.setState(),u(r,e),r.length||(i.hoverPoints=null)),e===i.hoverPoint&&e.onMouseOut(),(e.graphic||e.dataLabel)&&(Cn(e),e.destroyElements()),e.legendItem&&i.legend.destroyItem(e);for(t in e)e[t]=null},destroyElements:function(){for(var t,e=this,n=["graphic","dataLabel","dataLabelUpper","group","connector","shadowGroup"],i=6;i--;)t=n[i],e[t]&&(e[t]=e[t].destroy())},getLabelConfig:function(){var t=this;return{x:t.category,y:t.y,key:t.name||t.category,series:t.series,point:t,percentage:t.percentage,total:t.total||t.stackTotal}},select:function(t,e){var n=this,i=n.series,r=i.chart;t=p(t,!n.selected),n.firePointEvent(t?"select":"unselect",{accumulate:e},function(){n.selected=n.options.selected=t,i.options.data[xn(n,i.data)]=n.options,n.setState(t&&an),e||wn(r.getSelectedPoints(),function(t){t.selected&&t!==n&&(t.selected=t.options.selected=!1,i.options.data[xn(t,i.data)]=t.options,t.setState(nn),t.firePointEvent("unselect"))})})},onMouseOver:function(t){var e=this,n=e.series,i=n.chart,r=i.tooltip,a=i.hoverPoint;a&&a!==e&&a.onMouseOut(),e.firePointEvent("mouseOver"),!r||r.shared&&!n.noSharedTooltip||r.refresh(e,t),e.setState(rn),i.hoverPoint=e},onMouseOut:function(){var t=this.series.chart,e=t.hoverPoints;e&&-1!==xn(this,e)||(this.firePointEvent("mouseOut"),this.setState(),t.hoverPoint=null)},tooltipFormatter:function(t){var e=this.series,n=e.tooltipOptions,i=n.valueDecimals,r=n.valuePrefix||"",a=n.valueSuffix||"";return wn(e.pointArrayMap||["y"],function(e){e="{point."+e,(r||a)&&(t=t.replace(e+"}",r+e+"}"+a)),o(i)&&(t=t.replace(e+"}",e+":,."+i+"f}"))}),S(t,{point:this,series:this.series})},update:function(t,e,n){var i,r=this,s=r.series,o=r.graphic,l=s.data,c=s.chart;e=p(e,!0),r.firePointEvent("update",{options:t},function(){r.applyOptions(t),a(t)&&(s.getAttribs(),o&&o.attr(r.pointAttr[s.state])),i=xn(r,l),s.xData[i]=r.x,s.yData[i]=s.toYData?s.toYData(r):r.y,s.zData[i]=r.z,s.options.data[i]=r.options,s.isDirty=!0,s.isDirtyData=!0,e&&c.redraw(n)})},remove:function(t,e){var n,i=this,r=i.series,a=r.chart,s=r.data;z(e,a),t=p(t,!0),i.firePointEvent("remove",null,function(){n=xn(i,s),s.splice(n,1),r.options.data.splice(n,1),r.xData.splice(n,1),r.yData.splice(n,1),r.zData.splice(n,1),i.destroy(),r.isDirty=!0,r.isDirtyData=!0,t&&a.redraw()})},firePointEvent:function(t,e,n){var i=this,r=this.series,a=r.options;(a.point.events[t]||i.options&&i.options.events&&i.options.events[t])&&this.importEvents(),"click"===t&&a.allowPointSelect&&(n=function(t){i.select(null,t.ctrlKey||t.metaKey||t.shiftKey)}),Mn(this,t,e,n)},importEvents:function(){if(!this.hasImportedEvents){var t,n=this,i=e(n.series.options.point,n.options),r=i.events;n.events=r;for(t in r)An(n,t,r[t]);this.hasImportedEvents=!0}},setState:function(t){var n,i,r=this,a=r.plotX,s=r.plotY,o=r.series,l=o.options.states,c=En[o.type].marker&&o.options.marker,u=c&&!c.enabled,h=c&&c.states[t],d=h&&h.enabled===!1,f=o.stateMarkerGraphic,p=r.marker||{},g=o.chart,m=r.pointAttr;t=t||nn,t===r.state||r.selected&&t!==an||l[t]&&l[t].enabled===!1||t&&(d||u&&!h.enabled)||(r.graphic?(n=c&&r.graphic.symbolName&&m[t].r,r.graphic.attr(e(m[t],n?{x:a-n,y:s-n,width:2*n,height:2*n}:{}))):(t&&h&&(n=h.radius,i=p.symbol||o.symbol,f&&f.currentSymbol!==i&&(f=f.destroy()),f?f.attr({x:a-n,y:s-n}):(o.stateMarkerGraphic=f=g.renderer.symbol(i,a-n,s-n,2*n,2*n).attr(m[t]).add(o.markerGroup),f.currentSymbol=i)),f&&f[t&&g.isInsidePlot(a,s)?"show":"hide"]()),r.state=t)}};var Hn=function(){};Hn.prototype={isCartesian:!0,type:"line",pointClass:Rn,sorted:!0,requireSorting:!0,pointAttrToOptions:{stroke:"lineColor","stroke-width":"lineWidth",fill:"fillColor",r:"radius"},colorCounter:0,init:function(e,n){var i,a,s,o=this,l=e.series;o.chart=e,o.options=n=o.setOptions(n),o.bindAxes(),t(o,{name:n.name,state:nn,pointAttr:{},visible:n.visible!==!1,selected:n.selected===!0}),Le&&(n.animation=!1),a=n.events;for(i in a)An(o,i,a[i]);(a&&a.click||n.point&&n.point.events&&n.point.events.click||n.allowPointSelect)&&(e.runTrackerClick=!0),o.getColor(),o.getSymbol(),o.setData(n.data,!1),o.isCartesian&&(e.hasCartesianSeries=!0),l.push(o),o._i=l.length-1,k(l,function(t,e){return p(t.options.index,t._i)-p(e.options.index,t._i)}),wn(l,function(t,e){t.index=e,t.name=t.name||"Series "+(e+1)}),s=n.linkedTo,o.linkedSeries=[],r(s)&&(s=":previous"===s?l[o.index-1]:e.get(s),s&&(s.linkedSeries.push(o),o.linkedParent=s))},bindAxes:function(){var t,e=this,n=e.options,i=e.chart;e.isCartesian&&wn(["xAxis","yAxis"],function(r){wn(i[r],function(i){t=i.options,(n[r]===t.index||n[r]!==W&&n[r]===t.id||n[r]===W&&0===t.index)&&(i.series.push(e),e[r]=i,i.isDirty=!0)}),e[r]||Y(17,!0)})},autoIncrement:function(){var t=this,e=t.options,n=t.xIncrement;return n=p(n,e.pointStart,0),t.pointInterval=p(t.pointInterval,e.pointInterval,1),t.xIncrement=n+t.pointInterval,n},getSegments:function(){var t,e=this,n=-1,i=[],r=e.points,a=r.length;if(a)if(e.options.connectNulls){for(t=a;t--;)null===r[t].y&&r.splice(t,1);r.length&&(i=[r])}else wn(r,function(t,e){null===t.y?(e>n+1&&i.push(r.slice(n+1,e)),n=e):e===a-1&&i.push(r.slice(n+1,e+1))});e.segments=i},setOptions:function(t){var n,i=this.chart,r=i.options,a=r.plotOptions,s=a[this.type];return this.userOptions=t,n=e(s,a.series,t),this.tooltipOptions=e(r.tooltip,n.tooltip),null===s.marker&&delete n.marker,n},getColor:function(){var t,e,n=this.options,i=this.userOptions,r=this.chart.options.colors,a=this.chart.counters;t=n.color||En[this.type].color,t||n.colorByPoint||(h(i._colorIndex)?e=i._colorIndex:(i._colorIndex=a.color,e=a.color++),t=r[e]),this.color=t,a.wrapColor(r.length)},getSymbol:function(){var t,e=this,n=e.userOptions,i=e.options.marker,r=e.chart,a=r.options.symbols,s=r.counters;e.symbol=i.symbol,e.symbol||(h(n._symbolIndex)?t=n._symbolIndex:(n._symbolIndex=s.symbol,t=s.symbol++),e.symbol=a[t]),/^url/.test(e.symbol)&&(i.radius=0),s.wrapSymbol(a.length)},drawLegendSymbol:function(t){var e,n,i,r=this.options,a=r.marker,s=t.options,o=s.symbolWidth,l=this.chart.renderer,c=this.legendGroup,u=t.baseline;r.lineWidth&&(i={"stroke-width":r.lineWidth},r.dashStyle&&(i.dashstyle=r.dashStyle),this.legendLine=l.path([Qe,0,u-4,tn,o,u-4]).attr(i).add(c)),a&&a.enabled&&(e=a.radius,this.legendSymbol=n=l.symbol(this.symbol,o/2-e,u-4-e,2*e,2*e).add(c))},addPoint:function(t,e,n,i){var r,a=this,s=a.options,o=a.data,l=a.graph,c=a.area,u=a.chart,h=a.xData,d=a.yData,f=a.zData,g=a.names,m=l&&l.shift||0,v=s.data;z(i,u),l&&n&&(l.shift=m+1),c&&(n&&(c.shift=m+1),c.isArea=!0),e=p(e,!0),r={series:a},a.pointClass.prototype.applyOptions.apply(r,[t]),h.push(r.x),d.push(a.toYData?a.toYData(r):r.y),f.push(r.z),g&&(g[r.x]=r.name),v.push(t),"point"===s.legendType&&a.generatePoints(),n&&(o[0]&&o[0].remove?o[0].remove(!1):(o.shift(),h.shift(),d.shift(),f.shift(),v.shift())),a.getAttribs(),a.isDirty=!0,a.isDirtyData=!0,e&&u.redraw()},setData:function(t,e){var n,i=this,a=i.points,l=i.options,c=i.chart,u=null,h=i.xAxis,d=h&&h.categories&&!h.categories.length?[]:null;i.xIncrement=null,i.pointRange=h&&h.categories?1:l.pointRange,i.colorCounter=0;var f,g=[],m=[],v=[],y=t?t.length:[],b=l.turboThreshold||1e3,x=i.pointArrayMap,w=x&&x.length,T=!!i.toYData;if(y>b){for(n=0;null===u&&y>n;)u=t[n],n++;if(o(u)){var S=p(l.pointStart,0),_=p(l.pointInterval,1);for(n=0;y>n;n++)g[n]=S,m[n]=t[n],S+=_;i.xIncrement=S}else if(s(u))if(w)for(n=0;y>n;n++)f=t[n],g[n]=f[0],m[n]=f.slice(1,w+1);else for(n=0;y>n;n++)f=t[n],g[n]=f[0],m[n]=f[1]}else for(n=0;y>n;n++)t[n]!==W&&(f={series:i},i.pointClass.prototype.applyOptions.apply(f,[t[n]]),g[n]=f.x,m[n]=T?i.toYData(f):f.y,v[n]=f.z,d&&f.name&&(d[n]=f.name));for(i.requireSorting&&g.length>1&&g[1]<g[0]&&Y(15),r(m[0])&&Y(14,!0),i.data=[],i.options.data=t,i.xData=g,i.yData=m,i.zData=v,i.names=d,n=a&&a.length||0;n--;)a[n]&&a[n].destroy&&a[n].destroy();h&&(h.minRange=h.userMinRange),i.isDirty=i.isDirtyData=c.isDirtyBox=!0,p(e,!0)&&c.redraw(!1)},remove:function(t,e){var n=this,i=n.chart;t=p(t,!0),n.isRemoving||(n.isRemoving=!0,Mn(n,"remove",null,function(){n.destroy(),i.isDirtyLegend=i.isDirtyBox=!0,t&&i.redraw(e)})),n.isRemoving=!1},processData:function(t){var e,n,i,r,a=this,s=a.xData,o=a.yData,l=s.length,c=0,u=l,h=a.xAxis,d=a.options,f=d.cropThreshold,p=a.isCartesian;if(p&&!a.isDirty&&!h.isDirty&&!a.yAxis.isDirty&&!t)return!1;if(p&&a.sorted&&(!f||l>f||a.forceCrop)){var g=h.getExtremes(),m=g.min,v=g.max;if(m>s[l-1]||s[0]>v)s=[],o=[];else if(m>s[0]||s[l-1]>v){for(r=0;l>r;r++)if(s[r]>=m){c=xe(0,r-1);break}for(;l>r;r++)if(s[r]>v){u=r+1;break}s=s.slice(c,u),o=o.slice(c,u),e=!0}}for(r=s.length-1;r>0;r--)n=s[r]-s[r-1],n>0&&(i===W||i>n)&&(i=n);a.cropped=e,a.cropStart=c,a.processedXData=s,a.processedYData=o,null===d.pointRange&&(a.pointRange=i||1),a.closestPointRange=i},generatePoints:function(){var t,e,n,i,r=this,a=r.options,s=a.data,o=r.data,l=r.processedXData,c=r.processedYData,u=r.pointClass,h=l.length,d=r.cropStart||0,p=r.hasGroupedData,g=[];if(!o&&!p){var m=[];m.length=s.length,o=r.data=m}for(i=0;h>i;i++)e=d+i,p?g[i]=(new u).init(r,[l[i]].concat(f(c[i]))):(o[e]?n=o[e]:s[e]!==W&&(o[e]=n=(new u).init(r,s[e],l[i])),g[i]=n);if(o&&(h!==(t=o.length)||p))for(i=0;t>i;i++)i!==d||p||(i+=h),o[i]&&(o[i].destroyElements(),o[i].plotX=W);r.data=o,r.points=g},translate:function(){this.processedXData||this.processData(),this.generatePoints();for(var t,e=this,n=e.options,i=n.stacking,r=e.xAxis,a=r.categories,s=e.yAxis,o=e.points,l=o.length,c=!!e.modifyValue,u=s.series,d=u.length,f="between"===n.pointPlacement,g=n.threshold;d--;)if(u[d].visible){u[d]===e&&(t=!0);break}for(d=0;l>d;d++){var m,v,y=o[d],b=y.x,x=y.y,w=y.low,T=s.stacks[(g>x?"-":"")+e.stackKey];s.isLog&&0>=x&&(y.y=x=null),y.plotX=r.translate(b,0,0,0,1,f),i&&e.visible&&T&&T[b]&&(m=T[b],v=m.total,m.cum=w=m.cum-x,x=w+x,t&&(w=p(g,s.min)),s.isLog&&0>=w&&(w=null),"percent"===i&&(w=v?100*w/v:0,x=v?100*x/v:0),y.percentage=v?100*y.y/v:0,y.total=y.stackTotal=v,y.stackY=x),y.yBottom=h(w)?s.translate(w,0,1,0,1):null,c&&(x=e.modifyValue(x,y)),y.plotY="number"==typeof x&&1/0!==x?ve(10*s.translate(x,0,1,0,1))/10:W,y.clientX=f?r.translate(b,0,0,0,1):y.plotX,y.negative=(g||0)>y.y,y.category=a&&a[y.x]!==W?a[y.x]:y.x}e.getSegments()},setTooltipPoints:function(t){var e,n,i,r,a,s=this,o=[],l=s.xAxis,c=l?l.tooltipLen||l.len:s.chart.plotSizeX,u=[];if(s.options.enableMouseTracking!==!1){for(t&&(s.tooltipPoints=null),wn(s.segments||s.points,function(t){o=o.concat(t)}),l&&l.reversed&&(o=o.reverse()),e=o.length,a=0;e>a;a++)for(r=o[a],n=o[a-1]?i+1:0,i=o[a+1]?xe(0,ye((r.clientX+(o[a+1]?o[a+1].clientX:c))/2)):c;n>=0&&i>=n;)u[n++]=r;s.tooltipPoints=u}},tooltipHeaderFormatter:function(t){var e,n=this,i=n.tooltipOptions,r=i.xDateFormat,a=n.xAxis,s=a&&"datetime"===a.options.type,l=i.headerFormat;if(s&&!r)for(e in ee)if(ee[e]>=a.closestPointRange){r=i.dateTimeLabelFormats[e];break}return s&&r&&o(t.key)&&(l=l.replace("{point.key}","{point.key:"+r+"}")),S(l,{point:t,series:n})},onMouseOver:function(){var t=this,e=t.chart,n=e.hoverSeries;n&&n!==t&&n.onMouseOut(),t.options.events.mouseOver&&Mn(t,"mouseOver"),t.setState(rn),e.hoverSeries=t},onMouseOut:function(){var t=this,e=t.options,n=t.chart,i=n.tooltip,r=n.hoverPoint;r&&r.onMouseOut(),t&&e.events.mouseOut&&Mn(t,"mouseOut"),!i||e.stickyTracking||i.shared&&!t.noSharedTooltip||i.hide(),t.setState(),n.hoverSeries=null},animate:function(e){var n,i,r,s=this,o=s.chart,l=o.renderer,c=s.options.animation,u=o.clipBox,h=o.inverted;c&&!a(c)&&(c=En[s.type].animation),r="_sharedClip"+c.duration+c.easing,e?(n=o[r],i=o[r+"m"],n||(o[r]=n=l.clipRect(t(u,{width:0})),o[r+"m"]=i=l.clipRect(-99,h?-o.plotLeft:-o.plotTop,99,h?o.chartWidth:o.chartHeight)),s.group.clip(n),s.markerGroup.clip(i),s.sharedClipKey=r):(n=o[r],n&&(n.animate({width:o.plotSizeX},c),o[r+"m"].animate({width:o.plotSizeX+99},c)),s.animate=null,s.animationTimeout=setTimeout(function(){s.afterAnimate()},c.duration))},afterAnimate:function(){var t=this.chart,e=this.sharedClipKey,n=this.group;n&&this.options.clip!==!1&&(n.clip(t.clipRect),this.markerGroup.clip()),setTimeout(function(){e&&t[e]&&(t[e]=t[e].destroy(),t[e+"m"]=t[e+"m"].destroy())},100)},drawPoints:function(){var e,n,i,r,a,s,o,l,c,u,h,d,f=this,g=f.points,m=f.chart,v=f.options,y=v.marker,b=f.markerGroup;if(y.enabled||f._hasPointMarkers)for(r=g.length;r--;)a=g[r],n=a.plotX,i=a.plotY,c=a.graphic,u=a.marker||{},h=y.enabled&&u.enabled===W||u.enabled,d=m.isInsidePlot(n,i,m.inverted),h&&i!==W&&!isNaN(i)&&null!==a.y?(e=a.pointAttr[a.selected?an:nn],s=e.r,o=p(u.symbol,f.symbol),l=0===o.indexOf("url"),c?c.attr({visibility:d?ze?"inherit":Ge:We}).animate(t({x:n-s,y:i-s},c.symbolName?{width:2*s,height:2*s}:{})):d&&(s>0||l)&&(a.graphic=c=m.renderer.symbol(o,n-s,i-s,2*s,2*s).attr(e).add(b))):c&&(a.graphic=c.destroy())},convertAttribs:function(t,e,n,i){var r,a,s=this.pointAttrToOptions,o={};t=t||{},e=e||{},n=n||{},i=i||{};for(r in s)a=s[r],o[r]=p(t[a],e[r],n[r],i[r]);return o},getAttribs:function(){var e,n,i,r,a,s,o=this,l=o.options,c=En[o.type].marker?l.marker:l,u=c.states,d=u[rn],f=o.color,p={stroke:f,fill:f},g=o.points||[],m=[],v=o.pointAttrToOptions,y=l.negativeColor;for(l.marker?(d.radius=d.radius||c.radius+2,d.lineWidth=d.lineWidth||c.lineWidth+1):d.color=d.color||Un(d.color||f).brighten(d.brightness).get(),m[nn]=o.convertAttribs(c,p),wn([rn,an],function(t){m[t]=o.convertAttribs(u[t],m[nn])}),o.pointAttr=m,n=g.length;n--;){if(i=g[n],c=i.options&&i.options.marker||i.options,c&&c.enabled===!1&&(c.radius=0),i.negative&&(i.color=i.fillColor=y),a=l.colorByPoint||i.color,i.options)for(s in v)h(c[v[s]])&&(a=!0);a?(c=c||{},r=[],u=c.states||{},e=u[rn]=u[rn]||{},l.marker||(e.color=Un(e.color||i.color).brighten(e.brightness||d.brightness).get()),r[nn]=o.convertAttribs(t({color:i.color},c),m[nn]),r[rn]=o.convertAttribs(u[rn],m[rn],r[nn]),r[an]=o.convertAttribs(u[an],m[an],r[nn]),i.negative&&l.marker&&(r[nn].fill=r[rn].fill=r[an].fill=o.convertAttribs({fillColor:y}).fill)):r=m,i.pointAttr=r}},update:function(n,i){var r=this.chart,a=this.userOptions,s=this.type;n=e(a,{animation:!1,index:this.index,pointStart:this.xData[0]},n),this.remove(!1),t(this,gn[n.type||s].prototype),this.init(r,n),p(i,!0)&&r.redraw(!1)},destroy:function(){var t,e,n,i,r,a=this,s=a.chart,o=/AppleWebKit\/533/.test(Me),l=a.data||[];for(Mn(a,"destroy"),Cn(a),wn(["xAxis","yAxis"],function(t){r=a[t],r&&(u(r.series,a),r.isDirty=r.forceRedraw=!0)}),a.legendItem&&a.chart.legend.destroyItem(a),e=l.length;e--;)n=l[e],n&&n.destroy&&n.destroy();a.points=null,clearTimeout(a.animationTimeout),wn(["area","graph","dataLabelsGroup","group","markerGroup","tracker","graphNeg","areaNeg","posClip","negClip"],function(e){a[e]&&(t=o&&"group"===e?"hide":"destroy",a[e][t]())}),s.hoverSeries===a&&(s.hoverSeries=null),u(s.series,a);for(i in a)delete a[i]},drawDataLabels:function(){var t,n,i,r,a=this,s=a.options,o=s.dataLabels,l=a.points;(o.enabled||a._hasPointLabels)&&(a.dlProcessOptions&&a.dlProcessOptions(o),r=a.plotGroup("dataLabelsGroup","data-labels",a.visible?Ge:We,o.zIndex||6),n=o,wn(l,function(s){var l,c,u,d,f,g=s.dataLabel,m=s.connector,v=!0;if(t=s.options&&s.options.dataLabels,l=n.enabled||t&&t.enabled,g&&!l)s.dataLabel=g.destroy();else if(l){if(f=o.rotation,o=e(n,t),c=s.getLabelConfig(),i=o.format?S(o.format,c):o.formatter.call(c,o),o.style.color=p(o.color,o.style.color,a.color,"black"),g)h(i)?(g.attr({text:i}),v=!1):(s.dataLabel=g=g.destroy(),m&&(s.connector=m.destroy()));else if(h(i)){u={fill:o.backgroundColor,stroke:o.borderColor,"stroke-width":o.borderWidth,r:o.borderRadius||0,rotation:f,padding:o.padding,zIndex:1};for(d in u)u[d]===W&&delete u[d];g=s.dataLabel=a.chart.renderer[f?"text":"label"](i,0,-999,null,null,null,o.useHTML).attr(u).css(o.style).add(r).shadow(o.shadow)}g&&a.alignDataLabel(s,g,o,null,v)}}))},alignDataLabel:function(e,n,i,r,a){var s,o=this.chart,l=o.inverted,c=p(e.plotX,-999),u=p(e.plotY,-999),h=n.getBBox();r=t({x:l?o.plotWidth-u:c,y:ve(l?o.plotHeight-c:u),width:0,height:0},r),t(i,{width:h.width,height:h.height}),i.rotation?(s={align:i.align,x:r.x+i.x+r.width/2,y:r.y+i.y+r.height/2},n[a?"attr":"animate"](s)):(n.align(i,null,r),s=n.alignAttr),n.attr({visibility:i.crop===!1||o.isInsidePlot(c,u,l)?o.renderer.isSVG?"inherit":Ge:We})},getSegmentPath:function(t){var e=this,n=[],i=e.options.step;return wn(t,function(r,a){var s,o=r.plotX,l=r.plotY;e.getPointSpline?n.push.apply(n,e.getPointSpline(t,r,a)):(n.push(a?tn:Qe),i&&a&&(s=t[a-1],"right"===i?n.push(s.plotX,l):"center"===i?n.push((s.plotX+o)/2,s.plotY,(s.plotX+o)/2,l):n.push(o,s.plotY)),n.push(r.plotX,r.plotY))}),n},getGraphPath:function(){var t,e=this,n=[],i=[];return wn(e.segments,function(r){t=e.getSegmentPath(r),r.length>1?n=n.concat(t):i.push(r[0])}),e.singlePoints=i,e.graphPath=n,n},drawGraph:function(){var t=this,e=this.options,n=[["graph",e.lineColor||this.color]],i=e.lineWidth,r=e.dashStyle,a=this.getGraphPath(),s=e.negativeColor;s&&n.push(["graphNeg",s]),wn(n,function(n,s){var o,l=n[0],c=t[l];c?(Dn(c),c.animate({d:a})):i&&a.length&&(o={stroke:n[1],"stroke-width":i,zIndex:1},r&&(o.dashstyle=r),t[l]=t.chart.renderer.path(a).attr(o).add(t.group).shadow(!s&&e.shadow))})},clipNeg:function(){var t,e,n,i,r,a=this.options,s=this.chart,o=s.renderer,l=a.negativeColor,c=this.posClip,u=this.negClip,h=s.chartWidth,d=s.chartHeight,f=xe(h,d);l&&this.graph&&(t=be(this.yAxis.len-this.yAxis.translate(a.threshold||0)),i={x:0,y:0,width:f,height:t},r={x:0,y:t,width:f,height:f-t},s.inverted&&o.isVML&&(i={x:s.plotWidth-t-s.plotLeft,y:0,width:h,height:d},r={x:t+s.plotLeft-h,y:0,width:s.plotLeft+t,height:h}),this.yAxis.reversed?(e=r,n=i):(e=i,n=r),c?(c.animate(e),u.animate(n)):(this.posClip=c=o.clipRect(e),this.graph.clip(c),this.negClip=u=o.clipRect(n),this.graphNeg.clip(u),this.area&&(this.area.clip(c),this.areaNeg.clip(u))))},invertGroups:function(){function t(){var t={width:e.yAxis.len,height:e.xAxis.len};wn(["group","markerGroup"],function(n){e[n]&&e[n].attr(t).invert()})}var e=this,n=e.chart;An(n,"resize",t),An(e,"destroy",function(){Cn(n,"resize",t)}),t(),e.invertGroups=t},plotGroup:function(t,e,n,i,r){var a=this[t],s=!a,o=this.chart,l=this.xAxis,c=this.yAxis;return s&&(this[t]=a=o.renderer.g(e).attr({visibility:n,zIndex:i||.1}).add(r)),a[s?"attr":"animate"]({translateX:l?l.left:o.plotLeft,translateY:c?c.top:o.plotTop}),a},render:function(){var t,e=this,n=e.chart,i=e.options,r=i.animation,a=r&&!!e.animate&&n.renderer.isSVG,s=e.visible?Ge:We,o=i.zIndex,l=e.hasRendered,c=n.seriesGroup;t=e.plotGroup("group","series",s,o,c),e.markerGroup=e.plotGroup("markerGroup","markers",s,o,c),a&&e.animate(!0),e.getAttribs(),t.inverted=n.inverted,e.drawGraph&&(e.drawGraph(),e.clipNeg()),e.drawDataLabels(),e.drawPoints(),e.options.enableMouseTracking!==!1&&e.drawTracker(),n.inverted&&e.invertGroups(),i.clip===!1||e.sharedClipKey||l||t.clip(n.clipRect),a?e.animate():l||e.afterAnimate(),e.isDirty=e.isDirtyData=!1,e.hasRendered=!0},redraw:function(){var t=this,e=t.chart,n=t.isDirtyData,i=t.group,r=t.xAxis,a=t.yAxis;i&&(e.inverted&&i.attr({width:e.plotWidth,height:e.plotHeight}),i.animate({translateX:p(r&&r.left,e.plotLeft),translateY:p(a&&a.top,e.plotTop)})),t.translate(),t.setTooltipPoints(!0),t.render(),n&&Mn(t,"updatedData")},setState:function(t){var e,n=this,i=n.options,r=n.graph,a=n.graphNeg,s=i.states,o=i.lineWidth;if(t=t||nn,n.state!==t){if(n.state=t,s[t]&&s[t].enabled===!1)return;t&&(o=s[t].lineWidth||o+1),r&&!r.dashstyle&&(e={"stroke-width":o},r.attr(e),a&&a.attr(e))}},setVisible:function(t,e){var n,i=this,r=i.chart,a=i.legendItem,s=r.options.chart.ignoreHiddenSeries,o=i.visible;i.visible=t=i.userOptions.visible=t===W?!o:t,n=t?"show":"hide",wn(["group","dataLabelsGroup","markerGroup","tracker"],function(t){i[t]&&i[t][n]()}),r.hoverSeries===i&&i.onMouseOut(),a&&r.legend.colorizeItem(i,t),i.isDirty=!0,i.options.stacking&&wn(r.series,function(t){t.options.stacking&&t.visible&&(t.isDirty=!0)}),wn(i.linkedSeries,function(e){e.setVisible(t,!1)}),s&&(r.isDirtyBox=!0),e!==!1&&r.redraw(),Mn(i,n)},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},select:function(t){var e=this;e.selected=t=t===W?!e.selected:t,e.checkbox&&(e.checkbox.checked=t),Mn(e,t?"select":"unselect")},drawTracker:function(){var t,e,n=this,i=n.options,r=i.trackByArea,a=[].concat(r?n.areaPath:n.graphPath),s=a.length,o=n.chart,l=o.pointer,c=o.renderer,u=o.options.tooltip.snap,h=n.tracker,d=i.cursor,f=d&&{cursor:d},p=n.singlePoints,g=function(){o.hoverSeries!==n&&n.onMouseOver()};if(s&&!r)for(e=s+1;e--;)a[e]===Qe&&a.splice(e+1,0,a[e+1]-u,a[e+2],tn),(e&&a[e]===Qe||e===s)&&a.splice(e,0,tn,a[e-2]+u,a[e-1]);for(e=0;p.length>e;e++)t=p[e],a.push(Qe,t.plotX-u,t.plotY,tn,t.plotX+u,t.plotY);h?h.attr({d:a}):(n.tracker=h=c.path(a).attr({"class":Xe+"tracker","stroke-linejoin":"round",visibility:n.visible?Ge:We,stroke:en,fill:r?en:Ke,"stroke-width":i.lineWidth+(r?0:2*u),zIndex:2}).addClass(Xe+"tracker").on("mouseover",g).on("mouseout",function(t){l.onTrackerMouseOut(t)}).css(f).add(n.markerGroup),$e&&h.on("touchstart",g))}};var Bn=v(Hn);gn.line=Bn,En.area=e(Yn,{threshold:0});var Vn=v(Hn,{type:"area",getSegments:function(){var t,e,n,i,r=[],a=this.yAxis.stacks[this.stackKey],s={},o=this.points;if(this.options.stacking&&!this.cropped){for(n=0;o.length>n;n++)s[o[n].x]=o[n];for(i in a)s[i]?r.push(s[i]):(t=this.xAxis.translate(i),e=this.yAxis.toPixels(a[i].cum,!0),r.push({y:null,plotX:t,clientX:t,plotY:e,yBottom:e,onMouseOver:Re}));r=[r]}else Hn.prototype.getSegments.call(this),r=this.segments;this.segments=r},getSegmentPath:function(t){var e,n=Hn.prototype.getSegmentPath.call(this,t),i=[].concat(n),r=this.options,a=n.length;if(3===a&&i.push(tn,n[1],n[2]),r.stacking&&!this.closedStacks)for(e=t.length-1;e>=0;e--)t.length-1>e&&r.step&&i.push(t[e+1].plotX,t[e].yBottom),i.push(t[e].plotX,t[e].yBottom);else this.closeSegment(i,t);return this.areaPath=this.areaPath.concat(i),n},closeSegment:function(t,e){var n=this.yAxis.getThreshold(this.options.threshold);t.push(tn,e[e.length-1].plotX,n,tn,e[0].plotX,n)},drawGraph:function(){this.areaPath=[],Hn.prototype.drawGraph.apply(this);var t=this,e=this.areaPath,n=this.options,i=n.negativeColor,r=[["area",this.color,n.fillColor]];i&&r.push(["areaNeg",n.negativeColor,n.negativeFillColor]),wn(r,function(i){var r=i[0],a=t[r];a?a.animate({d:e}):t[r]=t.chart.renderer.path(e).attr({fill:p(i[2],Un(i[1]).setOpacity(n.fillOpacity||.75).get()),zIndex:0}).add(t.group)})},drawLegendSymbol:function(t,e){e.legendSymbol=this.chart.renderer.rect(0,t.baseline-11,t.options.symbolWidth,12,2).attr({zIndex:3}).add(e.legendGroup)}});gn.area=Vn,En.spline=e(Yn);var jn=v(Hn,{type:"spline",getPointSpline:function(t,e,n){var i,r,a,s,o,l=1.5,c=l+1,u=e.plotX,h=e.plotY,d=t[n-1],f=t[n+1];if(d&&f){var p,g=d.plotX,m=d.plotY,v=f.plotX,y=f.plotY;i=(l*u+g)/c,r=(l*h+m)/c,a=(l*u+v)/c,s=(l*h+y)/c,p=(s-r)*(a-u)/(a-i)+h-s,r+=p,s+=p,r>m&&r>h?(r=xe(m,h),s=2*h-r):m>r&&h>r&&(r=we(m,h),s=2*h-r),s>y&&s>h?(s=xe(y,h),r=2*h-s):y>s&&h>s&&(s=we(y,h),r=2*h-s),e.rightContX=a,e.rightContY=s}return n?(o=["C",d.rightContX||d.plotX,d.rightContY||d.plotY,i||u,r||h,u,h],d.rightContX=d.rightContY=null):o=[Qe,u,h],o}});gn.spline=jn,En.areaspline=e(En.area);var qn=Vn.prototype,Zn=v(jn,{type:"areaspline",closedStacks:!0,getSegmentPath:qn.getSegmentPath,closeSegment:qn.closeSegment,drawGraph:qn.drawGraph});gn.areaspline=Zn,En.column=e(Yn,{borderColor:"#FFFFFF",borderWidth:1,borderRadius:0,groupPadding:.2,marker:null,pointPadding:.1,minPointLength:0,cropThreshold:50,pointRange:null,states:{hover:{brightness:.1,shadow:!1},select:{color:"#C0C0C0",borderColor:"#000000",shadow:!1}},dataLabels:{align:null,verticalAlign:null,y:null},stickyTracking:!1,threshold:0});var Wn=v(Hn,{type:"column",tooltipOutsidePlot:!0,requireSorting:!1,pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color",r:"borderRadius"},trackerGroups:["group","dataLabelsGroup"],init:function(){Hn.prototype.init.apply(this,arguments);var t=this,e=t.chart;e.hasRendered&&wn(e.series,function(e){e.type===t.type&&(e.isDirty=!0)})},getColumnMetrics:function(){var t,e,n=this,i=n.chart,r=n.options,a=this.xAxis,s=a.reversed,o={},l=0;r.grouping===!1?l=1:wn(i.series,function(i){var r=i.options;i.type===n.type&&i.visible&&n.options.group===r.group&&(r.stacking?(t=i.stackKey,o[t]===W&&(o[t]=l++),e=o[t]):r.grouping!==!1&&(e=l++),i.columnIndex=e)});var c=we(Te(a.transA)*(a.ordinalSlope||r.pointRange||a.closestPointRange||1),a.len),u=c*r.groupPadding,d=c-2*u,f=d/l,g=r.pointWidth,m=h(g)?(f-g)/2:f*r.pointPadding,v=p(g,f-2*m),y=(s?l-(n.columnIndex||0):n.columnIndex)||0,b=m+(u+y*f-c/2)*(s?-1:1);
return n.columnMetrics={width:v,offset:b}},translate:function(){var t=this,e=t.chart,n=t.options,i=n.stacking,r=n.borderWidth,a=t.yAxis,s=n.threshold,o=t.translatedThreshold=a.getThreshold(s),l=p(n.minPointLength,5),c=t.getColumnMetrics(),u=c.width,h=be(xe(u,1+2*r)),d=c.offset;Hn.prototype.translate.apply(t),wn(t.points,function(n){var s,c=we(xe(-999,n.plotY),a.len+999),f=p(n.yBottom,o),g=n.plotX+d,m=be(we(c,f)),v=be(xe(c,f)-m),y=a.stacks[(0>n.y?"-":"")+t.stackKey];i&&t.visible&&y&&y[n.x]&&y[n.x].setOffset(d,h),l>Te(v)&&l&&(v=l,m=Te(m-o)>l?f-l:o-(o>=a.translate(n.y,0,1,0,1)?l:0)),n.barX=g,n.pointWidth=u,n.shapeType="rect",n.shapeArgs=s=e.renderer.Element.prototype.crisp.call(0,r,g,m,h,v),r%2&&(s.y-=1,s.height+=1)})},getSymbol:Re,drawLegendSymbol:Vn.prototype.drawLegendSymbol,drawGraph:Re,drawPoints:function(){var t,n=this,i=n.options,r=n.chart.renderer;wn(n.points,function(a){var s=a.plotY,o=a.graphic;s===W||isNaN(s)||null===a.y?o&&(a.graphic=o.destroy()):(t=a.shapeArgs,o?(Dn(o),o.animate(e(t))):a.graphic=o=r[a.shapeType](t).attr(a.pointAttr[a.selected?an:nn]).add(n.group).shadow(i.shadow,null,i.stacking&&!i.borderRadius))})},drawTracker:function(){var t=this,e=t.chart.pointer,n=t.options.cursor,i=n&&{cursor:n},r=function(e){var n,i=e.target;for(t.onMouseOver();i&&!n;)n=i.point,i=i.parentNode;n!==W&&n.onMouseOver(e)};wn(t.points,function(t){t.graphic&&(t.graphic.element.point=t),t.dataLabel&&(t.dataLabel.element.point=t)}),t._hasTracking?t._hasTracking=!0:wn(t.trackerGroups,function(n){t[n]&&(t[n].addClass(Xe+"tracker").on("mouseover",r).on("mouseout",function(t){e.onTrackerMouseOut(t)}).css(i),$e&&t[n].on("touchstart",r))})},alignDataLabel:function(t,n,i,r,a){var s=this.chart,o=s.inverted,l=t.dlBox||t.shapeArgs,c=t.below||t.plotY>p(this.translatedThreshold,s.plotSizeY),u=p(i.inside,!!this.options.stacking);l&&(r=e(l),o&&(r={x:s.plotWidth-r.y-r.height,y:s.plotHeight-r.x-r.width,width:r.height,height:r.width}),u||(o?(r.x+=c?0:r.width,r.width=0):(r.y+=c?r.height:0,r.height=0))),i.align=p(i.align,!o||u?"center":c?"right":"left"),i.verticalAlign=p(i.verticalAlign,o||u?"middle":c?"top":"bottom"),Hn.prototype.alignDataLabel.call(this,t,n,i,r,a)},animate:function(t){var e,n=this,i=this.yAxis,r=n.options,a=this.chart.inverted,s={};ze&&(t?(s.scaleY=.001,e=we(i.pos+i.len,xe(i.pos,i.toPixels(r.threshold))),a?s.translateX=e-i.len:s.translateY=e,n.group.attr(s)):(s.scaleY=1,s[a?"translateX":"translateY"]=i.pos,n.group.animate(s,n.options.animation),n.animate=null))},remove:function(){var t=this,e=t.chart;e.hasRendered&&wn(e.series,function(e){e.type===t.type&&(e.isDirty=!0)}),Hn.prototype.remove.apply(t,arguments)}});gn.column=Wn,En.bar=e(En.column);var Xn=v(Wn,{type:"bar",inverted:!0});gn.bar=Xn,En.scatter=e(Yn,{lineWidth:0,tooltip:{headerFormat:'<span style="font-size: 10px; color:{series.color}">{series.name}</span><br/>',pointFormat:"x: <b>{point.x}</b><br/>y: <b>{point.y}</b><br/>",followPointer:!0},stickyTracking:!1});var Gn=v(Hn,{type:"scatter",sorted:!1,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["markerGroup"],drawTracker:Wn.prototype.drawTracker,setTooltipPoints:Re});gn.scatter=Gn,En.pie=e(Yn,{borderColor:"#FFFFFF",borderWidth:1,center:[null,null],colorByPoint:!0,dataLabels:{distance:30,enabled:!0,formatter:function(){return this.point.name}},ignoreHiddenPoint:!0,legendType:"point",marker:null,size:null,showInLegend:!1,slicedOffset:10,states:{hover:{brightness:.1,shadow:!1}},stickyTracking:!1,tooltip:{followPointer:!0}});var Jn=v(Rn,{init:function(){Rn.prototype.init.apply(this,arguments);var e,n=this;return 0>n.y&&(n.y=null),t(n,{visible:n.visible!==!1,name:p(n.name,"Slice")}),e=function(){n.slice()},An(n,"select",e),An(n,"unselect",e),n},setVisible:function(t){var e,n=this,i=n.series,r=i.chart;n.visible=n.options.visible=t=t===W?!n.visible:t,i.options.data[xn(n,i.data)]=n.options,e=t?"show":"hide",wn(["graphic","dataLabel","connector","shadowGroup"],function(t){n[t]&&n[t][e]()}),n.legendItem&&r.legend.colorizeItem(n,t),!i.isDirty&&i.options.ignoreHiddenPoint&&(i.isDirty=!0,r.redraw())},slice:function(t,e,n){var i,r=this,a=r.series,s=a.chart;z(n,s),e=p(e,!0),r.sliced=r.options.sliced=t=h(t)?t:!r.sliced,a.options.data[xn(r,a.data)]=r.options,i=t?r.slicedTranslation:{translateX:0,translateY:0},r.graphic.animate(i),r.shadowGroup&&r.shadowGroup.animate(i)}}),Kn={type:"pie",isCartesian:!1,pointClass:Jn,requireSorting:!1,noSharedTooltip:!0,trackerGroups:["group","dataLabelsGroup"],pointAttrToOptions:{stroke:"borderColor","stroke-width":"borderWidth",fill:"color"},getColor:Re,animate:function(t){var e=this,n=e.points,i=e.startAngleRad;t||(wn(n,function(t){var n=t.graphic,r=t.shapeArgs;n&&(n.attr({r:e.center[3]/2,start:i,end:i}),n.animate({r:r.r,start:r.start,end:r.end},e.options.animation))}),e.animate=null)},setData:function(t,e){Hn.prototype.setData.call(this,t,!1),this.processData(),this.generatePoints(),p(e,!0)&&this.chart.redraw()},getCenter:function(){var t,e=this.options,n=this.chart,r=2*(e.dataLabels&&e.dataLabels.enabled?0:e.slicedOffset||0),a=n.plotWidth-2*r,s=n.plotHeight-2*r,o=e.center,l=[p(o[0],"50%"),p(o[1],"50%"),e.size||"100%",e.innerSize||0],c=we(a,s);return _n(l,function(e,n){return t=/%$/.test(e),(t?[a,s,c,c][n]*i(e)/100:e)+(3>n?r:0)})},translate:function(t){this.generatePoints();var e,n,i,r,a,s,o,l,c=0,u=this,h=0,d=1e3,f=u.options,p=f.slicedOffset,g=p+f.borderWidth,m=u.startAngleRad=Ae/180*((f.startAngle||0)%360-90),v=u.points,y=2*Ae,b=f.dataLabels.distance,x=f.ignoreHiddenPoint,w=v.length;for(t||(u.center=t=u.getCenter()),u.getX=function(e,n){return i=me.asin((e-t[1])/(t[2]/2+b)),t[0]+(n?-1:1)*Se(i)*(t[2]/2+b)},o=0;w>o;o++)l=v[o],c+=x&&!l.visible?0:l.y;for(o=0;w>o;o++)l=v[o],r=c?l.y/c:0,e=ve((m+h*y)*d)/d,(!x||l.visible)&&(h+=r),n=ve((m+h*y)*d)/d,l.shapeType="arc",l.shapeArgs={x:t[0],y:t[1],r:t[2]/2,innerR:t[3]/2,start:e,end:n},i=(n+e)/2,i>.75*y&&(i-=2*Ae),l.slicedTranslation={translateX:ve(Se(i)*p),translateY:ve(_e(i)*p)},a=Se(i)*t[2]/2,s=_e(i)*t[2]/2,l.tooltipPos=[t[0]+.7*a,t[1]+.7*s],l.half=y/4>i?0:1,l.angle=i,l.labelPos=[t[0]+a+Se(i)*b,t[1]+s+_e(i)*b,t[0]+a+Se(i)*g,t[1]+s+_e(i)*g,t[0]+a,t[1]+s,0>b?"center":l.half?"right":"left",i],l.percentage=100*r,l.total=c;this.setTooltipPoints()},drawGraph:null,drawPoints:function(){var e,n,i,r,a=this,s=a.chart,o=s.renderer,l=a.options.shadow;l&&!a.shadowGroup&&(a.shadowGroup=o.g("shadow").add(a.group)),wn(a.points,function(s){n=s.graphic,r=s.shapeArgs,i=s.shadowGroup,l&&!i&&(i=s.shadowGroup=o.g("shadow").add(a.shadowGroup)),e=s.sliced?s.slicedTranslation:{translateX:0,translateY:0},i&&i.attr(e),n?n.animate(t(r,e)):s.graphic=n=o.arc(r).setRadialReference(a.center).attr(s.pointAttr[s.selected?an:nn]).attr({"stroke-linejoin":"round"}).attr(e).add(a.group).shadow(l,i),s.visible===!1&&s.setVisible(!1)})},drawDataLabels:function(){var t,e,n,i,r,a,s,o,l,c,u,h,d,f=this,g=f.data,m=f.chart,v=f.options.dataLabels,y=p(v.connectorPadding,10),b=p(v.connectorWidth,1),x=m.plotWidth,w=m.plotHeight,T=p(v.softConnector,!0),S=v.distance,_=f.center,A=_[2]/2,C=_[1],M=S>0,k=[[],[]],O=[0,0,0,0],P=function(t,e){return e.y-t.y},E=function(t,e){t.sort(function(t,n){return void 0!==t.angle&&(n.angle-t.angle)*e})};if(v.enabled||f._hasPointLabels){for(Hn.prototype.drawDataLabels.apply(f),wn(g,function(t){t.dataLabel&&k[t.half].push(t)}),h=0;!s&&g[h];)s=g[h]&&g[h].dataLabel&&(g[h].dataLabel.getBBox().height||21),h++;for(h=2;h--;){var Y,U,z,F=[],L=[],$=k[h],I=$.length;if(E($,h-.5),S>0){for(U=C-A-S;C+A+S>=U;U+=s)F.push(U);if(Y=F.length,I>Y){for(u=[].concat($),u.sort(P),d=I;d--;)u[d].rank=d;for(d=I;d--;)$[d].rank>=Y&&$.splice(d,1);I=$.length}for(d=0;I>d;d++){t=$[d],a=t.labelPos;var N,R,H=9999;for(R=0;Y>R;R++)N=Te(F[R]-a[1]),H>N&&(H=N,z=R);if(d>z&&null!==F[d])z=d;else if(I-d+z>Y&&null!==F[d])for(z=Y-I+d;null===F[z];)z++;else for(;null===F[z];)z++;L.push({i:z,y:F[z]}),F[z]=null}L.sort(P)}for(d=0;I>d;d++){var B,V;t=$[d],a=t.labelPos,i=t.dataLabel,c=t.visible===!1?We:Ge,V=a[1],S>0?(B=L.pop(),z=B.i,l=B.y,(V>l&&null!==F[z+1]||l>V&&null!==F[z-1])&&(l=V)):l=V,o=v.justify?_[0]+(h?-1:1)*(A+S):f.getX(0===z||z===F.length-1?V:l,h),i._attr={visibility:c,align:a[6]},i._pos={x:o+v.x+({left:y,right:-y}[a[6]]||0),y:l+v.y-10},i.connX=o,i.connY=l,null===this.options.size&&(r=i.width,y>o-r?O[3]=xe(ve(r-o+y),O[3]):o+r>x-y&&(O[1]=xe(ve(o+r-x+y),O[1])),0>l-s/2?O[0]=xe(ve(-l+s/2),O[0]):l+s/2>w&&(O[2]=xe(ve(l+s/2-w),O[2])))}}(0===D(O)||this.verifyDataLabelOverflow(O))&&(this.placeDataLabels(),M&&b&&wn(this.points,function(t){e=t.connector,a=t.labelPos,i=t.dataLabel,i&&i._pos?(o=i.connX,l=i.connY,n=T?[Qe,o+("left"===a[6]?5:-5),l,"C",o,l,2*a[2]-a[4],2*a[3]-a[5],a[2],a[3],tn,a[4],a[5]]:[Qe,o+("left"===a[6]?5:-5),l,tn,a[2],a[3],tn,a[4],a[5]],e?(e.animate({d:n}),e.attr("visibility",c)):t.connector=e=f.chart.renderer.path(n).attr({"stroke-width":b,stroke:v.connectorColor||t.color||"#606060",visibility:c}).add(f.group)):e&&(t.connector=e.destroy())}))}},verifyDataLabelOverflow:function(t){var e,n=this.center,i=this.options,r=i.center,a=i.minSize||80,s=a;return null!==r[0]?s=xe(n[2]-xe(t[1],t[3]),a):(s=xe(n[2]-t[1]-t[3],a),n[0]+=(t[3]-t[1])/2),null!==r[1]?s=xe(we(s,n[2]-xe(t[0],t[2])),a):(s=xe(we(s,n[2]-t[0]-t[2]),a),n[1]+=(t[0]-t[2])/2),n[2]>s?(n[2]=s,this.translate(n),wn(this.points,function(t){t.dataLabel&&(t.dataLabel._pos=null)}),this.drawDataLabels()):e=!0,e},placeDataLabels:function(){wn(this.points,function(t){var e,n=t.dataLabel;n&&(e=n._pos,e?(n.attr(n._attr),n[n.moved?"animate":"attr"](e),n.moved=!0):n&&n.attr({y:-999}))})},alignDataLabel:Re,drawTracker:Wn.prototype.drawTracker,drawLegendSymbol:Vn.prototype.drawLegendSymbol,getSymbol:Re};Kn=v(Hn,Kn),gn.pie=Kn,t(Highcharts,{Axis:B,Chart:Z,Color:Un,Legend:q,Pointer:j,Point:Rn,Tick:N,Tooltip:V,Renderer:X,Series:Hn,SVGElement:I,SVGRenderer:zn,arrayMin:O,arrayMax:D,charts:He,dateFormat:K,format:S,pathAnim:te,getOptions:$,hasBidiBug:Fe,isTouchDevice:Ye,numberFormat:b,seriesTypes:gn,setOptions:L,addEvent:An,removeEvent:Cn,createElement:m,discardElement:E,css:g,each:wn,extend:t,map:_n,merge:e,pick:p,splat:f,extendClass:v,pInt:i,wrap:w,svg:ze,canvas:Le,vml:!ze&&!Le,product:Be,version:Ve})}(),function(){function t(t,e){try{for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}catch(i){t.prototype=e}}function e(t){for(var e=-1,n=t.length,i=[];n>++e;)i.push(t[e]);return i}function n(t){return Array.prototype.slice.call(t)}function i(){}function r(t){return t}function a(){return this}function s(){return!0}function o(t){return"function"==typeof t?t:function(){return t}}function l(t,e,n){return function(){var i=n.apply(e,arguments);return arguments.length?t:i}}function c(t){return null!=t&&!isNaN(t)}function u(t){return t.length}function h(t){return null==t}function d(t){return t.trim().replace(/\s+/g," ")}function f(t){for(var e=1;t*e%1;)e*=10;return e}function p(){}function g(t){function e(){for(var e,i=n,r=-1,a=i.length;a>++r;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],r=new i;return e.on=function(e,i){var a,s=r.get(e);return 2>arguments.length?s&&s.on:(s&&(s.on=null,n=n.slice(0,a=n.indexOf(s)).concat(n.slice(a+1)),r.remove(e)),i&&n.push(r.set(e,{on:i})),t)},e}function m(t,e){return e-(t?1+Math.floor(Math.log(t+Math.pow(10,1+Math.floor(Math.log(t)/Math.LN10)-e))/Math.LN10):1)}function v(t){return t+""}function y(t){for(var e=t.lastIndexOf("."),n=e>=0?t.substring(e):(e=t.length,""),i=[];e>0;)i.push(t.substring(e-=3,e+3));return i.reverse().join(",")+n}function b(t,e){var n=Math.pow(10,3*Math.abs(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function x(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function w(t){return function(e){return 1-t(1-e)}}function T(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function S(t){return t}function _(t){return function(e){return Math.pow(e,t)}}function A(t){return 1-Math.cos(t*Math.PI/2)}function C(t){return Math.pow(2,10*(t-1))}function M(t){return 1-Math.sqrt(1-t*t)}function k(t,e){var n;return 2>arguments.length&&(e=.45),1>arguments.length?(t=1,n=e/4):n=e/(2*Math.PI)*Math.asin(1/t),function(i){return 1+t*Math.pow(2,10*-i)*Math.sin(2*(i-n)*Math.PI/e)}}function O(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function D(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function P(){d3.event.stopPropagation(),d3.event.preventDefault()}function E(){for(var t,e=d3.event;t=e.sourceEvent;)e=t;return e}function Y(t){for(var e=new p,n=0,i=arguments.length;i>++n;)e[arguments[n]]=g(e);return e.of=function(n,i){return function(r){try{var a=r.sourceEvent=d3.event;r.target=t,d3.event=r,e[r.type].apply(n,i)}finally{d3.event=a}}},e}function U(t){var e=[t.a,t.b],n=[t.c,t.d],i=F(e),r=z(e,n),a=F(L(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*oa,this.translate=[t.e,t.f],this.scale=[i,a],this.skew=a?Math.atan2(r,a)*oa:0}function z(t,e){return t[0]*e[0]+t[1]*e[1]}function F(t){var e=Math.sqrt(z(t,t));return e&&(t[0]/=e,t[1]/=e),e}function L(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function $(t){return"transform"==t?d3.interpolateTransform:d3.interpolate}function I(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return(n-t)*e}}function N(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return Math.max(0,Math.min(1,(n-t)*e))}}function R(){}function H(t,e,n){return new B(t,e,n)}function B(t,e,n){this.r=t,this.g=e,this.b=n}function V(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function j(t,e,n){var i,r,a,s=0,o=0,l=0;if(i=/([a-z]+)\((.*)\)/i.exec(t))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(X(r[0]),X(r[1]),X(r[2]))}return(a=ha.get(t))?e(a.r,a.g,a.b):(null!=t&&"#"===t.charAt(0)&&(4===t.length?(s=t.charAt(1),s+=s,o=t.charAt(2),o+=o,l=t.charAt(3),l+=l):7===t.length&&(s=t.substring(1,3),o=t.substring(3,5),l=t.substring(5,7)),s=parseInt(s,16),o=parseInt(o,16),l=parseInt(l,16)),e(s,o,l))}function q(t,e,n){var i,r,a=Math.min(t/=255,e/=255,n/=255),s=Math.max(t,e,n),o=s-a,l=(s+a)/2;return o?(r=.5>l?o/(s+a):o/(2-s-a),i=t==s?(e-n)/o+(n>e?6:0):e==s?(n-t)/o+2:(t-e)/o+4,i*=60):r=i=0,G(i,r,l)}function Z(t,e,n){t=W(t),e=W(e),n=W(n);var i=oe((.4124564*t+.3575761*e+.1804375*n)/ga),r=oe((.2126729*t+.7151522*e+.072175*n)/ma),a=oe((.0193339*t+.119192*e+.9503041*n)/va);return ne(116*r-16,500*(i-r),200*(r-a))}function W(t){return.04045>=(t/=255)?t/12.92:Math.pow((t+.055)/1.055,2.4)}function X(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function G(t,e,n){return new J(t,e,n)}function J(t,e,n){this.h=t,this.s=e,this.l=n}function K(t,e,n){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?a+(s-a)*t/60:180>t?s:240>t?a+(s-a)*(240-t)/60:a}function r(t){return Math.round(255*i(t))}var a,s;return t%=360,0>t&&(t+=360),e=0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,s=.5>=n?n*(1+e):n+e-n*e,a=2*n-s,H(r(t+120),r(t),r(t-120))}function Q(t,e,n){return new te(t,e,n)}function te(t,e,n){this.h=t,this.c=e,this.l=n}function ee(t,e,n){return ne(n,Math.cos(t*=Math.PI/180)*e,Math.sin(t)*e)}function ne(t,e,n){return new ie(t,e,n)}function ie(t,e,n){this.l=t,this.a=e,this.b=n}function re(t,e,n){var i=(t+16)/116,r=i+e/500,a=i-n/200;return r=se(r)*ga,i=se(i)*ma,a=se(a)*va,H(le(3.2404542*r-1.5371385*i-.4985314*a),le(-.969266*r+1.8760108*i+.041556*a),le(.0556434*r-.2040259*i+1.0572252*a))}function ae(t,e,n){return Q(180*(Math.atan2(n,e)/Math.PI),Math.sqrt(e*e+n*n),t)}function se(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function oe(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function le(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ce(t){return Zr(t,_a),t}function ue(t){return function(){return ba(t,this)}}function he(t){return function(){return xa(t,this)}}function de(t,e){function n(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function a(){this.setAttributeNS(t.space,t.local,e)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function o(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=d3.ns.qualify(t),null==e?t.local?i:n:"function"==typeof e?t.local?o:s:t.local?a:r}function fe(t){return RegExp("(?:^|\\s+)"+d3.requote(t)+"(?:\\s+|$)","g")}function pe(t,e){function n(){for(var n=-1;r>++n;)t[n](this,e)}function i(){for(var n=-1,i=e.apply(this,arguments);r>++n;)t[n](this,i)}t=t.trim().split(/\s+/).map(ge);var r=t.length;return"function"==typeof e?i:n}function ge(t){var e=fe(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.className,a=null!=r.baseVal,s=a?r.baseVal:r;i?(e.lastIndex=0,e.test(s)||(s=d(s+" "+t),a?r.baseVal=s:n.className=s)):s&&(s=d(s.replace(e," ")),a?r.baseVal=s:n.className=s)}}function me(t,e,n){function i(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,n)}function a(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}return null==e?i:"function"==typeof e?a:r}function ve(t,e){function n(){delete this[t]}function i(){this[t]=e}function r(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?r:i}function ye(t){return{__data__:t}}function be(t){return function(){return Sa(this,t)}}function xe(t){return arguments.length||(t=d3.ascending),function(e,n){return t(e&&e.__data__,n&&n.__data__)}}function we(t,e,n){function i(){var e=this[a];e&&(this.removeEventListener(t,e,e.$),delete this[a])}function r(){function r(t){var n=d3.event;d3.event=t,o[0]=s.__data__;try{e.apply(s,o)}finally{d3.event=n}}var s=this,o=arguments;i.call(this),this.addEventListener(t,this[a]=r,r.$=n),r._=e}var a="__on"+t,s=t.indexOf(".");return s>0&&(t=t.substring(0,s)),e?r:i}function Te(t,e){for(var n=0,i=t.length;i>n;n++)for(var r,a=t[n],s=0,o=a.length;o>s;s++)(r=a[s])&&e(r,s,n);return t}function Se(t){return Zr(t,Ca),t}function _e(t,e,n){Zr(t,Ma);var r=new i,a=d3.dispatch("start","end"),s=za;return t.id=e,t.time=n,t.tween=function(e,n){return 2>arguments.length?r.get(e):(null==n?r.remove(e):r.set(e,n),t)},t.ease=function(e){return arguments.length?(s="function"==typeof e?e:d3.ease.apply(d3,arguments),t):s},t.each=function(e,n){return 2>arguments.length?Ae.call(t,e):(a.on(e,n),t)},d3.timer(function(i){return Te(t,function(t,o){function l(i){return p.active>e?u():(p.active=e,r.forEach(function(e,n){(n=n.call(t,g,o))&&h.push(n)}),a.start.call(t,g,o),c(i)||d3.timer(c,0,n),1)}function c(n){if(p.active!==e)return u();for(var i=(n-d)/f,r=s(i),l=h.length;l>0;)h[--l].call(t,r);return i>=1?(u(),Oa=e,a.end.call(t,g,o),Oa=0,1):void 0}function u(){return--p.count||delete t.__transition__,1}var h=[],d=t.delay,f=t.duration,p=(t=t.node).__transition__||(t.__transition__={active:0,count:0}),g=t.__data__;++p.count,i>=d?l(i):d3.timer(l,d,n)})},0,n),t}function Ae(t){var e=Oa,n=za,i=Ya,r=Ua;return Oa=this.id,za=this.ease(),Te(this,function(e,n,i){Ya=e.delay,Ua=e.duration,t.call(e=e.node,e.__data__,n,i)}),Oa=e,za=n,Ya=i,Ua=r,this}function Ce(t,e,n){return""!=n&&$a}function Me(t,e){return d3.tween(t,$(e))}function ke(){for(var t,e=Date.now(),n=Ra;n;)t=e-n.then,t>=n.delay&&(n.flush=n.callback(t)),n=n.next;var i=Oe()-e;i>24?(isFinite(i)&&(clearTimeout(La),La=setTimeout(ke,i)),Fa=0):(Fa=1,Ha(ke))}function Oe(){for(var t=null,e=Ra,n=1/0;e;)e.flush?(delete Na[e.callback.id],e=t?t.next=e.next:Ra=e.next):(n=Math.min(n,e.then+e.delay),e=(t=e).next);return n}function De(t,e){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(0>Ba&&(window.scrollX||window.scrollY)){n=d3.select(document.body).append("svg").style("position","absolute").style("top",0).style("left",0);var r=n[0][0].getScreenCTM();Ba=!(r.f||r.e),n.remove()}return Ba?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}function Pe(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Ee(t){return t.rangeExtent?t.rangeExtent():Pe(t.range())}function Ye(t,e){var n,i=0,r=t.length-1,a=t[i],s=t[r];return a>s&&(n=i,i=r,r=n,n=a,a=s,s=n),(e=e(s-a))&&(t[i]=e.floor(a),t[r]=e.ceil(s)),t}function Ue(){return Math}function ze(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?He:Re,l=i?N:I;return s=r(t,e,l,n),o=r(e,t,l,d3.interpolate),a}function a(t){return s(t)}var s,o;return a.invert=function(t){return o(t)},a.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},a.range=function(t){return arguments.length?(e=t,r()):e},a.rangeRound=function(t){return a.range(t).interpolate(d3.interpolateRound)},a.clamp=function(t){return arguments.length?(i=t,r()):i},a.interpolate=function(t){return arguments.length?(n=t,r()):n},a.ticks=function(e){return Ie(t,e)},a.tickFormat=function(e){return Ne(t,e)},a.nice=function(){return Ye(t,Le),r()},a.copy=function(){return ze(t,e,n,i)},r()}function Fe(t,e){return d3.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Le(t){return t=Math.pow(10,Math.round(Math.log(t)/Math.LN10)-1),t&&{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}}function $e(t,e){var n=Pe(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),a=e/i*r;return.15>=a?r*=10:.35>=a?r*=5:.75>=a&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function Ie(t,e){return d3.range.apply(d3,$e(t,e))}function Ne(t,e){return d3.format(",."+Math.max(0,-Math.floor(Math.log($e(t,e)[2])/Math.LN10+.01))+"f")}function Re(t,e,n,i){var r=n(t[0],t[1]),a=i(e[0],e[1]);return function(t){return a(r(t))}}function He(t,e,n,i){var r=[],a=[],s=0,o=Math.min(t.length,e.length)-1;for(t[o]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());o>=++s;)r.push(n(t[s-1],t[s])),a.push(i(e[s-1],e[s]));return function(e){var n=d3.bisect(t,e,1,o)-1;return a[n](r[n](e))}}function Be(t,e){function n(n){return t(e(n))}var i=e.pow;return n.invert=function(e){return i(t.invert(e))},n.domain=function(r){return arguments.length?(e=0>r[0]?je:Ve,i=e.pow,t.domain(r.map(e)),n):t.domain().map(i)},n.nice=function(){return t.domain(Ye(t.domain(),Ue)),n},n.ticks=function(){var n=Pe(t.domain()),r=[];if(n.every(isFinite)){var a=Math.floor(n[0]),s=Math.ceil(n[1]),o=i(n[0]),l=i(n[1]);if(e===je)for(r.push(i(a));s>a++;)for(var c=9;c>0;c--)r.push(i(a)*c);else{for(;s>a;a++)for(var c=1;10>c;c++)r.push(i(a)*c);r.push(i(a))}for(a=0;o>r[a];a++);for(s=r.length;r[s-1]>l;s--);r=r.slice(a,s)}return r},n.tickFormat=function(t,r){if(2>arguments.length&&(r=Va),1>arguments.length)return r;var a,s=Math.max(.1,t/n.ticks().length),o=e===je?(a=-1e-12,Math.floor):(a=1e-12,Math.ceil);return function(t){return s>=t/i(o(e(t)+a))?r(t):""}},n.copy=function(){return Be(t.copy(),e)},Fe(n,t)}function Ve(t){return Math.log(0>t?0:t)/Math.LN10}function je(t){return-Math.log(t>0?0:-t)/Math.LN10}function qe(t,e){function n(e){return t(i(e))}var i=Ze(e),r=Ze(1/e);return n.invert=function(e){return r(t.invert(e))},n.domain=function(e){return arguments.length?(t.domain(e.map(i)),n):t.domain().map(r)},n.ticks=function(t){return Ie(n.domain(),t)},n.tickFormat=function(t){return Ne(n.domain(),t)},n.nice=function(){return n.domain(Ye(n.domain(),Le))},n.exponent=function(t){if(!arguments.length)return e;var a=n.domain();return i=Ze(e=t),r=Ze(1/e),n.domain(a)},n.copy=function(){return qe(t.copy(),e)},Fe(n,t)}function Ze(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function We(t,e){function n(e){return s[((a.get(e)||a.set(e,t.push(e)))-1)%s.length]}function r(e,n){return d3.range(t.length).map(function(t){return e+n*t})}var a,s,o;return n.domain=function(r){if(!arguments.length)return t;t=[],a=new i;for(var s,o=-1,l=r.length;l>++o;)a.has(s=r[o])||a.set(s,t.push(s));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(s=t,o=0,e={t:"range",a:arguments},n):s},n.rangePoints=function(i,a){2>arguments.length&&(a=0);var l=i[0],c=i[1],u=(c-l)/(Math.max(1,t.length-1)+a);return s=r(2>t.length?(l+c)/2:l+u*a/2,u),o=0,e={t:"rangePoints",a:arguments},n},n.rangeBands=function(i,a,l){2>arguments.length&&(a=0),3>arguments.length&&(l=a);var c=i[1]<i[0],u=i[c-0],h=i[1-c],d=(h-u)/(t.length-a+2*l);return s=r(u+d*l,d),c&&s.reverse(),o=d*(1-a),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,a,l){2>arguments.length&&(a=0),3>arguments.length&&(l=a);var c=i[1]<i[0],u=i[c-0],h=i[1-c],d=Math.floor((h-u)/(t.length-a+2*l)),f=h-u-(t.length-a)*d;return s=r(u+Math.round(f/2),d),c&&s.reverse(),o=Math.round(d*(1-a)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return o},n.rangeExtent=function(){return Pe(e.a[0])},n.copy=function(){return We(t,e)},n.domain(t)}function Xe(t,e){function n(){var n=0,a=(t.length,e.length);for(r=[];a>++n;)r[n-1]=d3.quantile(t,n/a);return i}function i(t){return isNaN(t=+t)?0/0:e[d3.bisect(r,t)]}var r;return i.domain=function(e){return arguments.length?(t=e.filter(function(t){return!isNaN(t)}).sort(d3.ascending),n()):t},i.range=function(t){return arguments.length?(e=t,n()):e},i.quantiles=function(){return r},i.copy=function(){return Xe(t,e)},n()}function Ge(t,e,n){function i(e){return n[Math.max(0,Math.min(s,Math.floor(a*(e-t))))]}function r(){return a=n.length/(e-t),s=n.length-1,i}var a,s;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.copy=function(){return Ge(t,e,n)},r()}function Je(t,e){function n(n){return e[d3.bisect(t,n)]}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.copy=function(){return Je(t,e)},n}function Ke(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Ie(t,e)},e.tickFormat=function(e){return Ne(t,e)},e.copy=function(){return Ke(t)},e}function Qe(t){return t.innerRadius}function tn(t){return t.outerRadius}function en(t){return t.startAngle}function nn(t){return t.endAngle}function rn(t){function e(e){function s(){u.push("M",a(t(h),c))}for(var l,u=[],h=[],d=-1,f=e.length,p=o(n),g=o(i);f>++d;)r.call(this,l=e[d],d)?h.push([+p.call(this,l,d),+g.call(this,l,d)]):h.length&&(s(),h=[]);return h.length&&s(),u.length?u.join(""):null}var n=an,i=sn,r=s,a=on,l=a.key,c=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?a=t:(a=Ja.get(t)||on).key,e):l},e.tension=function(t){return arguments.length?(c=t,e):c},e}function an(t){return t[0]}function sn(t){return t[1]}function on(t){return t.join("L")}function ln(t){return on(t)+"Z"}function cn(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function un(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function hn(t,e){return 4>t.length?on(t):t[1]+pn(t.slice(1,t.length-1),gn(t,e))}function dn(t,e){return 3>t.length?on(t):t[0]+pn((t.push(t[0]),t),gn([t[t.length-2]].concat(t,[t[1]]),e))}function fn(t,e){return 3>t.length?on(t):t[0]+pn(t,gn(t,e))}function pn(t,e){if(1>e.length||t.length!=e.length&&t.length!=e.length+2)return on(t);var n=t.length!=e.length,i="",r=t[0],a=t[1],s=e[0],o=s,l=1;if(n&&(i+="Q"+(a[0]-2*s[0]/3)+","+(a[1]-2*s[1]/3)+","+a[0]+","+a[1],r=t[1],l=2),e.length>1){o=e[1],a=t[l],l++,i+="C"+(r[0]+s[0])+","+(r[1]+s[1])+","+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1];for(var c=2;e.length>c;c++,l++)a=t[l],o=e[c],i+="S"+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1]}if(n){var u=t[l];i+="Q"+(a[0]+2*o[0]/3)+","+(a[1]+2*o[1]/3)+","+u[0]+","+u[1]}return i}function gn(t,e){for(var n,i=[],r=(1-e)/2,a=t[0],s=t[1],o=1,l=t.length;l>++o;)n=a,a=s,s=t[o],i.push([r*(s[0]-n[0]),r*(s[1]-n[1])]);return i}function mn(t){if(3>t.length)return on(t);var e=1,n=t.length,i=t[0],r=i[0],a=i[1],s=[r,r,r,(i=t[1])[0]],o=[a,a,a,i[1]],l=[r,",",a];for(wn(l,s,o);n>++e;)i=t[e],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),wn(l,s,o);for(e=-1;2>++e;)s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),wn(l,s,o);return l.join("")}function vn(t){if(4>t.length)return on(t);for(var e,n=[],i=-1,r=t.length,a=[0],s=[0];3>++i;)e=t[i],a.push(e[0]),s.push(e[1]);for(n.push(xn(ts,a)+","+xn(ts,s)),--i;r>++i;)e=t[i],a.shift(),a.push(e[0]),s.shift(),s.push(e[1]),wn(n,a,s);return n.join("")}function yn(t){for(var e,n,i=-1,r=t.length,a=r+4,s=[],o=[];4>++i;)n=t[i%r],s.push(n[0]),o.push(n[1]);for(e=[xn(ts,s),",",xn(ts,o)],--i;a>++i;)n=t[i%r],s.shift(),s.push(n[0]),o.shift(),o.push(n[1]),wn(e,s,o);return e.join("")}function bn(t,e){var n=t.length-1;if(n)for(var i,r,a=t[0][0],s=t[0][1],o=t[n][0]-a,l=t[n][1]-s,c=-1;n>=++c;)i=t[c],r=c/n,i[0]=e*i[0]+(1-e)*(a+r*o),i[1]=e*i[1]+(1-e)*(s+r*l);return mn(t)}function xn(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function wn(t,e,n){t.push("C",xn(Ka,e),",",xn(Ka,n),",",xn(Qa,e),",",xn(Qa,n),",",xn(ts,e),",",xn(ts,n))}function Tn(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Sn(t){for(var e=0,n=t.length-1,i=[],r=t[0],a=t[1],s=i[0]=Tn(r,a);n>++e;)i[e]=(s+(s=Tn(r=a,a=t[e+1])))/2;return i[e]=s,i}function _n(t){for(var e,n,i,r,a=[],s=Sn(t),o=-1,l=t.length-1;l>++o;)e=Tn(t[o],t[o+1]),1e-6>Math.abs(e)?s[o]=s[o+1]=0:(n=s[o]/e,i=s[o+1]/e,r=n*n+i*i,r>9&&(r=3*e/Math.sqrt(r),s[o]=r*n,s[o+1]=r*i));for(o=-1;l>=++o;)r=(t[Math.min(l,o+1)][0]-t[Math.max(0,o-1)][0])/(6*(1+s[o]*s[o])),a.push([r||0,s[o]*r||0]);return a}function An(t){return 3>t.length?on(t):t[0]+pn(t,_n(t))}function Cn(t){for(var e,n,i,r=-1,a=t.length;a>++r;)e=t[r],n=e[0],i=e[1]+Xa,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function Mn(t){function e(e){function s(){m.push("M",c(t(y),f),d,h(t(v.reverse()),f),"Z")}for(var u,p,g,m=[],v=[],y=[],b=-1,x=e.length,w=o(n),T=o(r),S=n===i?function(){return p}:o(i),_=r===a?function(){return g}:o(a);x>++b;)l.call(this,u=e[b],b)?(v.push([p=+w.call(this,u,b),g=+T.call(this,u,b)]),y.push([+S.call(this,u,b),+_.call(this,u,b)])):v.length&&(s(),v=[],y=[]);return v.length&&s(),m.length?m.join(""):null}var n=an,i=an,r=0,a=sn,l=s,c=on,u=c.key,h=c,d="L",f=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=a=t,e):a},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(a=t,e):a},e.defined=function(t){return arguments.length?(l=t,e):l},e.interpolate=function(t){return arguments.length?(u="function"==typeof t?c=t:(c=Ja.get(t)||on).key,h=c.reverse||c,d=c.closed?"M":"L",e):u},e.tension=function(t){return arguments.length?(f=t,e):f},e}function kn(t){return t.source}function On(t){return t.target}function Dn(t){return t.radius}function Pn(t){return[t.x,t.y]}function En(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]+Xa;return[n*Math.cos(i),n*Math.sin(i)]}}function Yn(){return 64}function Un(){return"circle"}function zn(t){var e=Math.sqrt(t/Math.PI);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Fn(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function Ln(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function $n(t,e,n){if(i=[],n&&e.length>1){for(var i,r,a,s=Pe(t.domain()),o=-1,l=e.length,c=(e[1]-e[0])/++n;l>++o;)for(r=n;--r>0;)(a=+e[o]-r*c)>=s[0]&&i.push(a);for(--o,r=0;n>++r&&(a=+e[o]+r*c)<s[1];)i.push(a)}return i}function In(){ss||(ss=d3.select("body").append("div").style("visibility","hidden").style("top",0).style("height",0).style("width",0).style("overflow-y","scroll").append("div").style("height","2000px").node().parentNode);
var t,e=d3.event;try{ss.scrollTop=1e3,ss.dispatchEvent(e),t=1e3-ss.scrollTop}catch(n){t=e.wheelDelta||5*-e.detail}return t}function Nn(t){for(var e=t.source,n=t.target,i=Hn(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var a=r.length;n!==i;)r.splice(a,0,n),n=n.parent;return r}function Rn(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function Hn(t,e){if(t===e)return t;for(var n=Rn(t),i=Rn(e),r=n.pop(),a=i.pop(),s=null;r===a;)s=r,r=n.pop(),a=i.pop();return s}function Bn(t){t.fixed|=2}function Vn(t){t.fixed&=1}function jn(t){t.fixed|=4}function qn(t){t.fixed&=3}function Zn(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var a,s=t.nodes,o=s.length,l=-1;o>++l;)a=s[l],null!=a&&(Zn(a,e,n),t.charge+=a.charge,i+=a.charge*a.cx,r+=a.charge*a.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*n[t.point.index];t.charge+=t.pointCharge=c,i+=c*t.point.x,r+=c*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function Wn(){return 20}function Xn(){return 1}function Gn(t){return t.x}function Jn(t){return t.y}function Kn(t,e,n){t.y0=e,t.y=n}function Qn(t){return d3.range(t.length)}function ti(t){for(var e=-1,n=t[0].length,i=[];n>++e;)i[e]=0;return i}function ei(t){for(var e,n=1,i=0,r=t[0][1],a=t.length;a>n;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function ni(t){return t.reduce(ii,0)}function ii(t,e){return t+e[1]}function ri(t,e){return ai(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function ai(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,a=[];e>=++n;)a[n]=r*n+i;return a}function si(t){return[d3.min(t),d3.max(t)]}function oi(t,e){return d3.rebind(t,e,"sort","children","value"),t.links=hi,t.nodes=function(e){return hs=!0,(t.nodes=t)(e)},t}function li(t){return t.children}function ci(t){return t.value}function ui(t,e){return e.value-t.value}function hi(t){return d3.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function di(t,e){return t.value-e.value}function fi(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function pi(t,e){t._pack_next=e,e._pack_prev=t}function gi(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return r*r-n*n-i*i>.001}function mi(t){function e(t){u=Math.min(t.x-t.r,u),h=Math.max(t.x+t.r,h),d=Math.min(t.y-t.r,d),f=Math.max(t.y+t.r,f)}if((n=t.children)&&(c=n.length)){var n,i,r,a,s,o,l,c,u=1/0,h=-1/0,d=1/0,f=-1/0;if(n.forEach(vi),i=n[0],i.x=-i.r,i.y=0,e(i),c>1&&(r=n[1],r.x=r.r,r.y=0,e(r),c>2))for(a=n[2],xi(i,r,a),e(a),fi(i,a),i._pack_prev=a,fi(a,r),r=i._pack_next,s=3;c>s;s++){xi(i,r,a=n[s]);var p=0,g=1,m=1;for(o=r._pack_next;o!==r;o=o._pack_next,g++)if(gi(o,a)){p=1;break}if(1==p)for(l=i._pack_prev;l!==o._pack_prev&&!gi(l,a);l=l._pack_prev,m++);p?(m>g||g==m&&r.r<i.r?pi(i,r=o):pi(i=l,r),s--):(fi(i,a),r=a,e(a))}var v=(u+h)/2,y=(d+f)/2,b=0;for(s=0;c>s;s++)a=n[s],a.x-=v,a.y-=y,b=Math.max(b,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=b,n.forEach(yi)}}function vi(t){t._pack_next=t._pack_prev=t}function yi(t){delete t._pack_next,delete t._pack_prev}function bi(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var a=-1,s=r.length;s>++a;)bi(r[a],e,n,i)}function xi(t,e,n){var i=t.r+n.r,r=e.x-t.x,a=e.y-t.y;if(i&&(r||a)){var s=e.r+n.r,o=r*r+a*a;s*=s,i*=i;var l=.5+(i-s)/(2*o),c=Math.sqrt(Math.max(0,2*s*(i+o)-(i-=o)*i-s*s))/(2*o);n.x=t.x+l*r+c*a,n.y=t.y+l*a-c*r}else n.x=t.x+i,n.y=t.y}function wi(t){return 1+d3.max(t,function(t){return t.y})}function Ti(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function Si(t){var e=t.children;return e&&e.length?Si(e[0]):t}function _i(t){var e,n=t.children;return n&&(e=n.length)?_i(n[e-1]):t}function Ai(t,e){return t.parent==e.parent?1:2}function Ci(t){var e=t.children;return e&&e.length?e[0]:t._tree.thread}function Mi(t){var e,n=t.children;return n&&(e=n.length)?n[e-1]:t._tree.thread}function ki(t,e){var n=t.children;if(n&&(r=n.length))for(var i,r,a=-1;r>++a;)e(i=ki(n[a],e),t)>0&&(t=i);return t}function Oi(t,e){return t.x-e.x}function Di(t,e){return e.x-t.x}function Pi(t,e){return t.depth-e.depth}function Ei(t,e){function n(t,i){var r=t.children;if(r&&(s=r.length))for(var a,s,o=null,l=-1;s>++l;)a=r[l],n(a,o),o=a;e(t,i)}n(t,null)}function Yi(t){for(var e,n=0,i=0,r=t.children,a=r.length;--a>=0;)e=r[a]._tree,e.prelim+=n,e.mod+=n,n+=e.shift+(i+=e.change)}function Ui(t,e,n){t=t._tree,e=e._tree;var i=n/(e.number-t.number);t.change+=i,e.change-=i,e.shift+=n,e.prelim+=n,e.mod+=n}function zi(t,e,n){return t._tree.ancestor.parent==e.parent?t._tree.ancestor:n}function Fi(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Li(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],a=t.dy-e[0]-e[2];return 0>r&&(n+=r/2,r=0),0>a&&(i+=a/2,a=0),{x:n,y:i,dx:r,dy:a}}function $i(t,e){function n(t,i){d3.text(t,e,function(t){i(t&&n.parse(t))})}function i(e){return e.map(r).join(t)}function r(t){return s.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var a=RegExp("\r\n|["+t+"\r\n]","g"),s=RegExp('["'+t+"\n]"),o=t.charCodeAt(0);return n.parse=function(t){var e;return n.parseRows(t,function(t,n){if(n){for(var i={},r=-1,a=e.length;a>++r;)i[e[r]]=t[r];return i}return e=t,null})},n.parseRows=function(t,e){function n(){if(a.lastIndex>=t.length)return l;if(r)return r=!1,s;var e=a.lastIndex;if(34===t.charCodeAt(e)){for(var n=e;n++<t.length;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;n++}a.lastIndex=n+2;var i=t.charCodeAt(n+1);return 13===i?(r=!0,10===t.charCodeAt(n+2)&&a.lastIndex++):10===i&&(r=!0),t.substring(e+1,n).replace(/""/g,'"')}var c=a.exec(t);return c?(r=c[0].charCodeAt(0)!==o,t.substring(e,c.index)):(a.lastIndex=t.length,t.substring(e))}var i,r,s={},l={},c=[],u=0;for(a.lastIndex=0;(i=n())!==l;){for(var h=[];i!==s&&i!==l;)h.push(i),i=n();(!e||(h=e(h,u++)))&&c.push(h)}return c},n.format=function(t){return t.map(i).join("\n")},n}function Ii(t,e){return function(n){return n&&t.hasOwnProperty(n.type)?t[n.type](n):e}}function Ni(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ri(t,e){fs.hasOwnProperty(t.type)&&fs[t.type](t,e)}function Hi(t,e){Ri(t.geometry,e)}function Bi(t,e){for(var n=t.features,i=0,r=n.length;r>i;i++)Ri(n[i].geometry,e)}function Vi(t,e){for(var n=t.geometries,i=0,r=n.length;r>i;i++)Ri(n[i],e)}function ji(t,e){for(var n=t.coordinates,i=0,r=n.length;r>i;i++)e.apply(null,n[i])}function qi(t,e){for(var n=t.coordinates,i=0,r=n.length;r>i;i++)for(var a=n[i],s=0,o=a.length;o>s;s++)e.apply(null,a[s])}function Zi(t,e){for(var n=t.coordinates,i=0,r=n.length;r>i;i++)for(var a=n[i][0],s=0,o=a.length;o>s;s++)e.apply(null,a[s])}function Wi(t,e){e.apply(null,t.coordinates)}function Xi(t,e){for(var n=t.coordinates[0],i=0,r=n.length;r>i;i++)e.apply(null,n[i])}function Gi(t){return t.source}function Ji(t){return t.target}function Ki(){function t(t){var e=Math.sin(t*=f)*p,n=Math.sin(f-t)*p,i=n*a+e*h,o=n*s+e*d,l=n*r+e*u;return[Math.atan2(o,i)/ds,Math.atan2(l,Math.sqrt(i*i+o*o))/ds]}var e,n,i,r,a,s,o,l,c,u,h,d,f,p;return t.distance=function(){return null==f&&(p=1/Math.sin(f=Math.acos(Math.max(-1,Math.min(1,r*u+i*c*Math.cos(o-e)))))),f},t.source=function(o){var l=Math.cos(e=o[0]*ds),c=Math.sin(e);return i=Math.cos(n=o[1]*ds),r=Math.sin(n),a=i*l,s=i*c,f=null,t},t.target=function(e){var n=Math.cos(o=e[0]*ds),i=Math.sin(o);return c=Math.cos(l=e[1]*ds),u=Math.sin(l),h=c*n,d=c*i,f=null,t},t}function Qi(t,e){var n=Ki().source(t).target(e);return n.distance(),n}function tr(t){for(var e=0,n=0;;){if(t(e,n))return[e,n];0===e?(e=n+1,n=0):(e-=1,n+=1)}}function er(t,e,n,i){var r,a,s,o,l,c,u;return r=i[t],a=r[0],s=r[1],r=i[e],o=r[0],l=r[1],r=i[n],c=r[0],u=r[1],(u-s)*(o-a)-(l-s)*(c-a)>0}function nr(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function ir(t,e,n,i){var r=t[0],a=e[0],s=n[0],o=i[0],l=t[1],c=e[1],u=n[1],h=i[1],d=r-s,f=a-r,p=o-s,g=l-u,m=c-l,v=h-u,y=(p*g-v*d)/(v*f-p*m);return[r+y*f,l+y*m]}function rr(t,e){var n={list:t.map(function(t,e){return{index:e,x:t[0],y:t[1]}}).sort(function(t,e){return t.y<e.y?-1:t.y>e.y?1:t.x<e.x?-1:t.x>e.x?1:0}),bottomSite:null},i={list:[],leftEnd:null,rightEnd:null,init:function(){i.leftEnd=i.createHalfEdge(null,"l"),i.rightEnd=i.createHalfEdge(null,"l"),i.leftEnd.r=i.rightEnd,i.rightEnd.l=i.leftEnd,i.list.unshift(i.leftEnd,i.rightEnd)},createHalfEdge:function(t,e){return{edge:t,side:e,vertex:null,l:null,r:null}},insert:function(t,e){e.l=t,e.r=t.r,t.r.l=e,t.r=e},leftBound:function(t){var e=i.leftEnd;do e=e.r;while(e!=i.rightEnd&&r.rightOf(e,t));return e=e.l},del:function(t){t.l.r=t.r,t.r.l=t.l,t.edge=null},right:function(t){return t.r},left:function(t){return t.l},leftRegion:function(t){return null==t.edge?n.bottomSite:t.edge.region[t.side]},rightRegion:function(t){return null==t.edge?n.bottomSite:t.edge.region[ms[t.side]]}},r={bisect:function(t,e){var n={region:{l:t,r:e},ep:{l:null,r:null}},i=e.x-t.x,r=e.y-t.y,a=i>0?i:-i,s=r>0?r:-r;return n.c=t.x*i+t.y*r+.5*(i*i+r*r),a>s?(n.a=1,n.b=r/i,n.c/=i):(n.b=1,n.a=i/r,n.c/=r),n},intersect:function(t,e){var n=t.edge,i=e.edge;if(!n||!i||n.region.r==i.region.r)return null;var r=n.a*i.b-n.b*i.a;if(1e-10>Math.abs(r))return null;var a,s,o=(n.c*i.b-i.c*n.b)/r,l=(i.c*n.a-n.c*i.a)/r,c=n.region.r,u=i.region.r;c.y<u.y||c.y==u.y&&c.x<u.x?(a=t,s=n):(a=e,s=i);var h=o>=s.region.r.x;return h&&"l"===a.side||!h&&"r"===a.side?null:{x:o,y:l}},rightOf:function(t,e){var n=t.edge,i=n.region.r,r=e.x>i.x;if(r&&"l"===t.side)return 1;if(!r&&"r"===t.side)return 0;if(1===n.a){var a=e.y-i.y,s=e.x-i.x,o=0,l=0;if(!r&&0>n.b||r&&n.b>=0?l=o=a>=n.b*s:(l=e.x+e.y*n.b>n.c,0>n.b&&(l=!l),l||(o=1)),!o){var c=i.x-n.region.l.x;l=n.b*(s*s-a*a)<c*a*(1+2*s/c+n.b*n.b),0>n.b&&(l=!l)}}else{var u=n.c-n.a*e.x,h=e.y-u,d=e.x-i.x,f=u-i.y;l=h*h>d*d+f*f}return"l"===t.side?l:!l},endPoint:function(t,n,i){t.ep[n]=i,t.ep[ms[n]]&&e(t)},distance:function(t,e){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)}},a={list:[],insert:function(t,e,n){t.vertex=e,t.ystar=e.y+n;for(var i=0,r=a.list,s=r.length;s>i;i++){var o=r[i];if(!(t.ystar>o.ystar||t.ystar==o.ystar&&e.x>o.vertex.x))break}r.splice(i,0,t)},del:function(t){for(var e=0,n=a.list,i=n.length;i>e&&n[e]!=t;++e);n.splice(e,1)},empty:function(){return 0===a.list.length},nextEvent:function(t){for(var e=0,n=a.list,i=n.length;i>e;++e)if(n[e]==t)return n[e+1];return null},min:function(){var t=a.list[0];return{x:t.vertex.x,y:t.ystar}},extractMin:function(){return a.list.shift()}};i.init(),n.bottomSite=n.list.shift();for(var s,o,l,c,u,h,d,f,p,g,m,v,y,b=n.list.shift();;)if(a.empty()||(s=a.min()),b&&(a.empty()||b.y<s.y||b.y==s.y&&b.x<s.x))o=i.leftBound(b),l=i.right(o),d=i.rightRegion(o),v=r.bisect(d,b),h=i.createHalfEdge(v,"l"),i.insert(o,h),g=r.intersect(o,h),g&&(a.del(o),a.insert(o,g,r.distance(g,b))),o=h,h=i.createHalfEdge(v,"r"),i.insert(o,h),g=r.intersect(h,l),g&&a.insert(h,g,r.distance(g,b)),b=n.list.shift();else{if(a.empty())break;o=a.extractMin(),c=i.left(o),l=i.right(o),u=i.right(l),d=i.leftRegion(o),f=i.rightRegion(l),m=o.vertex,r.endPoint(o.edge,o.side,m),r.endPoint(l.edge,l.side,m),i.del(o),a.del(l),i.del(l),y="l",d.y>f.y&&(p=d,d=f,f=p,y="r"),v=r.bisect(d,f),h=i.createHalfEdge(v,y),i.insert(c,h),r.endPoint(v,ms[y],m),g=r.intersect(c,h),g&&(a.del(c),a.insert(c,g,r.distance(g,d))),g=r.intersect(h,u),g&&a.insert(h,g,r.distance(g,d))}for(o=i.right(i.leftEnd);o!=i.rightEnd;o=i.right(o))e(o.edge)}function ar(){return{leaf:!0,nodes:[],point:null}}function sr(t,e,n,i,r,a){if(!t(e,n,i,r,a)){var s=.5*(n+r),o=.5*(i+a),l=e.nodes;l[0]&&sr(t,l[0],n,i,s,o),l[1]&&sr(t,l[1],s,i,r,o),l[2]&&sr(t,l[2],n,o,s,a),l[3]&&sr(t,l[3],s,o,r,a)}}function or(t){return{x:t[0],y:t[1]}}function lr(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function cr(t){return t.substring(0,3)}function ur(t,e,n,i){for(var r,a,s=0,o=e.length,l=n.length;o>s;){if(i>=l)return-1;if(r=e.charCodeAt(s++),37==r){if(a=$s[e.charAt(s++)],!a||0>(i=a(t,n,i)))return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function hr(t){return RegExp("^(?:"+t.map(d3.requote).join("|")+")","i")}function dr(t){for(var e=new i,n=-1,r=t.length;r>++n;)e.set(t[n].toLowerCase(),n);return e}function fr(t,e,n){Es.lastIndex=0;var i=Es.exec(e.substring(n));return i?n+=i[0].length:-1}function pr(t,e,n){Ps.lastIndex=0;var i=Ps.exec(e.substring(n));return i?n+=i[0].length:-1}function gr(t,e,n){zs.lastIndex=0;var i=zs.exec(e.substring(n));return i?(t.m=Fs.get(i[0].toLowerCase()),n+=i[0].length):-1}function mr(t,e,n){Ys.lastIndex=0;var i=Ys.exec(e.substring(n));return i?(t.m=Us.get(i[0].toLowerCase()),n+=i[0].length):-1}function vr(t,e,n){return ur(t,""+Ls.c,e,n)}function yr(t,e,n){return ur(t,""+Ls.x,e,n)}function br(t,e,n){return ur(t,""+Ls.X,e,n)}function xr(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+4));return i?(t.y=+i[0],n+=i[0].length):-1}function wr(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+2));return i?(t.y=Tr(+i[0]),n+=i[0].length):-1}function Tr(t){return t+(t>68?1900:2e3)}function Sr(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+2));return i?(t.m=i[0]-1,n+=i[0].length):-1}function _r(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+2));return i?(t.d=+i[0],n+=i[0].length):-1}function Ar(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+2));return i?(t.H=+i[0],n+=i[0].length):-1}function Cr(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+2));return i?(t.M=+i[0],n+=i[0].length):-1}function Mr(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+2));return i?(t.S=+i[0],n+=i[0].length):-1}function kr(t,e,n){Is.lastIndex=0;var i=Is.exec(e.substring(n,n+3));return i?(t.L=+i[0],n+=i[0].length):-1}function Or(t,e,n){var i=Ns.get(e.substring(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}function Dr(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=~~(Math.abs(e)/60),r=Math.abs(e)%60;return n+Ms(i)+Ms(r)}function Pr(t){return t.toISOString()}function Er(t,e,n){function i(e){var n=t(e),i=a(n,1);return i-e>e-n?n:i}function r(n){return e(n=t(new vs(n-1)),1),n}function a(t,n){return e(t=new vs(+t),n),t}function s(t,i,a){var s=r(t),o=[];if(a>1)for(;i>s;)n(s)%a||o.push(new Date(+s)),e(s,1);else for(;i>s;)o.push(new Date(+s)),e(s,1);return o}function o(t,e,n){try{vs=lr;var i=new lr;return i._=t,s(i,e,n)}finally{vs=Date}}t.floor=t,t.round=i,t.ceil=r,t.offset=a,t.range=s;var l=t.utc=Yr(t);return l.floor=l,l.round=Yr(i),l.ceil=Yr(r),l.offset=Yr(a),l.range=o,t}function Yr(t){return function(e,n){try{vs=lr;var i=new lr;return i._=e,t(i,n)._}finally{vs=Date}}}function Ur(t,e,n){function i(e){return t(e)}return i.invert=function(e){return Fr(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Fr)},i.nice=function(t){return i.domain(Ye(i.domain(),function(){return t}))},i.ticks=function(n,r){var a=zr(i.domain());if("function"!=typeof n){var s=a[1]-a[0],o=s/n,l=d3.bisect(Hs,o);if(l==Hs.length)return e.year(a,n);if(!l)return t.ticks(n).map(Fr);Math.log(o/Hs[l-1])<Math.log(Hs[l]/o)&&--l,n=e[l],r=n[1],n=n[0].range}return n(a[0],new Date(+a[1]+1),r)},i.tickFormat=function(){return n},i.copy=function(){return Ur(t.copy(),e,n)},d3.rebind(i,t,"range","rangeRound","interpolate","clamp")}function zr(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Fr(t){return new Date(t)}function Lr(t){return function(e){for(var n=t.length-1,i=t[n];!i[1](e);)i=t[--n];return i[0](e)}}function $r(t){var e=new Date(t,0,1);return e.setFullYear(t),e}function Ir(t){var e=t.getFullYear(),n=$r(e),i=$r(e+1);return e+(t-n)/(i-n)}function Nr(t){var e=new Date(Date.UTC(t,0,1));return e.setUTCFullYear(t),e}function Rr(t){var e=t.getUTCFullYear(),n=Nr(e),i=Nr(e+1);return e+(t-n)/(i-n)}Date.now||(Date.now=function(){return+new Date});try{document.createElement("div").style.setProperty("opacity",0,"")}catch(Hr){var Br=CSSStyleDeclaration.prototype,Vr=Br.setProperty;Br.setProperty=function(t,e,n){Vr.call(this,t,e+"",n)}}d3={version:"2.10.3"};var jr=n;try{jr(document.documentElement.childNodes)[0].nodeType}catch(qr){jr=e}var Zr=[].__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]};d3.map=function(t){var e=new i;for(var n in t)e.set(n,t[n]);return e},t(i,{has:function(t){return Wr+t in this},get:function(t){return this[Wr+t]},set:function(t,e){return this[Wr+t]=e},remove:function(t){return t=Wr+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},values:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},entries:function(){var t=[];return this.forEach(function(e,n){t.push({key:e,value:n})}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===Xr&&t.call(this,e.substring(1),this[e])}});var Wr="\0",Xr=Wr.charCodeAt(0);d3.functor=o,d3.rebind=function(t,e){for(var n,i=1,r=arguments.length;r>++i;)t[n=arguments[i]]=l(t,e,e[n]);return t},d3.ascending=function(t,e){return e>t?-1:t>e?1:t>=e?0:0/0},d3.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},d3.mean=function(t,e){var n,i=t.length,r=0,a=-1,s=0;if(1===arguments.length)for(;i>++a;)c(n=t[a])&&(r+=(n-r)/++s);else for(;i>++a;)c(n=e.call(t,t[a],a))&&(r+=(n-r)/++s);return s?r:void 0},d3.median=function(t,e){return arguments.length>1&&(t=t.map(e)),t=t.filter(c),t.length?d3.quantile(t.sort(d3.ascending),.5):void 0},d3.min=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;a>++r&&(null==(n=t[r])||n!=n);)n=void 0;for(;a>++r;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;a>++r&&(null==(n=e.call(t,t[r],r))||n!=n);)n=void 0;for(;a>++r;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},d3.max=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;a>++r&&(null==(n=t[r])||n!=n);)n=void 0;for(;a>++r;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;a>++r&&(null==(n=e.call(t,t[r],r))||n!=n);)n=void 0;for(;a>++r;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},d3.extent=function(t,e){var n,i,r,a=-1,s=t.length;if(1===arguments.length){for(;s>++a&&(null==(n=r=t[a])||n!=n);)n=r=void 0;for(;s>++a;)null!=(i=t[a])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;s>++a&&(null==(n=r=e.call(t,t[a],a))||n!=n);)n=void 0;for(;s>++a;)null!=(i=e.call(t,t[a],a))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},d3.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(t,e){var n=arguments.length;2>n&&(e=1),1>n&&(t=0);var i=d3.random.normal();return function(){return Math.exp(t+e*i())}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e/t}}},d3.sum=function(t,e){var n,i=0,r=t.length,a=-1;if(1===arguments.length)for(;r>++a;)isNaN(n=+t[a])||(i+=n);else for(;r>++a;)isNaN(n=+e.call(t,t[a],a))||(i+=n);return i},d3.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=t[i-1],a=n-i;return a?r+a*(t[i]-r):r},d3.transpose=function(t){return d3.zip.apply(d3,t)},d3.zip=function(){if(!(i=arguments.length))return[];for(var t=-1,e=d3.min(arguments,u),n=Array(e);e>++t;)for(var i,r=-1,a=n[t]=Array(i);i>++r;)a[r]=arguments[r][t];return n},d3.bisector=function(t){return{left:function(e,n,i,r){for(3>arguments.length&&(i=0),4>arguments.length&&(r=e.length);r>i;){var a=i+r>>>1;n>t.call(e,e[a],a)?i=a+1:r=a}return i},right:function(e,n,i,r){for(3>arguments.length&&(i=0),4>arguments.length&&(r=e.length);r>i;){var a=i+r>>>1;t.call(e,e[a],a)>n?r=a:i=a+1}return i}}};var Gr=d3.bisector(function(t){return t});d3.bisectLeft=Gr.left,d3.bisect=d3.bisectRight=Gr.right,d3.first=function(t,e){var n,i=0,r=t.length,a=t[0];for(1===arguments.length&&(e=d3.ascending);r>++i;)e.call(t,a,n=t[i])>0&&(a=n);return a},d3.last=function(t,e){var n,i=0,r=t.length,a=t[0];for(1===arguments.length&&(e=d3.ascending);r>++i;)0>=e.call(t,a,n=t[i])&&(a=n);return a},d3.nest=function(){function t(e,o){if(o>=s.length)return r?r.call(a,e):n?e.sort(n):e;for(var l,c,u,h=-1,d=e.length,f=s[o++],p=new i,g={};d>++h;)(u=p.get(l=f(c=e[h])))?u.push(c):p.set(l,[c]);return p.forEach(function(e,n){g[e]=t(n,o)}),g}function e(t,n){if(n>=s.length)return t;var i,r=[],a=o[n++];for(i in t)r.push({key:i,values:e(t[i],n)});return a&&r.sort(function(t,e){return a(t.key,e.key)}),r}var n,r,a={},s=[],o=[];return a.map=function(e){return t(e,0)},a.entries=function(n){return e(t(n,0),0)},a.key=function(t){return s.push(t),a},a.sortKeys=function(t){return o[s.length-1]=t,a},a.sortValues=function(t){return n=t,a},a.rollup=function(t){return r=t,a},a},d3.keys=function(t){var e=[];for(var n in t)e.push(n);return e},d3.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},d3.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},d3.permute=function(t,e){for(var n=[],i=-1,r=e.length;r>++i;)n[i]=t[e[i]];return n},d3.merge=function(t){return Array.prototype.concat.apply([],t)},d3.split=function(t,e){var n,i=[],r=[],a=-1,s=t.length;for(2>arguments.length&&(e=h);s>++a;)e.call(r,n=t[a],a)?r=[]:(r.length||i.push(r),r.push(n));return i},d3.range=function(t,e,n){if(3>arguments.length&&(n=1,2>arguments.length&&(e=t,t=0)),1/0===(e-t)/n)throw Error("infinite range");var i,r=[],a=f(Math.abs(n)),s=-1;if(t*=a,e*=a,n*=a,0>n)for(;(i=t+n*++s)>e;)r.push(i/a);else for(;e>(i=t+n*++s);)r.push(i/a);return r},d3.requote=function(t){return t.replace(Jr,"\\$&")};var Jr=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;d3.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},d3.xhr=function(t,e,n){var i=new XMLHttpRequest;3>arguments.length?(n=e,e=null):e&&i.overrideMimeType&&i.overrideMimeType(e),i.open("GET",t,!0),e&&i.setRequestHeader("Accept",e),i.onreadystatechange=function(){if(4===i.readyState){var t=i.status;n(!t&&i.response||t>=200&&300>t||304===t?i:null)}},i.send(null)},d3.text=function(t,e,n){function i(t){n(t&&t.responseText)}3>arguments.length&&(n=e,e=null),d3.xhr(t,e,i)},d3.json=function(t,e){d3.text(t,"application/json",function(t){e(t?JSON.parse(t):null)})},d3.html=function(t,e){d3.text(t,"text/html",function(t){if(null!=t){var n=document.createRange();n.selectNode(document.body),t=n.createContextualFragment(t)}e(t)})},d3.xml=function(t,e,n){function i(t){n(t&&t.responseXML)}3>arguments.length&&(n=e,e=null),d3.xhr(t,e,i)};var Kr={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};d3.ns={prefix:Kr,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.substring(0,e),t=t.substring(e+1)),Kr.hasOwnProperty(n)?{space:Kr[n],local:t}:t}},d3.dispatch=function(){for(var t=new p,e=-1,n=arguments.length;n>++e;)t[arguments[e]]=g(t);return t},p.prototype.on=function(t,e){var n=t.indexOf("."),i="";return n>0&&(i=t.substring(n+1),t=t.substring(0,n)),2>arguments.length?this[t].on(i):this[t].on(i,e)},d3.format=function(t){var e=Qr.exec(t),n=e[1]||" ",i=e[3]||"",r=e[5],a=+e[6],s=e[7],o=e[8],l=e[9],c=1,u="",h=!1;switch(o&&(o=+o.substring(1)),r&&(n="0",s&&(a-=Math.floor((a-1)/4))),l){case"n":s=!0,l="g";break;case"%":c=100,u="%",l="f";break;case"p":c=100,u="%",l="r";break;case"d":h=!0,o=0;break;case"s":c=-1,l="r"}return"r"!=l||o||(l="g"),l=ta.get(l)||v,function(t){if(h&&t%1)return"";var e=0>t&&(t=-t)?"-":i;if(0>c){var d=d3.formatPrefix(t,o);t=d.scale(t),u=d.symbol}else t*=c;if(t=l(t,o),r){var f=t.length+e.length;a>f&&(t=Array(a-f+1).join(n)+t),s&&(t=y(t)),t=e+t}else{s&&(t=y(t)),t=e+t;var f=t.length;a>f&&(t=Array(a-f+1).join(n)+t)}return t+u}};var Qr=/(?:([^{])?([<>=^]))?([+\- ])?(#)?(0)?([0-9]+)?(,)?(\.[0-9]+)?([a-zA-Z%])?/,ta=d3.map({g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return d3.round(t,e=m(t,e)).toFixed(Math.max(0,Math.min(20,e)))}}),ea=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(b);d3.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=d3.round(t,m(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((0>=n?n+1:n-1)/3)))),ea[8+n/3]};var na=_(2),ia=_(3),ra=function(){return S},aa=d3.map({linear:ra,poly:_,quad:function(){return na},cubic:function(){return ia},sin:function(){return A},exp:function(){return C},circle:function(){return M},elastic:k,back:O,bounce:function(){return D}}),sa=d3.map({"in":S,out:w,"in-out":T,"out-in":function(t){return T(w(t))}});d3.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.substring(0,e):t,i=e>=0?t.substring(e+1):"in";return n=aa.get(n)||ra,i=sa.get(i)||S,x(i(n.apply(null,Array.prototype.slice.call(arguments,1))))},d3.event=null,d3.transform=function(t){var e=document.createElementNS(d3.ns.prefix.svg,"g");return(d3.transform=function(t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate();return new U(n?n.matrix:la)})(t)},U.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var oa=180/Math.PI,la={a:1,b:0,c:0,d:1,e:0,f:0};d3.interpolate=function(t,e){for(var n,i=d3.interpolators.length;--i>=0&&!(n=d3.interpolators[i](t,e)););return n},d3.interpolateNumber=function(t,e){return e-=t,function(n){return t+e*n}},d3.interpolateRound=function(t,e){return e-=t,function(n){return Math.round(t+e*n)}},d3.interpolateString=function(t,e){var n,i,r,a,s,o=0,l=0,c=[],u=[];for(ca.lastIndex=0,i=0;n=ca.exec(e);++i)n.index&&c.push(e.substring(o,l=n.index)),u.push({i:c.length,x:n[0]}),c.push(null),o=ca.lastIndex;for(e.length>o&&c.push(e.substring(o)),i=0,a=u.length;(n=ca.exec(t))&&a>i;++i)if(s=u[i],s.x==n[0]){if(s.i)if(null==c[s.i+1])for(c[s.i-1]+=s.x,c.splice(s.i,1),r=i+1;a>r;++r)u[r].i--;else for(c[s.i-1]+=s.x+c[s.i+1],c.splice(s.i,2),r=i+1;a>r;++r)u[r].i-=2;else if(null==c[s.i+1])c[s.i]=s.x;else for(c[s.i]=s.x+c[s.i+1],c.splice(s.i+1,1),r=i+1;a>r;++r)u[r].i--;u.splice(i,1),a--,i--}else s.x=d3.interpolateNumber(parseFloat(n[0]),parseFloat(s.x));for(;a>i;)s=u.pop(),null==c[s.i+1]?c[s.i]=s.x:(c[s.i]=s.x+c[s.i+1],c.splice(s.i+1,1)),a--;return 1===c.length?null==c[0]?u[0].x:function(){return e}:function(t){for(i=0;a>i;++i)c[(s=u[i]).i]=s.x(t);return c.join("")}},d3.interpolateTransform=function(t,e){var n,i=[],r=[],a=d3.transform(t),s=d3.transform(e),o=a.translate,l=s.translate,c=a.rotate,u=s.rotate,h=a.skew,d=s.skew,f=a.scale,p=s.scale;return o[0]!=l[0]||o[1]!=l[1]?(i.push("translate(",null,",",null,")"),r.push({i:1,x:d3.interpolateNumber(o[0],l[0])},{i:3,x:d3.interpolateNumber(o[1],l[1])})):l[0]||l[1]?i.push("translate("+l+")"):i.push(""),c!=u?(c-u>180?u+=360:u-c>180&&(c+=360),r.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:d3.interpolateNumber(c,u)})):u&&i.push(i.pop()+"rotate("+u+")"),h!=d?r.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:d3.interpolateNumber(h,d)}):d&&i.push(i.pop()+"skewX("+d+")"),f[0]!=p[0]||f[1]!=p[1]?(n=i.push(i.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:d3.interpolateNumber(f[0],p[0])},{i:n-2,x:d3.interpolateNumber(f[1],p[1])})):(1!=p[0]||1!=p[1])&&i.push(i.pop()+"scale("+p+")"),n=r.length,function(t){for(var e,a=-1;n>++a;)i[(e=r[a]).i]=e.x(t);return i.join("")}},d3.interpolateRgb=function(t,e){t=d3.rgb(t),e=d3.rgb(e);var n=t.r,i=t.g,r=t.b,a=e.r-n,s=e.g-i,o=e.b-r;return function(t){return"#"+V(Math.round(n+a*t))+V(Math.round(i+s*t))+V(Math.round(r+o*t))}},d3.interpolateHsl=function(t,e){t=d3.hsl(t),e=d3.hsl(e);var n=t.h,i=t.s,r=t.l,a=e.h-n,s=e.s-i,o=e.l-r;return a>180?a-=360:-180>a&&(a+=360),function(t){return K(n+a*t,i+s*t,r+o*t)+""}},d3.interpolateLab=function(t,e){t=d3.lab(t),e=d3.lab(e);var n=t.l,i=t.a,r=t.b,a=e.l-n,s=e.a-i,o=e.b-r;return function(t){return re(n+a*t,i+s*t,r+o*t)+""}},d3.interpolateHcl=function(t,e){t=d3.hcl(t),e=d3.hcl(e);var n=t.h,i=t.c,r=t.l,a=e.h-n,s=e.c-i,o=e.l-r;return a>180?a-=360:-180>a&&(a+=360),function(t){return ee(n+a*t,i+s*t,r+o*t)+""}},d3.interpolateArray=function(t,e){var n,i=[],r=[],a=t.length,s=e.length,o=Math.min(t.length,e.length);for(n=0;o>n;++n)i.push(d3.interpolate(t[n],e[n]));for(;a>n;++n)r[n]=t[n];for(;s>n;++n)r[n]=e[n];return function(t){for(n=0;o>n;++n)r[n]=i[n](t);return r}},d3.interpolateObject=function(t,e){var n,i={},r={};for(n in t)n in e?i[n]=$(n)(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}};var ca=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;d3.interpolators=[d3.interpolateObject,function(t,e){return e instanceof Array&&d3.interpolateArray(t,e)},function(t,e){return("string"==typeof t||"string"==typeof e)&&d3.interpolateString(t+"",e+"")},function(t,e){return("string"==typeof e?ha.has(e)||/^(#|rgb\(|hsl\()/.test(e):e instanceof R)&&d3.interpolateRgb(t,e)},function(t,e){return!isNaN(t=+t)&&!isNaN(e=+e)&&d3.interpolateNumber(t,e)}],R.prototype.toString=function(){return this.rgb()+""},d3.rgb=function(t,e,n){return 1===arguments.length?t instanceof B?H(t.r,t.g,t.b):j(""+t,H,K):H(~~t,~~e,~~n)};var ua=B.prototype=new R;ua.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&r>e&&(e=r),n&&r>n&&(n=r),i&&r>i&&(i=r),H(Math.min(255,Math.floor(e/t)),Math.min(255,Math.floor(n/t)),Math.min(255,Math.floor(i/t)))):H(r,r,r)},ua.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),H(Math.floor(t*this.r),Math.floor(t*this.g),Math.floor(t*this.b))},ua.hsl=function(){return q(this.r,this.g,this.b)},ua.toString=function(){return"#"+V(this.r)+V(this.g)+V(this.b)};var ha=d3.map({aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"});
ha.forEach(function(t,e){ha.set(t,j(e,H,K))}),d3.hsl=function(t,e,n){return 1===arguments.length?t instanceof J?G(t.h,t.s,t.l):j(""+t,q,G):G(+t,+e,+n)};var da=J.prototype=new R;da.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),G(this.h,this.s,this.l/t)},da.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),G(this.h,this.s,t*this.l)},da.rgb=function(){return K(this.h,this.s,this.l)},d3.hcl=function(t,e,n){return 1===arguments.length?t instanceof te?Q(t.h,t.c,t.l):t instanceof ie?ae(t.l,t.a,t.b):ae((t=Z((t=d3.rgb(t)).r,t.g,t.b)).l,t.a,t.b):Q(+t,+e,+n)};var fa=te.prototype=new R;fa.brighter=function(t){return Q(this.h,this.c,Math.min(100,this.l+pa*(arguments.length?t:1)))},fa.darker=function(t){return Q(this.h,this.c,Math.max(0,this.l-pa*(arguments.length?t:1)))},fa.rgb=function(){return ee(this.h,this.c,this.l).rgb()},d3.lab=function(t,e,n){return 1===arguments.length?t instanceof ie?ne(t.l,t.a,t.b):t instanceof te?ee(t.l,t.c,t.h):Z((t=d3.rgb(t)).r,t.g,t.b):ne(+t,+e,+n)};var pa=18,ga=.95047,ma=1,va=1.08883,ya=ie.prototype=new R;ya.brighter=function(t){return ne(Math.min(100,this.l+pa*(arguments.length?t:1)),this.a,this.b)},ya.darker=function(t){return ne(Math.max(0,this.l-pa*(arguments.length?t:1)),this.a,this.b)},ya.rgb=function(){return re(this.l,this.a,this.b)};var ba=function(t,e){return e.querySelector(t)},xa=function(t,e){return e.querySelectorAll(t)},wa=document.documentElement,Ta=wa.matchesSelector||wa.webkitMatchesSelector||wa.mozMatchesSelector||wa.msMatchesSelector||wa.oMatchesSelector,Sa=function(t,e){return Ta.call(t,e)};"function"==typeof Sizzle&&(ba=function(t,e){return Sizzle(t,e)[0]||null},xa=function(t,e){return Sizzle.uniqueSort(Sizzle(t,e))},Sa=Sizzle.matchesSelector);var _a=[];d3.selection=function(){return Aa},d3.selection.prototype=_a,_a.select=function(t){var e,n,i,r,a=[];"function"!=typeof t&&(t=ue(t));for(var s=-1,o=this.length;o>++s;){a.push(e=[]),e.parentNode=(i=this[s]).parentNode;for(var l=-1,c=i.length;c>++l;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return ce(a)},_a.selectAll=function(t){var e,n,i=[];"function"!=typeof t&&(t=he(t));for(var r=-1,a=this.length;a>++r;)for(var s=this[r],o=-1,l=s.length;l>++o;)(n=s[o])&&(i.push(e=jr(t.call(n,n.__data__,o))),e.parentNode=n);return ce(i)},_a.attr=function(t,e){if(2>arguments.length){if("string"==typeof t){var n=this.node();return t=d3.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(de(e,t[e]));return this}return this.each(de(t,e))},_a.classed=function(t,e){if(2>arguments.length){if("string"==typeof t){var n=this.node(),i=(t=t.trim().split(/^|\s+/g)).length,r=-1;if(e=n.classList){for(;i>++r;)if(!e.contains(t[r]))return!1}else for(e=n.className,null!=e.baseVal&&(e=e.baseVal);i>++r;)if(!fe(t[r]).test(e))return!1;return!0}for(e in t)this.each(pe(e,t[e]));return this}return this.each(pe(t,e))},_a.style=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.each(me(n,t[n],e));return this}if(2>i)return window.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(me(t,e,n))},_a.property=function(t,e){if(2>arguments.length){if("string"==typeof t)return this.node()[t];for(e in t)this.each(ve(e,t[e]));return this}return this.each(ve(t,e))},_a.text=function(t){return 1>arguments.length?this.node().textContent:this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t})},_a.html=function(t){return 1>arguments.length?this.node().innerHTML:this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t})},_a.append=function(t){function e(){return this.appendChild(document.createElementNS(this.namespaceURI,t))}function n(){return this.appendChild(document.createElementNS(t.space,t.local))}return t=d3.ns.qualify(t),this.select(t.local?n:e)},_a.insert=function(t,e){function n(){return this.insertBefore(document.createElementNS(this.namespaceURI,t),ba(e,this))}function i(){return this.insertBefore(document.createElementNS(t.space,t.local),ba(e,this))}return t=d3.ns.qualify(t),this.select(t.local?i:n)},_a.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},_a.data=function(t,e){function n(t,n){var r,a,s,o=t.length,h=n.length,d=Math.min(o,h),f=Math.max(o,h),p=[],g=[],m=[];if(e){var v,y=new i,b=[],x=n.length;for(r=-1;o>++r;)v=e.call(a=t[r],a.__data__,r),y.has(v)?m[x++]=a:y.set(v,a),b.push(v);for(r=-1;h>++r;)v=e.call(n,s=n[r],r),y.has(v)?(p[r]=a=y.get(v),a.__data__=s,g[r]=m[r]=null):(g[r]=ye(s),p[r]=m[r]=null),y.remove(v);for(r=-1;o>++r;)y.has(b[r])&&(m[r]=t[r])}else{for(r=-1;d>++r;)a=t[r],s=n[r],a?(a.__data__=s,p[r]=a,g[r]=m[r]=null):(g[r]=ye(s),p[r]=m[r]=null);for(;h>r;++r)g[r]=ye(n[r]),p[r]=m[r]=null;for(;f>r;++r)m[r]=t[r],g[r]=p[r]=null}g.update=p,g.parentNode=p.parentNode=m.parentNode=t.parentNode,l.push(g),c.push(p),u.push(m)}var r,a,s=-1,o=this.length;if(!arguments.length){for(t=Array(o=(r=this[0]).length);o>++s;)(a=r[s])&&(t[s]=a.__data__);return t}var l=Se([]),c=ce([]),u=ce([]);if("function"==typeof t)for(;o>++s;)n(r=this[s],t.call(r,r.parentNode.__data__,s));else for(;o>++s;)n(r=this[s],t);return c.enter=function(){return l},c.exit=function(){return u},c},_a.datum=_a.map=function(t){return 1>arguments.length?this.property("__data__"):this.property("__data__",t)},_a.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=be(t));for(var a=0,s=this.length;s>a;a++){r.push(e=[]),e.parentNode=(n=this[a]).parentNode;for(var o=0,l=n.length;l>o;o++)(i=n[o])&&t.call(i,i.__data__,o)&&e.push(i)}return ce(r)},_a.order=function(){for(var t=-1,e=this.length;e>++t;)for(var n,i=this[t],r=i.length-1,a=i[r];--r>=0;)(n=i[r])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this},_a.sort=function(t){t=xe.apply(this,arguments);for(var e=-1,n=this.length;n>++e;)this[e].sort(t);return this.order()},_a.on=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(n in t)this.each(we(n,t[n],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(we(t,e,n))},_a.each=function(t){return Te(this,function(e,n,i){t.call(e,e.__data__,n,i)})},_a.call=function(t){return t.apply(this,(arguments[0]=this,arguments)),this},_a.empty=function(){return!this.node()},_a.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],i=0,r=n.length;r>i;i++){var a=n[i];if(a)return a}return null},_a.transition=function(){for(var t,e,n=[],i=-1,r=this.length;r>++i;){n.push(t=[]);for(var a=this[i],s=-1,o=a.length;o>++s;)t.push((e=a[s])?{node:e,delay:Ya,duration:Ua}:null)}return _e(n,Oa||++ka,Date.now())};var Aa=ce([[document]]);Aa[0].parentNode=wa,d3.select=function(t){return"string"==typeof t?Aa.select(t):ce([[t]])},d3.selectAll=function(t){return"string"==typeof t?Aa.selectAll(t):ce([jr(t)])};var Ca=[];d3.selection.enter=Se,d3.selection.enter.prototype=Ca,Ca.append=_a.append,Ca.insert=_a.insert,Ca.empty=_a.empty,Ca.node=_a.node,Ca.select=function(t){for(var e,n,i,r,a,s=[],o=-1,l=this.length;l>++o;){i=(r=this[o]).update,s.push(e=[]),e.parentNode=r.parentNode;for(var c=-1,u=r.length;u>++c;)(a=r[c])?(e.push(i[c]=n=t.call(r.parentNode,a.__data__,c)),n.__data__=a.__data__):e.push(null)}return ce(s)};var Ma=[],ka=0,Oa=0,Da=0,Pa=250,Ea=d3.ease("cubic-in-out"),Ya=Da,Ua=Pa,za=Ea;Ma.call=_a.call,d3.transition=function(t){return arguments.length?Oa?t.transition():t:Aa.transition()},d3.transition.prototype=Ma,Ma.select=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=ue(t));for(var a=-1,s=this.length;s>++a;){r.push(e=[]);for(var o=this[a],l=-1,c=o.length;c>++l;)(i=o[l])&&(n=t.call(i.node,i.node.__data__,l))?("__data__"in i.node&&(n.__data__=i.node.__data__),e.push({node:n,delay:i.delay,duration:i.duration})):e.push(null)}return _e(r,this.id,this.time).ease(this.ease())},Ma.selectAll=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=he(t));for(var a=-1,s=this.length;s>++a;)for(var o=this[a],l=-1,c=o.length;c>++l;)if(i=o[l]){n=t.call(i.node,i.node.__data__,l),r.push(e=[]);for(var u=-1,h=n.length;h>++u;)e.push({node:n[u],delay:i.delay,duration:i.duration})}return _e(r,this.id,this.time).ease(this.ease())},Ma.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=be(t));for(var a=0,s=this.length;s>a;a++){r.push(e=[]);for(var n=this[a],o=0,l=n.length;l>o;o++)(i=n[o])&&t.call(i.node,i.node.__data__,o)&&e.push(i)}return _e(r,this.id,this.time).ease(this.ease())},Ma.attr=function(t,e){if(2>arguments.length){for(e in t)this.attrTween(e,Me(t[e],e));return this}return this.attrTween(t,Me(e,t))},Ma.attrTween=function(t,e){function n(t,n){var i=e.call(this,t,n,this.getAttribute(r));return i===$a?(this.removeAttribute(r),null):i&&function(t){this.setAttribute(r,i(t))}}function i(t,n){var i=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return i===$a?(this.removeAttributeNS(r.space,r.local),null):i&&function(t){this.setAttributeNS(r.space,r.local,i(t))}}var r=d3.ns.qualify(t);return this.tween("attr."+t,r.local?i:n)},Ma.style=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.styleTween(n,Me(t[n],n),e);return this}n=""}return this.styleTween(t,Me(e,t),n)},Ma.styleTween=function(t,e,n){return 3>arguments.length&&(n=""),this.tween("style."+t,function(i,r){var a=e.call(this,i,r,window.getComputedStyle(this,null).getPropertyValue(t));return a===$a?(this.style.removeProperty(t),null):a&&function(e){this.style.setProperty(t,a(e),n)}})},Ma.text=function(t){return this.tween("text",function(e,n){this.textContent="function"==typeof t?t.call(this,e,n):t})},Ma.remove=function(){return this.each("end.transition",function(){var t;!this.__transition__&&(t=this.parentNode)&&t.removeChild(this)})},Ma.delay=function(t){return Te(this,"function"==typeof t?function(e,n,i){e.delay=0|t.call(e=e.node,e.__data__,n,i)}:(t=0|t,function(e){e.delay=t}))},Ma.duration=function(t){return Te(this,"function"==typeof t?function(e,n,i){e.duration=Math.max(1,0|t.call(e=e.node,e.__data__,n,i))}:(t=Math.max(1,0|t),function(e){e.duration=t}))},Ma.transition=function(){return this.select(a)},d3.tween=function(t,e){function n(n,i,r){var a=t.call(this,n,i);return null==a?""!=r&&$a:r!=a&&e(r,a+"")}function i(n,i,r){return r!=t&&e(r,t)}return"function"==typeof t?n:null==t?Ce:(t+="",i)};var Fa,La,$a={},Ia=0,Na={},Ra=null;d3.timer=function(t,e,n){if(3>arguments.length){if(2>arguments.length)e=0;else if(!isFinite(e))return;n=Date.now()}var i=Na[t.id];i&&i.callback===t?(i.then=n,i.delay=e):Na[t.id=++Ia]=Ra={callback:t,then:n,delay:e,next:Ra},Fa||(La=clearTimeout(La),Fa=1,Ha(ke))},d3.timer.flush=function(){for(var t,e=Date.now(),n=Ra;n;)t=e-n.then,n.delay||(n.flush=n.callback(t)),n=n.next;Oe()};var Ha=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){setTimeout(t,17)};d3.mouse=function(t){return De(t,E())};var Ba=/WebKit/.test(navigator.userAgent)?-1:0;d3.touches=function(t,e){return 2>arguments.length&&(e=E().touches),e?jr(e).map(function(e){var n=De(t,e);return n.identifier=e.identifier,n}):[]},d3.scale={},d3.scale.linear=function(){return ze([0,1],[0,1],d3.interpolate,!1)},d3.scale.log=function(){return Be(d3.scale.linear(),Ve)};var Va=d3.format(".0e");Ve.pow=function(t){return Math.pow(10,t)},je.pow=function(t){return-Math.pow(10,-t)},d3.scale.pow=function(){return qe(d3.scale.linear(),1)},d3.scale.sqrt=function(){return d3.scale.pow().exponent(.5)},d3.scale.ordinal=function(){return We([],{t:"range",a:[[]]})},d3.scale.category10=function(){return d3.scale.ordinal().range(ja)},d3.scale.category20=function(){return d3.scale.ordinal().range(qa)},d3.scale.category20b=function(){return d3.scale.ordinal().range(Za)},d3.scale.category20c=function(){return d3.scale.ordinal().range(Wa)};var ja=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],qa=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],Za=["#393b79","#5254a3","#6b6ecf","#9c9ede","#637939","#8ca252","#b5cf6b","#cedb9c","#8c6d31","#bd9e39","#e7ba52","#e7cb94","#843c39","#ad494a","#d6616b","#e7969c","#7b4173","#a55194","#ce6dbd","#de9ed6"],Wa=["#3182bd","#6baed6","#9ecae1","#c6dbef","#e6550d","#fd8d3c","#fdae6b","#fdd0a2","#31a354","#74c476","#a1d99b","#c7e9c0","#756bb1","#9e9ac8","#bcbddc","#dadaeb","#636363","#969696","#bdbdbd","#d9d9d9"];d3.scale.quantile=function(){return Xe([],[])},d3.scale.quantize=function(){return Ge(0,1,[0,1])},d3.scale.threshold=function(){return Je([.5],[0,1])},d3.scale.identity=function(){return Ke([0,1])},d3.svg={},d3.svg.arc=function(){function t(){var t=e.apply(this,arguments),a=n.apply(this,arguments),s=i.apply(this,arguments)+Xa,o=r.apply(this,arguments)+Xa,l=(s>o&&(l=s,s=o,o=l),o-s),c=Math.PI>l?"0":"1",u=Math.cos(s),h=Math.sin(s),d=Math.cos(o),f=Math.sin(o);return l>=Ga?t?"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z":t?"M"+a*u+","+a*h+"A"+a+","+a+" 0 "+c+",1 "+a*d+","+a*f+"L"+t*d+","+t*f+"A"+t+","+t+" 0 "+c+",0 "+t*u+","+t*h+"Z":"M"+a*u+","+a*h+"A"+a+","+a+" 0 "+c+",1 "+a*d+","+a*f+"L0,0"+"Z"}var e=Qe,n=tn,i=en,r=nn;return t.innerRadius=function(n){return arguments.length?(e=o(n),t):e},t.outerRadius=function(e){return arguments.length?(n=o(e),t):n},t.startAngle=function(e){return arguments.length?(i=o(e),t):i},t.endAngle=function(e){return arguments.length?(r=o(e),t):r},t.centroid=function(){var t=(e.apply(this,arguments)+n.apply(this,arguments))/2,a=(i.apply(this,arguments)+r.apply(this,arguments))/2+Xa;return[Math.cos(a)*t,Math.sin(a)*t]},t};var Xa=-Math.PI/2,Ga=2*Math.PI-1e-6;d3.svg.line=function(){return rn(r)};var Ja=d3.map({linear:on,"linear-closed":ln,"step-before":cn,"step-after":un,basis:mn,"basis-open":vn,"basis-closed":yn,bundle:bn,cardinal:fn,"cardinal-open":hn,"cardinal-closed":dn,monotone:An});Ja.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Ka=[0,2/3,1/3,0],Qa=[0,1/3,2/3,0],ts=[0,1/6,2/3,1/6];d3.svg.line.radial=function(){var t=rn(Cn);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},cn.reverse=un,un.reverse=cn,d3.svg.area=function(){return Mn(r)},d3.svg.area.radial=function(){var t=Mn(Cn);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},d3.svg.chord=function(){function t(t,o){var l=e(this,a,t,o),c=e(this,s,t,o);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,c)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,c.r,c.p0)+i(c.r,c.p1,c.a1-c.a0)+r(c.r,c.p1,l.r,l.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),a=l.call(t,r,i),s=c.call(t,r,i)+Xa,o=u.call(t,r,i)+Xa;return{r:a,a0:s,a1:o,p0:[a*Math.cos(s),a*Math.sin(s)],p1:[a*Math.cos(o),a*Math.sin(o)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Math.PI)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var a=kn,s=On,l=Dn,c=en,u=nn;return t.radius=function(e){return arguments.length?(l=o(e),t):l},t.source=function(e){return arguments.length?(a=o(e),t):a},t.target=function(e){return arguments.length?(s=o(e),t):s},t.startAngle=function(e){return arguments.length?(c=o(e),t):c},t.endAngle=function(e){return arguments.length?(u=o(e),t):u},t},d3.svg.diagonal=function(){function t(t,r){var a=e.call(this,t,r),s=n.call(this,t,r),o=(a.y+s.y)/2,l=[a,{x:a.x,y:o},{x:s.x,y:o},s];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=kn,n=On,i=Pn;return t.source=function(n){return arguments.length?(e=o(n),t):e},t.target=function(e){return arguments.length?(n=o(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},d3.svg.diagonal.radial=function(){var t=d3.svg.diagonal(),e=Pn,n=t.projection;return t.projection=function(t){return arguments.length?n(En(e=t)):e},t},d3.svg.mouse=d3.mouse,d3.svg.touches=d3.touches,d3.svg.symbol=function(){function t(t,i){return(es.get(e.call(this,t,i))||zn)(n.call(this,t,i))}var e=Un,n=Yn;return t.type=function(n){return arguments.length?(e=o(n),t):e},t.size=function(e){return arguments.length?(n=o(e),t):n},t};var es=d3.map({circle:zn,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*is)),n=e*is;return"M0,"+-e+"L"+n+",0"+" 0,"+e+" "+-n+",0"+"Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/ns),n=e*ns/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/ns),n=e*ns/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});d3.svg.symbolTypes=es.keys();var ns=Math.sqrt(3),is=Math.tan(30*Math.PI/180);d3.svg.axis=function(){function t(t){t.each(function(){var t,h=d3.select(this),d=null==c?n.ticks?n.ticks.apply(n,l):n.domain():c,f=null==e?n.tickFormat?n.tickFormat.apply(n,l):String:e,p=$n(n,d,u),g=h.selectAll(".minor").data(p,String),m=g.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),v=d3.transition(g.exit()).style("opacity",1e-6).remove(),y=d3.transition(g).style("opacity",1),b=h.selectAll("g").data(d,String),x=b.enter().insert("g","path").style("opacity",1e-6),w=d3.transition(b.exit()).style("opacity",1e-6).remove(),T=d3.transition(b).style("opacity",1),S=Ee(n),_=h.selectAll(".domain").data([0]),A=(_.enter().append("path").attr("class","domain"),d3.transition(_)),C=n.copy(),M=this.__chart__||C;this.__chart__=C,x.append("line").attr("class","tick"),x.append("text");var k=x.select("line"),O=T.select("line"),D=b.select("text").text(f),P=x.select("text"),E=T.select("text");switch(i){case"bottom":t=Fn,m.attr("y2",a),y.attr("x2",0).attr("y2",a),k.attr("y2",r),P.attr("y",Math.max(r,0)+o),O.attr("x2",0).attr("y2",r),E.attr("x",0).attr("y",Math.max(r,0)+o),D.attr("dy",".71em").attr("text-anchor","middle"),A.attr("d","M"+S[0]+","+s+"V0H"+S[1]+"V"+s);break;case"top":t=Fn,m.attr("y2",-a),y.attr("x2",0).attr("y2",-a),k.attr("y2",-r),P.attr("y",-(Math.max(r,0)+o)),O.attr("x2",0).attr("y2",-r),E.attr("x",0).attr("y",-(Math.max(r,0)+o)),D.attr("dy","0em").attr("text-anchor","middle"),A.attr("d","M"+S[0]+","+-s+"V0H"+S[1]+"V"+-s);break;case"left":t=Ln,m.attr("x2",-a),y.attr("x2",-a).attr("y2",0),k.attr("x2",-r),P.attr("x",-(Math.max(r,0)+o)),O.attr("x2",-r).attr("y2",0),E.attr("x",-(Math.max(r,0)+o)).attr("y",0),D.attr("dy",".32em").attr("text-anchor","end"),A.attr("d","M"+-s+","+S[0]+"H0V"+S[1]+"H"+-s);break;case"right":t=Ln,m.attr("x2",a),y.attr("x2",a).attr("y2",0),k.attr("x2",r),P.attr("x",Math.max(r,0)+o),O.attr("x2",r).attr("y2",0),E.attr("x",Math.max(r,0)+o).attr("y",0),D.attr("dy",".32em").attr("text-anchor","start"),A.attr("d","M"+s+","+S[0]+"H0V"+S[1]+"H"+s)}if(n.ticks)x.call(t,M),T.call(t,C),w.call(t,C),m.call(t,M),y.call(t,C),v.call(t,C);else{var Y=C.rangeBand()/2,U=function(t){return C(t)+Y};x.call(t,U),T.call(t,U)}})}var e,n=d3.scale.linear(),i="bottom",r=6,a=6,s=6,o=3,l=[10],c=null,u=0;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e,t):i},t.ticks=function(){return arguments.length?(l=arguments,t):l},t.tickValues=function(e){return arguments.length?(c=e,t):c},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e,n){if(!arguments.length)return r;var i=arguments.length-1;return r=+e,a=i>1?+n:r,s=i>0?+arguments[i]:r,t},t.tickPadding=function(e){return arguments.length?(o=+e,t):o},t.tickSubdivide=function(e){return arguments.length?(u=+e,t):u},t},d3.svg.brush=function(){function t(a){a.each(function(){var a,s=d3.select(this),u=s.selectAll(".background").data([0]),h=s.selectAll(".extent").data([0]),d=s.selectAll(".resize").data(c,String);s.style("pointer-events","all").on("mousedown.brush",r).on("touchstart.brush",r),u.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),h.enter().append("rect").attr("class","extent").style("cursor","move"),d.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return rs[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),d.style("display",t.empty()?"none":null),d.exit().remove(),o&&(a=Ee(o),u.attr("x",a[0]).attr("width",a[1]-a[0]),n(s)),l&&(a=Ee(l),u.attr("y",a[0]).attr("height",a[1]-a[0]),i(s)),e(s)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+u[+/e$/.test(t)][0]+","+u[+/^s/.test(t)][1]+")"})}function n(t){t.select(".extent").attr("x",u[0][0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",u[1][0]-u[0][0])}function i(t){t.select(".extent").attr("y",u[0][1]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",u[1][1]-u[0][1])}function r(){function r(){var t=d3.event.changedTouches;return t?d3.touches(v,t)[0]:d3.mouse(v)}function c(){32==d3.event.keyCode&&(_||(g=null,A[0]-=u[1][0],A[1]-=u[1][1],_=2),P())}function h(){32==d3.event.keyCode&&2==_&&(A[0]+=u[1][0],A[1]+=u[1][1],_=0,P())}function d(){var t=r(),a=!1;m&&(t[0]+=m[0],t[1]+=m[1]),_||(d3.event.altKey?(g||(g=[(u[0][0]+u[1][0])/2,(u[0][1]+u[1][1])/2]),A[0]=u[+(t[0]<g[0])][0],A[1]=u[+(t[1]<g[1])][1]):g=null),T&&f(t,o,0)&&(n(x),a=!0),S&&f(t,l,1)&&(i(x),a=!0),a&&(e(x),b({type:"brush",mode:_?"move":"resize"}))}function f(t,e,n){var i,r,s=Ee(e),o=s[0],l=s[1],c=A[n],h=u[1][n]-u[0][n];return _&&(o-=c,l-=h+c),i=Math.max(o,Math.min(l,t[n])),_?r=(i+=c)+h:(g&&(c=Math.max(o,Math.min(l,2*g[n]-i))),i>c?(r=i,i=c):r=c),u[0][n]!==i||u[1][n]!==r?(a=null,u[0][n]=i,u[1][n]=r,!0):void 0}function p(){d(),x.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),d3.select("body").style("cursor",null),C.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),b({type:"brushend"}),P()}var g,m,v=this,y=d3.select(d3.event.target),b=s.of(v,arguments),x=d3.select(v),w=y.datum(),T=!/^(n|s)$/.test(w)&&o,S=!/^(e|w)$/.test(w)&&l,_=y.classed("extent"),A=r(),C=d3.select(window).on("mousemove.brush",d).on("mouseup.brush",p).on("touchmove.brush",d).on("touchend.brush",p).on("keydown.brush",c).on("keyup.brush",h);if(_)A[0]=u[0][0]-A[0],A[1]=u[0][1]-A[1];else if(w){var M=+/w$/.test(w),k=+/^n/.test(w);m=[u[1-M][0]-A[0],u[1-k][1]-A[1]],A[0]=u[M][0],A[1]=u[k][1]}else d3.event.altKey&&(g=A.slice());x.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",y.style("cursor")),b({type:"brushstart"}),d(),P()}var a,s=Y(t,"brushstart","brush","brushend"),o=null,l=null,c=as[0],u=[[0,0],[0,0]];return t.x=function(e){return arguments.length?(o=e,c=as[!o<<1|!l],t):o},t.y=function(e){return arguments.length?(l=e,c=as[!o<<1|!l],t):l},t.extent=function(e){var n,i,r,s,c;return arguments.length?(a=[[0,0],[0,0]],o&&(n=e[0],i=e[1],l&&(n=n[0],i=i[0]),a[0][0]=n,a[1][0]=i,o.invert&&(n=o(n),i=o(i)),n>i&&(c=n,n=i,i=c),u[0][0]=0|n,u[1][0]=0|i),l&&(r=e[0],s=e[1],o&&(r=r[1],s=s[1]),a[0][1]=r,a[1][1]=s,l.invert&&(r=l(r),s=l(s)),r>s&&(c=r,r=s,s=c),u[0][1]=0|r,u[1][1]=0|s),t):(e=a||u,o&&(n=e[0][0],i=e[1][0],a||(n=u[0][0],i=u[1][0],o.invert&&(n=o.invert(n),i=o.invert(i)),n>i&&(c=n,n=i,i=c))),l&&(r=e[0][1],s=e[1][1],a||(r=u[0][1],s=u[1][1],l.invert&&(r=l.invert(r),s=l.invert(s)),r>s&&(c=r,r=s,s=c))),o&&l?[[n,r],[i,s]]:o?[n,i]:l&&[r,s])},t.clear=function(){return a=null,u[0][0]=u[0][1]=u[1][0]=u[1][1]=0,t},t.empty=function(){return o&&u[0][0]===u[1][0]||l&&u[0][1]===u[1][1]},d3.rebind(t,s,"on")};var rs={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},as=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];d3.behavior={},d3.behavior.drag=function(){function t(){this.on("mousedown.drag",e).on("touchstart.drag",e)}function e(){function t(){var t=o.parentNode;return u?d3.touches(t).filter(function(t){return t.identifier===u})[0]:d3.mouse(t)}function e(){if(!o.parentNode)return r();var e=t(),n=e[0]-h[0],i=e[1]-h[1];d|=n|i,h=e,P(),l({type:"drag",x:e[0]+s[0],y:e[1]+s[1],dx:n,dy:i})}function r(){l({type:"dragend"}),d&&(P(),d3.event.target===c&&f.on("click.drag",a,!0)),f.on(u?"touchmove.drag-"+u:"mousemove.drag",null).on(u?"touchend.drag-"+u:"mouseup.drag",null)}function a(){P(),f.on("click.drag",null)}var s,o=this,l=n.of(o,arguments),c=d3.event.target,u=d3.event.touches&&d3.event.changedTouches[0].identifier,h=t(),d=0,f=d3.select(window).on(u?"touchmove.drag-"+u:"mousemove.drag",e).on(u?"touchend.drag-"+u:"mouseup.drag",r,!0);i?(s=i.apply(o,arguments),s=[s.x-h[0],s.y-h[1]]):s=[0,0],u||P(),l({type:"dragstart"})}var n=Y(t,"drag","dragstart","dragend"),i=null;return t.origin=function(e){return arguments.length?(i=e,t):i},d3.rebind(t,n,"on")},d3.behavior.zoom=function(){function t(){this.on("mousedown.zoom",s).on("mousewheel.zoom",o).on("mousemove.zoom",l).on("DOMMouseScroll.zoom",o).on("dblclick.zoom",c).on("touchstart.zoom",u).on("touchmove.zoom",h).on("touchend.zoom",u)}function e(t){return[(t[0]-b[0])/x,(t[1]-b[1])/x]}function n(t){return[t[0]*x+b[0],t[1]*x+b[1]]}function i(t){x=Math.max(w[0],Math.min(w[1],t))}function r(t,e){e=n(e),b[0]+=t[0]-e[0],b[1]+=t[1]-e[1]}function a(t){g&&g.domain(p.range().map(function(t){return(t-b[0])/x}).map(p.invert)),v&&v.domain(m.range().map(function(t){return(t-b[1])/x}).map(m.invert)),d3.event.preventDefault(),t({type:"zoom",scale:x,translate:b})}function s(){function t(){c=1,r(d3.mouse(s),h),a(o)}function n(){c&&P(),u.on("mousemove.zoom",null).on("mouseup.zoom",null),c&&d3.event.target===l&&u.on("click.zoom",i,!0)}function i(){P(),u.on("click.zoom",null)}var s=this,o=T.of(s,arguments),l=d3.event.target,c=0,u=d3.select(window).on("mousemove.zoom",t).on("mouseup.zoom",n),h=e(d3.mouse(s));window.focus(),P()}function o(){d||(d=e(d3.mouse(this))),i(Math.pow(2,.002*In())*x),r(d3.mouse(this),d),a(T.of(this,arguments))}function l(){d=null}function c(){var t=d3.mouse(this),n=e(t);i(d3.event.shiftKey?x/2:2*x),r(t,n),a(T.of(this,arguments))}function u(){var t=d3.touches(this),n=Date.now();if(f=x,d={},t.forEach(function(t){d[t.identifier]=e(t)}),P(),1===t.length){if(500>n-y){var s=t[0],o=e(t[0]);i(2*x),r(s,o),a(T.of(this,arguments))}y=n}}function h(){var t=d3.touches(this),e=t[0],n=d[e.identifier];if(s=t[1]){var s,o=d[s.identifier];e=[(e[0]+s[0])/2,(e[1]+s[1])/2],n=[(n[0]+o[0])/2,(n[1]+o[1])/2],i(d3.event.scale*f)}r(e,n),y=null,a(T.of(this,arguments))}var d,f,p,g,m,v,y,b=[0,0],x=1,w=os,T=Y(t,"zoom");return t.translate=function(e){return arguments.length?(b=e.map(Number),t):b},t.scale=function(e){return arguments.length?(x=+e,t):x},t.scaleExtent=function(e){return arguments.length?(w=null==e?os:e.map(Number),t):w},t.x=function(e){return arguments.length?(g=e,p=e.copy(),t):g},t.y=function(e){return arguments.length?(v=e,m=e.copy(),t):v},d3.rebind(t,T,"on")};var ss,os=[0,1/0];d3.layout={},d3.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;i>++n;)e.push(Nn(t[n]));return e}},d3.layout.chord=function(){function t(){var t,c,h,d,f,p={},g=[],m=d3.range(a),v=[];for(n=[],i=[],t=0,d=-1;a>++d;){for(c=0,f=-1;a>++f;)c+=r[d][f];g.push(c),v.push(d3.range(a)),t+=c}for(s&&m.sort(function(t,e){return s(g[t],g[e])}),o&&v.forEach(function(t,e){t.sort(function(t,n){return o(r[e][t],r[e][n])})}),t=(2*Math.PI-u*a)/t,c=0,d=-1;a>++d;){for(h=c,f=-1;a>++f;){var y=m[d],b=v[y][f],x=r[y][b],w=c,T=c+=x*t;p[y+"-"+b]={index:y,subindex:b,startAngle:w,endAngle:T,value:x}}i[y]={index:y,startAngle:h,endAngle:c,value:(c-h)/t},c+=u}for(d=-1;a>++d;)for(f=d-1;a>++f;){var S=p[d+"-"+f],_=p[f+"-"+d];(S.value||_.value)&&n.push(S.value<_.value?{source:_,target:S}:{source:S,target:_})}l&&e()}function e(){n.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,a,s,o,l,c={},u=0;return c.matrix=function(t){return arguments.length?(a=(r=t)&&r.length,n=i=null,c):r},c.padding=function(t){return arguments.length?(u=t,n=i=null,c):u},c.sortGroups=function(t){return arguments.length?(s=t,n=i=null,c):s},c.sortSubgroups=function(t){return arguments.length?(o=t,n=null,c):o},c.sortChords=function(t){return arguments.length?(l=t,n&&e(),c):l},c.chords=function(){return n||t(),n},c.groups=function(){return i||t(),i},c},d3.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var a=e.cx-t.x,s=e.cy-t.y,o=1/Math.sqrt(a*a+s*s);if(v>(r-n)*o){var l=e.charge*o*o;return t.px-=a*l,t.py-=s*l,!0}if(e.point&&isFinite(o)){var l=e.pointCharge*o*o;t.px-=a*l,t.py-=s*l}}return!e.charge}}function e(t){t.px=d3.event.x,t.py=d3.event.y,c.resume()}var n,i,a,s,l,c={},u=d3.dispatch("start","tick","end"),h=[1,1],d=.9,f=Wn,p=Xn,g=-30,m=.1,v=.8,y=[],b=[];return c.tick=function(){if(.005>(i*=.99))return u.end({type:"end",alpha:i=0}),!0;var e,n,r,o,c,f,p,v,x,w=y.length,T=b.length;for(n=0;T>n;++n)r=b[n],o=r.source,c=r.target,v=c.x-o.x,x=c.y-o.y,(f=v*v+x*x)&&(f=i*s[n]*((f=Math.sqrt(f))-a[n])/f,v*=f,x*=f,c.x-=v*(p=o.weight/(c.weight+o.weight)),c.y-=x*p,o.x+=v*(p=1-p),o.y+=x*p);if((p=i*m)&&(v=h[0]/2,x=h[1]/2,n=-1,p))for(;w>++n;)r=y[n],r.x+=(v-r.x)*p,r.y+=(x-r.y)*p;if(g)for(Zn(e=d3.geom.quadtree(y),i,l),n=-1;w>++n;)(r=y[n]).fixed||e.visit(t(r));for(n=-1;w>++n;)r=y[n],r.fixed?(r.x=r.px,r.y=r.py):(r.x-=(r.px-(r.px=r.x))*d,r.y-=(r.py-(r.py=r.y))*d);u.tick({type:"tick",alpha:i})},c.nodes=function(t){return arguments.length?(y=t,c):y},c.links=function(t){return arguments.length?(b=t,c):b},c.size=function(t){return arguments.length?(h=t,c):h},c.linkDistance=function(t){return arguments.length?(f=o(t),c):f},c.distance=c.linkDistance,c.linkStrength=function(t){return arguments.length?(p=o(t),c):p},c.friction=function(t){return arguments.length?(d=t,c):d},c.charge=function(t){return arguments.length?(g="function"==typeof t?t:+t,c):g},c.gravity=function(t){return arguments.length?(m=t,c):m},c.theta=function(t){return arguments.length?(v=t,c):v},c.alpha=function(t){return arguments.length?(i?i=t>0?t:0:t>0&&(u.start({type:"start",alpha:i=t}),d3.timer(c.tick)),c):i},c.start=function(){function t(t,i){for(var r,a=e(n),s=-1,o=a.length;o>++s;)if(!isNaN(r=a[s][t]))return r;return Math.random()*i}function e(){if(!r){for(r=[],i=0;u>i;++i)r[i]=[];for(i=0;d>i;++i){var t=b[i];r[t.source.index].push(t.target),r[t.target.index].push(t.source)}}return r[n]}var n,i,r,o,u=y.length,d=b.length,m=h[0],v=h[1];for(n=0;u>n;++n)(o=y[n]).index=n,o.weight=0;for(a=[],s=[],n=0;d>n;++n)o=b[n],"number"==typeof o.source&&(o.source=y[o.source]),"number"==typeof o.target&&(o.target=y[o.target]),a[n]=f.call(this,o,n),s[n]=p.call(this,o,n),++o.source.weight,++o.target.weight;for(n=0;u>n;++n)o=y[n],isNaN(o.x)&&(o.x=t("x",m)),isNaN(o.y)&&(o.y=t("y",v)),isNaN(o.px)&&(o.px=o.x),isNaN(o.py)&&(o.py=o.y);if(l=[],"function"==typeof g)for(n=0;u>n;++n)l[n]=+g.call(this,y[n],n);else for(n=0;u>n;++n)l[n]=g;return c.resume()},c.resume=function(){return c.alpha(.1)},c.stop=function(){return c.alpha(0)},c.drag=function(){n||(n=d3.behavior.drag().origin(r).on("dragstart",Bn).on("drag",e).on("dragend",Vn)),this.on("mouseover.force",jn).on("mouseout.force",qn).call(n)},d3.rebind(c,u,"on")},d3.layout.partition=function(){function t(e,n,i,r){var a=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,a&&(s=a.length)){var s,o,l,c=-1;for(i=e.value?i/e.value:0;s>++c;)t(o=a[c],n,l=o.value*i,r),n+=l}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,a=-1;r>++a;)i=Math.max(i,e(n[a]));
return 1+i}function n(n,a){var s=i.call(this,n,a);return t(s[0],0,r[0],r[1]/e(s[0])),s}var i=d3.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},oi(n,i)},d3.layout.pie=function(){function t(a){var s=a.map(function(n,i){return+e.call(t,n,i)}),o=+("function"==typeof i?i.apply(this,arguments):i),l=(("function"==typeof r?r.apply(this,arguments):r)-i)/d3.sum(s),c=d3.range(a.length);null!=n&&c.sort(n===ls?function(t,e){return s[e]-s[t]}:function(t,e){return n(a[t],a[e])});var u=[];return c.forEach(function(t){var e;u[t]={data:a[t],value:e=s[t],startAngle:o,endAngle:o+=e*l}}),u}var e=Number,n=ls,i=0,r=2*Math.PI;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t};var ls={};d3.layout.stack=function(){function t(r,l){var c=r.map(function(n,i){return e.call(t,n,i)}),u=c.map(function(e){return e.map(function(e,n){return[s.call(t,e,n),o.call(t,e,n)]})}),h=n.call(t,u,l);c=d3.permute(c,h),u=d3.permute(u,h);var d,f,p,g=i.call(t,u,l),m=c.length,v=c[0].length;for(f=0;v>f;++f)for(a.call(t,c[0][f],p=g[f],u[0][f][1]),d=1;m>d;++d)a.call(t,c[d][f],p+=u[d-1][f][1],u[d][f][1]);return r}var e=r,n=Qn,i=ti,a=Kn,s=Gn,o=Jn;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:cs.get(e)||Qn,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:us.get(e)||ti,t):i},t.x=function(e){return arguments.length?(s=e,t):s},t.y=function(e){return arguments.length?(o=e,t):o},t.out=function(e){return arguments.length?(a=e,t):a},t};var cs=d3.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(ei),a=t.map(ni),s=d3.range(i).sort(function(t,e){return r[t]-r[e]}),o=0,l=0,c=[],u=[];for(e=0;i>e;++e)n=s[e],l>o?(o+=a[n],c.push(n)):(l+=a[n],u.push(n));return u.reverse().concat(c)},reverse:function(t){return d3.range(t.length).reverse()},"default":Qn}),us=d3.map({silhouette:function(t){var e,n,i,r=t.length,a=t[0].length,s=[],o=0,l=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];i>o&&(o=i),s.push(i)}for(n=0;a>n;++n)l[n]=(o-s[n])/2;return l},wiggle:function(t){var e,n,i,r,a,s,o,l,c,u=t.length,h=t[0],d=h.length,f=[];for(f[0]=l=c=0,n=1;d>n;++n){for(e=0,r=0;u>e;++e)r+=t[e][n][1];for(e=0,a=0,o=h[n][0]-h[n-1][0];u>e;++e){for(i=0,s=(t[e][n][1]-t[e][n-1][1])/(2*o);e>i;++i)s+=(t[i][n][1]-t[i][n-1][1])/o;a+=s*t[e][n][1]}f[n]=l-=r?a/r*o:0,c>l&&(c=l)}for(n=0;d>n;++n)f[n]-=c;return f},expand:function(t){var e,n,i,r=t.length,a=t[0].length,s=1/r,o=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=s}for(n=0;a>n;++n)o[n]=0;return o},zero:ti});d3.layout.histogram=function(){function t(t,a){for(var s,o,l=[],c=t.map(n,this),u=i.call(this,c,a),h=r.call(this,u,c,a),a=-1,d=c.length,f=h.length-1,p=e?1:1/d;f>++a;)s=l[a]=[],s.dx=h[a+1]-(s.x=h[a]),s.y=0;if(f>0)for(a=-1;d>++a;)o=c[a],o>=u[0]&&u[1]>=o&&(s=l[d3.bisect(h,o,1,f)-1],s.y+=p,s.push(t[a]));return l}var e=!0,n=Number,i=si,r=ri;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=o(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return ai(t,e)}:o(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},d3.layout.hierarchy=function(){function t(e,s,o){var l=r.call(n,e,s),c=hs?e:{data:e};if(c.depth=s,o.push(c),l&&(u=l.length)){for(var u,h,d=-1,f=c.children=[],p=0,g=s+1;u>++d;)h=t(l[d],g,o),h.parent=c,f.push(h),p+=h.value;i&&f.sort(i),a&&(c.value=p)}else a&&(c.value=+a.call(n,e,s)||0);return c}function e(t,i){var r=t.children,s=0;if(r&&(o=r.length))for(var o,l=-1,c=i+1;o>++l;)s+=e(r[l],c);else a&&(s=+a.call(n,hs?t:t.data,i)||0);return a&&(t.value=s),s}function n(e){var n=[];return t(e,0,n),n}var i=ui,r=li,a=ci;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(t){return arguments.length?(a=t,n):a},n.revalue=function(t){return e(t,0),t},n};var hs=!1;d3.layout.pack=function(){function t(t,r){var a=e.call(this,t,r),s=a[0];s.x=0,s.y=0,Ei(s,function(t){t.r=Math.sqrt(t.value)}),Ei(s,mi);var o=i[0],l=i[1],c=Math.max(2*s.r/o,2*s.r/l);if(n>0){var u=n*c/2;Ei(s,function(t){t.r+=u}),Ei(s,mi),Ei(s,function(t){t.r-=u}),c=Math.max(2*s.r/o,2*s.r/l)}return bi(s,o/2,l/2,1/c),a}var e=d3.layout.hierarchy().sort(di),n=0,i=[1,1];return t.size=function(e){return arguments.length?(i=e,t):i},t.padding=function(e){return arguments.length?(n=+e,t):n},oi(t,e)},d3.layout.cluster=function(){function t(t,r){var a,s=e.call(this,t,r),o=s[0],l=0;Ei(o,function(t){var e=t.children;e&&e.length?(t.x=Ti(e),t.y=wi(e)):(t.x=a?l+=n(t,a):0,t.y=0,a=t)});var c=Si(o),u=_i(o),h=c.x-n(c,u)/2,d=u.x+n(u,c)/2;return Ei(o,function(t){t.x=(t.x-h)/(d-h)*i[0],t.y=(1-(o.y?t.y/o.y:1))*i[1]}),s}var e=d3.layout.hierarchy().sort(null).value(null),n=Ai,i=[1,1];return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(i=e,t):i},oi(t,e)},d3.layout.tree=function(){function t(t,r){function a(t,e){var i=t.children,r=t._tree;if(i&&(s=i.length)){for(var s,l,c,u=i[0],h=u,d=-1;s>++d;)c=i[d],a(c,l),h=o(c,l,h),l=c;Yi(t);var f=.5*(u._tree.prelim+c._tree.prelim);e?(r.prelim=e._tree.prelim+n(t,e),r.mod=r.prelim-f):r.prelim=f}else e&&(r.prelim=e._tree.prelim+n(t,e))}function s(t,e){t.x=t._tree.prelim+e;var n=t.children;if(n&&(i=n.length)){var i,r=-1;for(e+=t._tree.mod;i>++r;)s(n[r],e)}}function o(t,e,i){if(e){for(var r,a=t,s=t,o=e,l=t.parent.children[0],c=a._tree.mod,u=s._tree.mod,h=o._tree.mod,d=l._tree.mod;o=Mi(o),a=Ci(a),o&&a;)l=Ci(l),s=Mi(s),s._tree.ancestor=t,r=o._tree.prelim+h-a._tree.prelim-c+n(o,a),r>0&&(Ui(zi(o,t,i),t,r),c+=r,u+=r),h+=o._tree.mod,c+=a._tree.mod,d+=l._tree.mod,u+=s._tree.mod;o&&!Mi(s)&&(s._tree.thread=o,s._tree.mod+=h-u),a&&!Ci(l)&&(l._tree.thread=a,l._tree.mod+=c-d,i=t)}return i}var l=e.call(this,t,r),c=l[0];Ei(c,function(t,e){t._tree={ancestor:t,prelim:0,mod:0,change:0,shift:0,number:e?e._tree.number+1:0}}),a(c),s(c,-c._tree.prelim);var u=ki(c,Di),h=ki(c,Oi),d=ki(c,Pi),f=u.x-n(u,h)/2,p=h.x+n(h,u)/2,g=d.depth||1;return Ei(c,function(t){t.x=(t.x-f)/(p-f)*i[0],t.y=t.depth/g*i[1],delete t._tree}),l}var e=d3.layout.hierarchy().sort(null).value(null),n=Ai,i=[1,1];return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(i=e,t):i},oi(t,e)},d3.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,a=t.length;a>++r;)i=(n=t[r]).value*(0>e?0:e),n.area=isNaN(i)||0>=i?0:i}function e(n){var a=n.children;if(a&&a.length){var s,o,l,c=h(n),u=[],d=a.slice(),f=1/0,p=Math.min(c.dx,c.dy);for(t(d,c.dx*c.dy/n.value),u.area=0;(l=d.length)>0;)u.push(s=d[l-1]),u.area+=s.area,f>=(o=i(u,p))?(d.pop(),f=o):(u.area-=u.pop().area,r(u,p,c,!1),p=Math.min(c.dx,c.dy),u.length=u.area=0,f=1/0);u.length&&(r(u,p,c,!0),u.length=u.area=0),a.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var a,s=h(e),o=i.slice(),l=[];for(t(o,s.dx*s.dy/e.value),l.area=0;a=o.pop();)l.push(a),l.area+=a.area,null!=a.z&&(r(l,a.z?s.dx:s.dy,s,!o.length),l.length=l.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,a=1/0,s=-1,o=t.length;o>++s;)(n=t[s].area)&&(a>n&&(a=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*f/i,i/(e*a*f)):1/0}function r(t,e,n,i){var r,a=-1,s=t.length,o=n.x,c=n.y,u=e?l(t.area/e):0;if(e==n.dx){for((i||u>n.dy)&&(u=n.dy);s>++a;)r=t[a],r.x=o,r.y=c,r.dy=u,o+=r.dx=Math.min(n.x+n.dx-o,u?l(r.area/u):0);r.z=!0,r.dx+=n.x+n.dx-o,n.y+=u,n.dy-=u}else{for((i||u>n.dx)&&(u=n.dx);s>++a;)r=t[a],r.x=o,r.y=c,r.dx=u,c+=r.dy=Math.min(n.y+n.dy-c,u?l(r.area/u):0);r.z=!1,r.dy+=n.y+n.dy-c,n.x+=u,n.dx-=u}}function a(i){var r=s||o(i),a=r[0];return a.x=0,a.y=0,a.dx=c[0],a.dy=c[1],s&&o.revalue(a),t([a],a.dx*a.dy/a.value),(s?n:e)(a),d&&(s=r),r}var s,o=d3.layout.hierarchy(),l=Math.round,c=[1,1],u=null,h=Fi,d=!1,f=.5*(1+Math.sqrt(5));return a.size=function(t){return arguments.length?(c=t,a):c},a.padding=function(t){function e(e){var n=t.call(a,e,e.depth);return null==n?Fi(e):Li(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Li(e,t)}if(!arguments.length)return u;var i;return h=null==(u=t)?Fi:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,a},a.round=function(t){return arguments.length?(l=t?Math.round:Number,a):l!=Number},a.sticky=function(t){return arguments.length?(d=t,s=null,a):d},a.ratio=function(t){return arguments.length?(f=t,a):f},oi(a,o)},d3.csv=$i(",","text/csv"),d3.tsv=$i("	","text/tab-separated-values"),d3.geo={};var ds=Math.PI/180;d3.geo.azimuthal=function(){function t(t){var e,i=t[0]*ds-n,c=t[1]*ds,u=Math.cos(i),h=Math.sin(i),d=Math.cos(c),f=Math.sin(c),p="orthographic"!==s?a*f+r*d*u:null,g="stereographic"===s?1/(1+p):"gnomonic"===s?1/p:"equidistant"===s?(e=Math.acos(p),e?e/Math.sin(e):0):"equalarea"===s?Math.sqrt(2/(1+p)):1,m=g*d*h,v=g*(a*d*u-r*f);return[o*m+l[0],o*v+l[1]]}var e,n,i,r,a,s="orthographic",o=200,l=[480,250];return t.invert=function(t){var e=(t[0]-l[0])/o,i=(t[1]-l[1])/o,c=Math.sqrt(e*e+i*i),u="stereographic"===s?2*Math.atan(c):"gnomonic"===s?Math.atan(c):"equidistant"===s?c:"equalarea"===s?2*Math.asin(.5*c):Math.asin(c),h=Math.sin(u),d=Math.cos(u);return[(n+Math.atan2(e*h,c*r*d+i*a*h))/ds,Math.asin(d*a-(c?i*h*r/c:0))/ds]},t.mode=function(e){return arguments.length?(s=e+"",t):s},t.origin=function(s){return arguments.length?(e=s,n=e[0]*ds,i=e[1]*ds,r=Math.cos(i),a=Math.sin(i),t):e},t.scale=function(e){return arguments.length?(o=+e,t):o},t.translate=function(e){return arguments.length?(l=[+e[0],+e[1]],t):l},t.origin([0,0])},d3.geo.albers=function(){function t(t){var e=i*(ds*t[0]-n),s=Math.sqrt(r-2*i*Math.sin(ds*t[1]))/i;return[l*s*Math.sin(e)+c[0],l*(s*Math.cos(e)-a)+c[1]]}function e(){var e=ds*o[0],l=ds*o[1],c=ds*s[1],u=Math.sin(e),h=Math.cos(e);return n=ds*s[0],i=.5*(u+Math.sin(l)),r=h*h+2*i*u,a=Math.sqrt(r-2*i*Math.sin(c))/i,t}var n,i,r,a,s=[-98,38],o=[29.5,45.5],l=1e3,c=[480,250];return t.invert=function(t){var e=(t[0]-c[0])/l,s=(t[1]-c[1])/l,o=a+s,u=Math.atan2(e,o),h=Math.sqrt(e*e+o*o);return[(n+u/i)/ds,Math.asin((r-h*h*i*i)/(2*i))/ds]},t.origin=function(t){return arguments.length?(s=[+t[0],+t[1]],e()):s},t.parallels=function(t){return arguments.length?(o=[+t[0],+t[1]],e()):o},t.scale=function(e){return arguments.length?(l=+e,t):l},t.translate=function(e){return arguments.length?(c=[+e[0],+e[1]],t):c},e()},d3.geo.albersUsa=function(){function t(t){var a=t[0],s=t[1];return(s>50?n:-140>a?i:21>s?r:e)(t)}var e=d3.geo.albers(),n=d3.geo.albers().origin([-160,60]).parallels([55,65]),i=d3.geo.albers().origin([-160,20]).parallels([8,18]),r=d3.geo.albers().origin([-60,10]).parallels([8,18]);return t.scale=function(a){return arguments.length?(e.scale(a),n.scale(.6*a),i.scale(a),r.scale(1.5*a),t.translate(e.translate())):e.scale()},t.translate=function(a){if(!arguments.length)return e.translate();var s=e.scale()/1e3,o=a[0],l=a[1];return e.translate(a),n.translate([o-400*s,l+170*s]),i.translate([o-190*s,l+200*s]),r.translate([o+580*s,l+430*s]),t},t.scale(e.scale())},d3.geo.bonne=function(){function t(t){var o=t[0]*ds-e,l=t[1]*ds-n;if(i){var c=r+i-l,u=o*Math.cos(l)/c;o=c*Math.sin(u),l=c*Math.cos(u)-r}else o*=Math.cos(l),l*=-1;return[a*o+s[0],a*l+s[1]]}var e,n,i,r,a=200,s=[480,250];return t.invert=function(t){var n=(t[0]-s[0])/a,o=(t[1]-s[1])/a;if(i){var l=r+o,c=Math.sqrt(n*n+l*l);o=r+i-c,n=e+c*Math.atan2(n,l)/Math.cos(o)}else o*=-1,n/=Math.cos(o);return[n/ds,o/ds]},t.parallel=function(e){return arguments.length?(r=1/Math.tan(i=e*ds),t):i/ds},t.origin=function(i){return arguments.length?(e=i[0]*ds,n=i[1]*ds,t):[e/ds,n/ds]},t.scale=function(e){return arguments.length?(a=+e,t):a},t.translate=function(e){return arguments.length?(s=[+e[0],+e[1]],t):s},t.origin([0,0]).parallel(45)},d3.geo.equirectangular=function(){function t(t){var i=t[0]/360,r=-t[1]/360;return[e*i+n[0],e*r+n[1]]}var e=500,n=[480,250];return t.invert=function(t){var i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return[360*i,-360*r]},t.scale=function(n){return arguments.length?(e=+n,t):e},t.translate=function(e){return arguments.length?(n=[+e[0],+e[1]],t):n},t},d3.geo.mercator=function(){function t(t){var i=t[0]/360,r=-(Math.log(Math.tan(Math.PI/4+t[1]*ds/2))/ds)/360;return[e*i+n[0],e*Math.max(-.5,Math.min(.5,r))+n[1]]}var e=500,n=[480,250];return t.invert=function(t){var i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return[360*i,2*Math.atan(Math.exp(-360*r*ds))/ds-90]},t.scale=function(n){return arguments.length?(e=+n,t):e},t.translate=function(e){return arguments.length?(n=[+e[0],+e[1]],t):n},t},d3.geo.path=function(){function t(t){"function"==typeof a&&(s=Ni(a.apply(this,arguments))),c(t);var e=l.length?l.join(""):null;return l=[],e}function e(t){return o(t).join(",")}function n(t){for(var e=r(t[0]),n=0,i=t.length;i>++n;)e-=r(t[n]);return e}function i(t){for(var e=d3.geom.polygon(t[0].map(o)),n=e.area(),i=e.centroid(0>n?(n*=-1,1):-1),r=i[0],a=i[1],s=n,l=0,c=t.length;c>++l;)e=d3.geom.polygon(t[l].map(o)),n=e.area(),i=e.centroid(0>n?(n*=-1,1):-1),r-=i[0],a-=i[1],s-=n;return[r,a,6*s]}function r(t){return Math.abs(d3.geom.polygon(t.map(o)).area())}var a=4.5,s=Ni(a),o=d3.geo.albersUsa(),l=[],c=Ii({FeatureCollection:function(t){for(var e=t.features,n=-1,i=e.length;i>++n;)l.push(c(e[n].geometry))},Feature:function(t){c(t.geometry)},Point:function(t){l.push("M",e(t.coordinates),s)},MultiPoint:function(t){for(var n=t.coordinates,i=-1,r=n.length;r>++i;)l.push("M",e(n[i]),s)},LineString:function(t){var n=t.coordinates,i=-1,r=n.length;for(l.push("M");r>++i;)l.push(e(n[i]),"L");l.pop()},MultiLineString:function(t){for(var n,i,r,a=t.coordinates,s=-1,o=a.length;o>++s;){for(n=a[s],i=-1,r=n.length,l.push("M");r>++i;)l.push(e(n[i]),"L");l.pop()}},Polygon:function(t){for(var n,i,r,a=t.coordinates,s=-1,o=a.length;o>++s;)if(n=a[s],i=-1,(r=n.length-1)>0){for(l.push("M");r>++i;)l.push(e(n[i]),"L");l[l.length-1]="Z"}},MultiPolygon:function(t){for(var n,i,r,a,s,o,c=t.coordinates,u=-1,h=c.length;h>++u;)for(n=c[u],i=-1,r=n.length;r>++i;)if(a=n[i],s=-1,(o=a.length-1)>0){for(l.push("M");o>++s;)l.push(e(a[s]),"L");l[l.length-1]="Z"}},GeometryCollection:function(t){for(var e=t.geometries,n=-1,i=e.length;i>++n;)l.push(c(e[n]))}}),u=t.area=Ii({FeatureCollection:function(t){for(var e=0,n=t.features,i=-1,r=n.length;r>++i;)e+=u(n[i]);return e},Feature:function(t){return u(t.geometry)},Polygon:function(t){return n(t.coordinates)},MultiPolygon:function(t){for(var e=0,i=t.coordinates,r=-1,a=i.length;a>++r;)e+=n(i[r]);return e},GeometryCollection:function(t){for(var e=0,n=t.geometries,i=-1,r=n.length;r>++i;)e+=u(n[i]);return e}},0),h=t.centroid=Ii({Feature:function(t){return h(t.geometry)},Polygon:function(t){var e=i(t.coordinates);return[e[0]/e[2],e[1]/e[2]]},MultiPolygon:function(t){for(var e,n=t.coordinates,r=0,a=0,s=0,o=-1,l=n.length;l>++o;)e=i(n[o]),r+=e[0],a+=e[1],s+=e[2];return[r/s,a/s]}});return t.projection=function(e){return o=e,t},t.pointRadius=function(e){return"function"==typeof e?a=e:(a=+e,s=Ni(a)),t},t},d3.geo.bounds=function(t){var e=1/0,n=1/0,i=-1/0,r=-1/0;return Ri(t,function(t,a){e>t&&(e=t),t>i&&(i=t),n>a&&(n=a),a>r&&(r=a)}),[[e,n],[i,r]]};var fs={Feature:Hi,FeatureCollection:Bi,GeometryCollection:Vi,LineString:ji,MultiLineString:qi,MultiPoint:ji,MultiPolygon:Zi,Point:Wi,Polygon:Xi};d3.geo.circle=function(){function t(){}function e(t){return o>l.distance(t)}function n(t){for(var e,n,r,a,s,c=-1,u=t.length,h=[];u>++c;)s=l.distance(r=t[c]),o>s?(n&&h.push(Qi(n,r)((a-o)/(a-s))),h.push(r),e=n=null):(n=r,!e&&h.length&&(h.push(Qi(h[h.length-1],n)((o-a)/(s-a))),e=n)),a=s;return e=t[0],n=h[0],!n||r[0]!==e[0]||r[1]!==e[1]||r[0]===n[0]&&r[1]===n[1]||h.push(n),i(h)}function i(t){for(var e,n,i,r=0,a=t.length,s=a?[t[0]]:t,o=l.source();a>++r;)for(i=l.source(t[r-1])(t[r]).coordinates,e=0,n=i.length;n>++e;)s.push(i[e]);return l.source(o),s}var a=[0,0],s=89.99,o=s*ds,l=d3.geo.greatArc().source(a).target(r);t.clip=function(t){return"function"==typeof a&&l.source(a.apply(this,arguments)),c(t)||null};var c=Ii({FeatureCollection:function(t){var e=t.features.map(c).filter(r);return e&&(t=Object.create(t),t.features=e,t)},Feature:function(t){var e=c(t.geometry);return e&&(t=Object.create(t),t.geometry=e,t)},Point:function(t){return e(t.coordinates)&&t},MultiPoint:function(t){var n=t.coordinates.filter(e);return n.length&&{type:t.type,coordinates:n}},LineString:function(t){var e=n(t.coordinates);return e.length&&(t=Object.create(t),t.coordinates=e,t)},MultiLineString:function(t){var e=t.coordinates.map(n).filter(function(t){return t.length});return e.length&&(t=Object.create(t),t.coordinates=e,t)},Polygon:function(t){var e=t.coordinates.map(n);return e[0].length&&(t=Object.create(t),t.coordinates=e,t)},MultiPolygon:function(t){var e=t.coordinates.map(function(t){return t.map(n)}).filter(function(t){return t[0].length});return e.length&&(t=Object.create(t),t.coordinates=e,t)},GeometryCollection:function(t){var e=t.geometries.map(c).filter(r);return e.length&&(t=Object.create(t),t.geometries=e,t)}});return t.origin=function(e){return arguments.length?(a=e,"function"!=typeof a&&l.source(a),t):a},t.angle=function(e){return arguments.length?(o=(s=+e)*ds,t):s},d3.rebind(t,l,"precision")},d3.geo.greatArc=function(){function t(){for(var i=t.distance.apply(this,arguments),r=0,o=a/i,l=[e];1>(r+=o);)l.push(s(r));return l.push(n),{type:"LineString",coordinates:l}}var e,n,i=Gi,r=Ji,a=6*ds,s=Ki();return t.distance=function(){return"function"==typeof i&&s.source(e=i.apply(this,arguments)),"function"==typeof r&&s.target(n=r.apply(this,arguments)),s.distance()},t.source=function(n){return arguments.length?(i=n,"function"!=typeof i&&s.source(e=i),t):i},t.target=function(e){return arguments.length?(r=e,"function"!=typeof r&&s.target(n=r),t):r},t.precision=function(e){return arguments.length?(a=e*ds,t):a/ds},t},d3.geo.greatCircle=d3.geo.circle,d3.geom={},d3.geom.contour=function(t,e){var n=e||tr(t),i=[],r=n[0],a=n[1],s=0,o=0,l=0/0,c=0/0,u=0;do u=0,t(r-1,a-1)&&(u+=1),t(r,a-1)&&(u+=2),t(r-1,a)&&(u+=4),t(r,a)&&(u+=8),6===u?(s=-1===c?-1:1,o=0):9===u?(s=0,o=1===l?-1:1):(s=ps[u],o=gs[u]),s!=l&&o!=c&&(i.push([r,a]),l=s,c=o),r+=s,a+=o;while(n[0]!=r||n[1]!=a);return i};var ps=[1,0,1,1,-1,0,-1,1,0,0,0,0,-1,0,-1,0/0],gs=[0,-1,0,0,0,-1,0,0,1,-1,1,1,0,-1,0,0/0];d3.geom.hull=function(t){if(3>t.length)return[];var e,n,i,r,a,s,o,l,c,u,h=t.length,d=h-1,f=[],p=[],g=0;for(e=1;h>e;++e)t[e][1]<t[g][1]?g=e:t[e][1]==t[g][1]&&(g=t[e][0]<t[g][0]?e:g);for(e=0;h>e;++e)e!==g&&(r=t[e][1]-t[g][1],i=t[e][0]-t[g][0],f.push({angle:Math.atan2(r,i),index:e}));for(f.sort(function(t,e){return t.angle-e.angle}),c=f[0].angle,l=f[0].index,o=0,e=1;d>e;++e)n=f[e].index,c==f[e].angle?(i=t[l][0]-t[g][0],r=t[l][1]-t[g][1],a=t[n][0]-t[g][0],s=t[n][1]-t[g][1],i*i+r*r>=a*a+s*s?f[e].index=-1:(f[o].index=-1,c=f[e].angle,o=e,l=n)):(c=f[e].angle,o=e,l=n);for(p.push(g),e=0,n=0;2>e;++n)-1!==f[n].index&&(p.push(f[n].index),e++);for(u=p.length;d>n;++n)if(-1!==f[n].index){for(;!er(p[u-2],p[u-1],f[n].index,t);)--u;p[u++]=f[n].index}var m=[];for(e=0;u>e;++e)m.push(t[p[e]]);return m},d3.geom.polygon=function(t){return t.area=function(){for(var e=0,n=t.length,i=t[n-1][0]*t[0][1],r=t[n-1][1]*t[0][0];n>++e;)i+=t[e-1][0]*t[e][1],r+=t[e-1][1]*t[e][0];return.5*(r-i)},t.centroid=function(e){var n,i,r=-1,a=t.length,s=0,o=0,l=t[a-1];for(arguments.length||(e=-1/(6*t.area()));a>++r;)n=l,l=t[r],i=n[0]*l[1]-l[0]*n[1],s+=(n[0]+l[0])*i,o+=(n[1]+l[1])*i;return[s*e,o*e]},t.clip=function(e){for(var n,i,r,a,s,o,l=-1,c=t.length,u=t[c-1];c>++l;){for(n=e.slice(),e.length=0,a=t[l],s=n[(r=n.length)-1],i=-1;r>++i;)o=n[i],nr(o,u,a)?(nr(s,u,a)||e.push(ir(s,o,u,a)),e.push(o)):nr(s,u,a)&&e.push(ir(s,o,u,a)),s=o;u=a}return e},t},d3.geom.voronoi=function(t){var e=t.map(function(){return[]});return rr(t,function(t){var n,i,r,a,s,o;1===t.a&&t.b>=0?(n=t.ep.r,i=t.ep.l):(n=t.ep.l,i=t.ep.r),1===t.a?(s=n?n.y:-1e6,r=t.c-t.b*s,o=i?i.y:1e6,a=t.c-t.b*o):(r=n?n.x:-1e6,s=t.c-t.a*r,a=i?i.x:1e6,o=t.c-t.a*a);var l=[r,s],c=[a,o];e[t.region.l.index].push(l,c),e[t.region.r.index].push(l,c)}),e.map(function(e,n){var i=t[n][0],r=t[n][1];return e.forEach(function(t){t.angle=Math.atan2(t[0]-i,t[1]-r)}),e.sort(function(t,e){return t.angle-e.angle}).filter(function(t,n){return!n||t.angle-e[n-1].angle>1e-10})})};var ms={l:"r",r:"l"};d3.geom.delaunay=function(t){var e=t.map(function(){return[]}),n=[];return rr(t,function(n){e[n.region.l.index].push(t[n.region.r.index])}),e.forEach(function(e,i){var r=t[i],a=r[0],s=r[1];e.forEach(function(t){t.angle=Math.atan2(t[0]-a,t[1]-s)}),e.sort(function(t,e){return t.angle-e.angle});for(var o=0,l=e.length-1;l>o;o++)n.push([r,e[o],e[o+1]])}),n},d3.geom.quadtree=function(t,e,n,i,r){function a(t,e,n,i,r,a){if(!isNaN(e.x)&&!isNaN(e.y))if(t.leaf){var o=t.point;o?.01>Math.abs(o.x-e.x)+Math.abs(o.y-e.y)?s(t,e,n,i,r,a):(t.point=null,s(t,o,n,i,r,a),s(t,e,n,i,r,a)):t.point=e}else s(t,e,n,i,r,a)}function s(t,e,n,i,r,s){var o=.5*(n+r),l=.5*(i+s),c=e.x>=o,u=e.y>=l,h=(u<<1)+c;t.leaf=!1,t=t.nodes[h]||(t.nodes[h]=ar()),c?n=o:r=o,u?i=l:s=l,a(t,e,n,i,r,s)}var o,l=-1,c=t.length;if(c&&isNaN(t[0].x)&&(t=t.map(or)),5>arguments.length)if(3===arguments.length)r=i=n,n=e;else{for(e=n=1/0,i=r=-1/0;c>++l;)o=t[l],e>o.x&&(e=o.x),n>o.y&&(n=o.y),o.x>i&&(i=o.x),o.y>r&&(r=o.y);var u=i-e,h=r-n;u>h?r=n+u:i=e+h}var d=ar();return d.add=function(t){a(d,t,e,n,i,r)},d.visit=function(t){sr(t,d,e,n,i,r)},t.forEach(d.add),d},d3.time={};var vs=Date,ys=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];lr.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){bs.setUTCDate.apply(this._,arguments)},setDay:function(){bs.setUTCDay.apply(this._,arguments)},setFullYear:function(){bs.setUTCFullYear.apply(this._,arguments)},setHours:function(){bs.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){bs.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){bs.setUTCMinutes.apply(this._,arguments)},setMonth:function(){bs.setUTCMonth.apply(this._,arguments)},setSeconds:function(){bs.setUTCSeconds.apply(this._,arguments)},setTime:function(){bs.setTime.apply(this._,arguments)}};var bs=Date.prototype,xs="%a %b %e %H:%M:%S %Y",ws="%m/%d/%y",Ts="%H:%M:%S",Ss=ys,_s=Ss.map(cr),As=["January","February","March","April","May","June","July","August","September","October","November","December"],Cs=As.map(cr);d3.time.format=function(t){function e(e){for(var i,r,a=[],s=-1,o=0;n>++s;)37==t.charCodeAt(s)&&(a.push(t.substring(o,s),(r=Ls[i=t.charAt(++s)])?r(e):i),o=s+1);return a.push(t.substring(o,s)),a.join("")}var n=t.length;return e.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},i=ur(n,t,e,0);if(i!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var r=new vs;return r.setFullYear(n.y,n.m,n.d),r.setHours(n.H,n.M,n.S,n.L),r},e.toString=function(){return t},e};var Ms=d3.format("02d"),ks=d3.format("03d"),Os=d3.format("04d"),Ds=d3.format("2d"),Ps=hr(Ss),Es=hr(_s),Ys=hr(As),Us=dr(As),zs=hr(Cs),Fs=dr(Cs),Ls={a:function(t){return _s[t.getDay()]},A:function(t){return Ss[t.getDay()]},b:function(t){return Cs[t.getMonth()]},B:function(t){return As[t.getMonth()]},c:d3.time.format(xs),d:function(t){return Ms(t.getDate())},e:function(t){return Ds(t.getDate())},H:function(t){return Ms(t.getHours())},I:function(t){return Ms(t.getHours()%12||12)},j:function(t){return ks(1+d3.time.dayOfYear(t))},L:function(t){return ks(t.getMilliseconds())},m:function(t){return Ms(t.getMonth()+1)},M:function(t){return Ms(t.getMinutes())},p:function(t){return t.getHours()>=12?"PM":"AM"},S:function(t){return Ms(t.getSeconds())},U:function(t){return Ms(d3.time.sundayOfYear(t))},w:function(t){return t.getDay()},W:function(t){return Ms(d3.time.mondayOfYear(t))},x:d3.time.format(ws),X:d3.time.format(Ts),y:function(t){return Ms(t.getFullYear()%100)},Y:function(t){return Os(t.getFullYear()%1e4)},Z:Dr,"%":function(){return"%"}},$s={a:fr,A:pr,b:gr,B:mr,c:vr,d:_r,e:_r,H:Ar,I:Ar,L:kr,m:Sr,M:Cr,p:Or,S:Mr,x:yr,X:br,y:wr,Y:xr},Is=/^\s*\d+/,Ns=d3.map({am:0,pm:1});d3.time.format.utc=function(t){function e(t){try{vs=lr;var e=new vs;return e._=t,n(e)}finally{vs=Date}}var n=d3.time.format(t);return e.parse=function(t){try{vs=lr;var e=n.parse(t);return e&&e._}finally{vs=Date}},e.toString=n.toString,e};var Rs=d3.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");d3.time.format.iso=Date.prototype.toISOString?Pr:Rs,Pr.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Pr.toString=Rs.toString,d3.time.second=Er(function(t){return new vs(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),d3.time.seconds=d3.time.second.range,d3.time.seconds.utc=d3.time.second.utc.range,d3.time.minute=Er(function(t){return new vs(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),d3.time.minutes=d3.time.minute.range,d3.time.minutes.utc=d3.time.minute.utc.range,d3.time.hour=Er(function(t){var e=t.getTimezoneOffset()/60;return new vs(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),d3.time.hours=d3.time.hour.range,d3.time.hours.utc=d3.time.hour.utc.range,d3.time.day=Er(function(t){var e=new vs(1970,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),d3.time.days=d3.time.day.range,d3.time.days.utc=d3.time.day.utc.range,d3.time.dayOfYear=function(t){var e=d3.time.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},ys.forEach(function(t,e){t=t.toLowerCase(),e=7-e;var n=d3.time[t]=Er(function(t){return(t=d3.time.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=d3.time.year(t).getDay();return Math.floor((d3.time.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});d3.time[t+"s"]=n.range,d3.time[t+"s"].utc=n.utc.range,d3.time[t+"OfYear"]=function(t){var n=d3.time.year(t).getDay();return Math.floor((d3.time.dayOfYear(t)+(n+e)%7)/7)}}),d3.time.week=d3.time.sunday,d3.time.weeks=d3.time.sunday.range,d3.time.weeks.utc=d3.time.sunday.utc.range,d3.time.weekOfYear=d3.time.sundayOfYear,d3.time.month=Er(function(t){return t=d3.time.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),d3.time.months=d3.time.month.range,d3.time.months.utc=d3.time.month.utc.range,d3.time.year=Er(function(t){return t=d3.time.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),d3.time.years=d3.time.year.range,d3.time.years.utc=d3.time.year.utc.range;var Hs=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],Bs=[[d3.time.second,1],[d3.time.second,5],[d3.time.second,15],[d3.time.second,30],[d3.time.minute,1],[d3.time.minute,5],[d3.time.minute,15],[d3.time.minute,30],[d3.time.hour,1],[d3.time.hour,3],[d3.time.hour,6],[d3.time.hour,12],[d3.time.day,1],[d3.time.day,2],[d3.time.week,1],[d3.time.month,1],[d3.time.month,3],[d3.time.year,1]],Vs=[[d3.time.format("%Y"),function(){return!0}],[d3.time.format("%B"),function(t){return t.getMonth()}],[d3.time.format("%b %d"),function(t){return 1!=t.getDate()}],[d3.time.format("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[d3.time.format("%I %p"),function(t){return t.getHours()}],[d3.time.format("%I:%M"),function(t){return t.getMinutes()}],[d3.time.format(":%S"),function(t){return t.getSeconds()}],[d3.time.format(".%L"),function(t){return t.getMilliseconds()}]],js=d3.scale.linear(),qs=Lr(Vs);Bs.year=function(t,e){return js.domain(t.map(Ir)).ticks(e).map($r)},d3.time.scale=function(){return Ur(d3.scale.linear(),Bs,qs)};var Zs=Bs.map(function(t){return[t[0].utc,t[1]]}),Ws=[[d3.time.format.utc("%Y"),function(){return!0}],[d3.time.format.utc("%B"),function(t){return t.getUTCMonth()}],[d3.time.format.utc("%b %d"),function(t){return 1!=t.getUTCDate()}],[d3.time.format.utc("%a %d"),function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],[d3.time.format.utc("%I %p"),function(t){return t.getUTCHours()}],[d3.time.format.utc("%I:%M"),function(t){return t.getUTCMinutes()}],[d3.time.format.utc(":%S"),function(t){return t.getUTCSeconds()}],[d3.time.format.utc(".%L"),function(t){return t.getUTCMilliseconds()}]],Xs=Lr(Ws);Zs.year=function(t,e){return js.domain(t.map(Rr)).ticks(e).map(Nr)},d3.time.scale.utc=function(){return Ur(d3.scale.linear(),Zs,Xs)}}(),function(t){function e(e){var n=e||window.event,i=[].slice.call(arguments,1),r=0,a=0,s=0;return e=t.event.fix(n),e.type="mousewheel",n.wheelDelta&&(r=n.wheelDelta/120),n.detail&&(r=-n.detail/3),s=r,void 0!==n.axis&&n.axis===n.HORIZONTAL_AXIS&&(s=0,a=-1*r),void 0!==n.wheelDeltaY&&(s=n.wheelDeltaY/120),void 0!==n.wheelDeltaX&&(a=-1*n.wheelDeltaX/120),i.unshift(e,r,a,s),(t.event.dispatch||t.event.handle).apply(this,i)}var n=["DOMMouseScroll","mousewheel"];if(t.event.fixHooks)for(var i=n.length;i;)t.event.fixHooks[n[--i]]=t.event.mouseHooks;t.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var t=n.length;t;)this.addEventListener(n[--t],e,!1);else this.onmousewheel=e},teardown:function(){if(this.removeEventListener)for(var t=n.length;t;)this.removeEventListener(n[--t],e,!1);else this.onmousewheel=null}},t.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})}(jQuery),function(t,e,n){t.fn.jScrollPane=function(i){function r(i,r){function a(e){var r,o,c,h,d,f,m=!1,v=!1;if(R=e,H===n)d=i.scrollTop(),f=i.scrollLeft(),i.css({overflow:"hidden",padding:0}),B=i.innerWidth()+be,V=i.innerHeight(),i.width(B),H=t('<div class="jspPane" />').css("padding",ye).append(i.children()),j=t('<div class="jspContainer" />').css({width:B+"px",height:V+"px"}).append(H).appendTo(i);else{if(i.css("width",""),m=R.stickToBottom&&k(),v=R.stickToRight&&O(),h=i.innerWidth()+be!=B||i.outerHeight(!1)!=V,h&&(B=i.innerWidth()+be,V=i.innerHeight(),j.css({width:B+"px",height:V+"px"})),!h&&xe==q&&H.outerHeight(!1)==Z)return i.width(B),n;xe=q,H.css("width",""),i.width(B),j.find(">.jspVerticalBar,>.jspHorizontalBar").remove().end()}H.css("overflow","auto"),q=e.contentWidth?e.contentWidth:H[0].scrollWidth,Z=H[0].scrollHeight,H.css("overflow",""),W=q/B,X=Z/V,G=X>1,J=W>1,J||G?(i.addClass("jspScrollable"),r=R.maintainPosition&&(te||ie),r&&(o=C(),c=M()),s(),l(),u(),r&&(_(v?q-B:o,!1),S(m?Z-V:c,!1)),Y(),D(),I(),R.enableKeyboardNavigation&&z(),R.clickOnTrack&&p(),L(),R.hijackInternalLinks&&$()):(i.removeClass("jspScrollable"),H.css({top:0,width:j.width()-be}),P(),U(),F(),g()),R.autoReinitialise&&!ve?ve=setInterval(function(){a(R)},R.autoReinitialiseDelay):!R.autoReinitialise&&ve&&clearInterval(ve),d&&i.scrollTop(0)&&S(d,!1),f&&i.scrollLeft(0)&&_(f,!1),i.trigger("jsp-initialised",[J||G])}function s(){G&&(j.append(t('<div class="jspVerticalBar" />').append(t('<div class="jspCap jspCapTop" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragTop" />'),t('<div class="jspDragBottom" />'))),t('<div class="jspCap jspCapBottom" />'))),re=j.find(">.jspVerticalBar"),ae=re.find(">.jspTrack"),K=ae.find(">.jspDrag"),R.showArrows&&(ce=t('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",d(0,-1)).bind("click.jsp",E),ue=t('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",d(0,1)).bind("click.jsp",E),R.arrowScrollOnHover&&(ce.bind("mouseover.jsp",d(0,-1,ce)),ue.bind("mouseover.jsp",d(0,1,ue))),h(ae,R.verticalArrowPositions,ce,ue)),oe=V,j.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){oe-=t(this).outerHeight(!1)
}),K.hover(function(){K.addClass("jspHover")},function(){K.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",E),K.addClass("jspActive");var n=e.pageY-K.position().top;return t("html").bind("mousemove.jsp",function(t){v(t.pageY-n,!1)}).bind("mouseup.jsp mouseleave.jsp",m),!1}),o())}function o(){ae.height(oe+"px"),te=0,se=R.verticalGutter+ae.outerWidth(!1),H.width(B-se-be);try{0===re.position().left&&H.css("margin-left",se+"px")}catch(t){}}function l(){J&&(j.append(t('<div class="jspHorizontalBar" />').append(t('<div class="jspCap jspCapLeft" />'),t('<div class="jspTrack" />').append(t('<div class="jspDrag" />').append(t('<div class="jspDragLeft" />'),t('<div class="jspDragRight" />'))),t('<div class="jspCap jspCapRight" />'))),he=j.find(">.jspHorizontalBar"),de=he.find(">.jspTrack"),ee=de.find(">.jspDrag"),R.showArrows&&(ge=t('<a class="jspArrow jspArrowLeft" />').bind("mousedown.jsp",d(-1,0)).bind("click.jsp",E),me=t('<a class="jspArrow jspArrowRight" />').bind("mousedown.jsp",d(1,0)).bind("click.jsp",E),R.arrowScrollOnHover&&(ge.bind("mouseover.jsp",d(-1,0,ge)),me.bind("mouseover.jsp",d(1,0,me))),h(de,R.horizontalArrowPositions,ge,me)),ee.hover(function(){ee.addClass("jspHover")},function(){ee.removeClass("jspHover")}).bind("mousedown.jsp",function(e){t("html").bind("dragstart.jsp selectstart.jsp",E),ee.addClass("jspActive");var n=e.pageX-ee.position().left;return t("html").bind("mousemove.jsp",function(t){b(t.pageX-n,!1)}).bind("mouseup.jsp mouseleave.jsp",m),!1}),fe=j.innerWidth(),c())}function c(){j.find(">.jspHorizontalBar>.jspCap:visible,>.jspHorizontalBar>.jspArrow").each(function(){fe-=t(this).outerWidth(!1)}),de.width(fe+"px"),ie=0}function u(){if(J&&G){var e=de.outerHeight(!1),n=ae.outerWidth(!1);oe-=e,t(he).find(">.jspCap:visible,>.jspArrow").each(function(){fe+=t(this).outerWidth(!1)}),fe-=n,V-=n,B-=e,de.parent().append(t('<div class="jspCorner" />').css("width",e+"px")),o(),c()}J&&H.width(j.outerWidth(!1)-be+"px"),Z=H.outerHeight(!1),X=Z/V,J&&(pe=Math.ceil(1/W*fe),pe>R.horizontalDragMaxWidth?pe=R.horizontalDragMaxWidth:R.horizontalDragMinWidth>pe&&(pe=R.horizontalDragMinWidth),ee.width(pe+"px"),ne=fe-pe,x(ie)),G&&(le=Math.ceil(1/X*oe),le>R.verticalDragMaxHeight?le=R.verticalDragMaxHeight:R.verticalDragMinHeight>le&&(le=R.verticalDragMinHeight),K.height(le+"px"),Q=oe-le,y(te))}function h(t,e,n,i){var r,a="before",s="after";"os"==e&&(e=/Mac/.test(navigator.platform)?"after":"split"),e==a?s=e:e==s&&(a=e,r=n,n=i,i=r),t[a](n)[s](i)}function d(t,e,n){return function(){return f(t,e,this,n),this.blur(),!1}}function f(e,n,i,r){i=t(i).addClass("jspActive");var a,s,o=!0,l=function(){0!==e&&we.scrollByX(e*R.arrowButtonSpeed),0!==n&&we.scrollByY(n*R.arrowButtonSpeed),s=setTimeout(l,o?R.initialDelay:R.arrowRepeatFreq),o=!1};l(),a=r?"mouseout.jsp":"mouseup.jsp",r=r||t("html"),r.bind(a,function(){i.removeClass("jspActive"),s&&clearTimeout(s),s=null,r.unbind(a)})}function p(){g(),G&&ae.bind("mousedown.jsp",function(e){if(e.originalTarget===n||e.originalTarget==e.currentTarget){var i,r=t(this),a=r.offset(),s=e.pageY-a.top-te,o=!0,l=function(){var t=r.offset(),a=e.pageY-t.top-le/2,u=V*R.scrollPagePercent,h=Q*u/(Z-V);if(0>s)te-h>a?we.scrollByY(-u):v(a);else{if(!(s>0))return c(),n;a>te+h?we.scrollByY(u):v(a)}i=setTimeout(l,o?R.initialDelay:R.trackClickRepeatFreq),o=!1},c=function(){i&&clearTimeout(i),i=null,t(document).unbind("mouseup.jsp",c)};return l(),t(document).bind("mouseup.jsp",c),!1}}),J&&de.bind("mousedown.jsp",function(e){if(e.originalTarget===n||e.originalTarget==e.currentTarget){var i,r=t(this),a=r.offset(),s=e.pageX-a.left-ie,o=!0,l=function(){var t=r.offset(),a=e.pageX-t.left-pe/2,u=B*R.scrollPagePercent,h=ne*u/(q-B);if(0>s)ie-h>a?we.scrollByX(-u):b(a);else{if(!(s>0))return c(),n;a>ie+h?we.scrollByX(u):b(a)}i=setTimeout(l,o?R.initialDelay:R.trackClickRepeatFreq),o=!1},c=function(){i&&clearTimeout(i),i=null,t(document).unbind("mouseup.jsp",c)};return l(),t(document).bind("mouseup.jsp",c),!1}})}function g(){de&&de.unbind("mousedown.jsp"),ae&&ae.unbind("mousedown.jsp")}function m(){t("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),K&&K.removeClass("jspActive"),ee&&ee.removeClass("jspActive")}function v(t,e){G&&(0>t?t=0:t>Q&&(t=Q),e===n&&(e=R.animateScroll),e?we.animate(K,"top",t,y):(K.css("top",t),y(t)))}function y(t){t===n&&(t=K.position().top),j.scrollTop(0),te=t;var e=0===te,r=te==Q,a=t/Q,s=-a*(Z-V);(Te!=e||_e!=r)&&(Te=e,_e=r,i.trigger("jsp-arrow-change",[Te,_e,Se,Ae])),w(e,r),H.css("top",s),i.trigger("jsp-scroll-y",[-s,e,r]).trigger("scroll")}function b(t,e){J&&(0>t?t=0:t>ne&&(t=ne),e===n&&(e=R.animateScroll),e?we.animate(ee,"left",t,x):(ee.css("left",t),x(t)))}function x(t){t===n&&(t=ee.position().left),j.scrollTop(0),ie=t;var e=0===ie,r=ie==ne,a=t/ne,s=-a*(q-B);(Se!=e||Ae!=r)&&(Se=e,Ae=r,i.trigger("jsp-arrow-change",[Te,_e,Se,Ae])),T(e,r),H.css("left",s),i.trigger("jsp-scroll-x",[-s,e,r]).trigger("scroll")}function w(t,e){R.showArrows&&(ce[t?"addClass":"removeClass"]("jspDisabled"),ue[e?"addClass":"removeClass"]("jspDisabled"))}function T(t,e){R.showArrows&&(ge[t?"addClass":"removeClass"]("jspDisabled"),me[e?"addClass":"removeClass"]("jspDisabled"))}function S(t,e){var n=t/(Z-V);v(n*Q,e)}function _(t,e){var n=t/(q-B);b(n*ne,e)}function A(e,n,i){var r,a,s,o,l,c,u,h,d,f=0,p=0;try{r=t(e)}catch(g){return}for(a=r.outerHeight(!1),s=r.outerWidth(!1),j.scrollTop(0),j.scrollLeft(0);!r.is(".jspPane");)if(f+=r.position().top,p+=r.position().left,r=r.offsetParent(),/^body|html$/i.test(r[0].nodeName))return;o=M(),c=o+V,o>f||n?h=f-R.verticalGutter:f+a>c&&(h=f-V+a+R.verticalGutter),h&&S(h,i),l=C(),u=l+B,l>p||n?d=p-R.horizontalGutter:p+s>u&&(d=p-B+s+R.horizontalGutter),d&&_(d,i)}function C(){return-H.position().left}function M(){return-H.position().top}function k(){var t=Z-V;return t>20&&10>t-M()}function O(){var t=q-B;return t>20&&10>t-C()}function D(){j.unbind(Me).bind(Me,function(t,e,n,i){var r=ie,a=te;return we.scrollBy(n*R.mouseWheelSpeed,-i*R.mouseWheelSpeed,!1),r==ie&&a==te})}function P(){j.unbind(Me)}function E(){return!1}function Y(){H.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(t){A(t.target,!1)})}function U(){H.find(":input,a").unbind("focus.jsp")}function z(){function e(){var t=ie,e=te;switch(n){case 40:we.scrollByY(R.keyboardSpeed,!1);break;case 38:we.scrollByY(-R.keyboardSpeed,!1);break;case 34:case 32:we.scrollByY(V*R.scrollPagePercent,!1);break;case 33:we.scrollByY(-V*R.scrollPagePercent,!1);break;case 39:we.scrollByX(R.keyboardSpeed,!1);break;case 37:we.scrollByX(-R.keyboardSpeed,!1)}return r=t!=ie||e!=te}var n,r,a=[];J&&a.push(he[0]),G&&a.push(re[0]),H.focus(function(){i.focus()}),i.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(i){if(i.target===this||a.length&&t(i.target).closest(a).length){var s=ie,o=te;switch(i.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:n=i.keyCode,e();break;case 35:S(Z-V),n=null;break;case 36:S(0),n=null}return r=i.keyCode==n&&s!=ie||o!=te,!r}}).bind("keypress.jsp",function(t){return t.keyCode==n&&e(),!r}),R.hideFocus?(i.css("outline","none"),"hideFocus"in j[0]&&i.attr("hideFocus",!0)):(i.css("outline",""),"hideFocus"in j[0]&&i.attr("hideFocus",!1))}function F(){i.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function L(){if(location.hash&&location.hash.length>1){var e,n,i=escape(location.hash.substr(1));try{e=t("#"+i+', a[name="'+i+'"]')}catch(r){return}e.length&&H.find(i)&&(0===j.scrollTop()?n=setInterval(function(){j.scrollTop()>0&&(A(e,!0),t(document).scrollTop(j.position().top),clearInterval(n))},50):(A(e,!0),t(document).scrollTop(j.position().top)))}}function $(){t(document.body).data("jspHijack")||(t(document.body).data("jspHijack",!0),t(document.body).delegate("a[href*=#]","click",function(n){var i,r,a,s,o,l,c=this.href.substr(0,this.href.indexOf("#")),u=location.href;if(-1!==location.href.indexOf("#")&&(u=location.href.substr(0,location.href.indexOf("#"))),c===u){i=escape(this.href.substr(this.href.indexOf("#")+1));try{r=t("#"+i+', a[name="'+i+'"]')}catch(h){return}r.length&&(a=r.closest(".jspScrollable"),s=a.data("jsp"),s.scrollToElement(r,!0),a[0].scrollIntoView&&(o=t(e).scrollTop(),l=r.offset().top,(o>l||l>o+t(e).height())&&a[0].scrollIntoView()),n.preventDefault())}}))}function I(){var t,e,i,r,a,s=!1;j.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(n){var o=n.originalEvent.touches[0];t=C(),e=M(),i=o.pageX,r=o.pageY,a=!1,s=!0}).bind("touchmove.jsp",function(n){if(s){var o=n.originalEvent.touches[0],l=ie,c=te;return we.scrollTo(t+i-o.pageX,e+r-o.pageY),a=a||Math.abs(i-o.pageX)>5||Math.abs(r-o.pageY)>5,l==ie&&c==te}}).bind("touchend.jsp",function(){s=!1}).bind("click.jsp-touchclick",function(){return a?(a=!1,!1):n})}function N(){var t=M(),e=C();i.removeClass("jspScrollable").unbind(".jsp"),i.replaceWith(Ce.append(H.children())),Ce.scrollTop(t),Ce.scrollLeft(e),ve&&clearInterval(ve)}var R,H,B,V,j,q,Z,W,X,G,J,K,Q,te,ee,ne,ie,re,ae,se,oe,le,ce,ue,he,de,fe,pe,ge,me,ve,ye,be,xe,we=this,Te=!0,Se=!0,_e=!1,Ae=!1,Ce=i.clone(!1,!1).empty(),Me=t.fn.mwheelIntent?"mwheelIntent.jsp":"mousewheel.jsp";ye=i.css("paddingTop")+" "+i.css("paddingRight")+" "+i.css("paddingBottom")+" "+i.css("paddingLeft"),be=(parseInt(i.css("paddingLeft"),10)||0)+(parseInt(i.css("paddingRight"),10)||0),t.extend(we,{reinitialise:function(e){e=t.extend({},R,e),a(e)},scrollToElement:function(t,e,n){A(t,e,n)},scrollTo:function(t,e,n){_(t,n),S(e,n)},scrollToX:function(t,e){_(t,e)},scrollToY:function(t,e){S(t,e)},scrollToPercentX:function(t,e){_(t*(q-B),e)},scrollToPercentY:function(t,e){S(t*(Z-V),e)},scrollBy:function(t,e,n){we.scrollByX(t,n),we.scrollByY(e,n)},scrollByX:function(t,e){var n=C()+Math[0>t?"floor":"ceil"](t),i=n/(q-B);b(i*ne,e)},scrollByY:function(t,e){var n=M()+Math[0>t?"floor":"ceil"](t),i=n/(Z-V);v(i*Q,e)},positionDragX:function(t,e){b(t,e)},positionDragY:function(t,e){v(t,e)},animate:function(t,e,n,i){var r={};r[e]=n,t.animate(r,{duration:R.animateDuration,easing:R.animateEase,queue:!1,step:i})},getContentPositionX:function(){return C()},getContentPositionY:function(){return M()},getContentWidth:function(){return q},getContentHeight:function(){return Z},getPercentScrolledX:function(){return C()/(q-B)},getPercentScrolledY:function(){return M()/(Z-V)},getIsScrollableH:function(){return J},getIsScrollableV:function(){return G},getContentPane:function(){return H},scrollToBottom:function(t){v(Q,t)},hijackInternalLinks:t.noop,destroy:function(){N()}}),a(r)}return i=t.extend({},t.fn.jScrollPane.defaults,i),t.each(["mouseWheelSpeed","arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){i[this]=i[this]||i.speed}),this.each(function(){var e=t(this),n=e.data("jsp");n?n.reinitialise(i):(t("script",e).filter('[type="text/javascript"],:not([type])').remove(),n=new r(e,i),e.data("jsp",n))})},t.fn.jScrollPane.defaults={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:n,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:0,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8}}(jQuery,this),function(t,e,n){"$:nomunge";function i(){r=e[o](function(){a.each(function(){var e=t(this),n=e.width(),i=e.height(),r=t.data(this,c);(n!==r.w||i!==r.h)&&e.trigger(l,[r.w=n,r.h=i])}),i()},s[u])}var r,a=t([]),s=t.resize=t.extend(t.resize,{}),o="setTimeout",l="resize",c=l+"-special-event",u="delay",h="throttleWindow";s[u]=250,s[h]=!0,t.event.special[l]={setup:function(){if(!s[h]&&this[o])return!1;var e=t(this);a=a.add(e),t.data(this,c,{w:e.width(),h:e.height()}),1===a.length&&i()},teardown:function(){if(!s[h]&&this[o])return!1;var e=t(this);a=a.not(e),e.removeData(c),a.length||clearTimeout(r)},add:function(e){function i(e,i,a){var s=t(this),o=t.data(this,c);o.w=i!==n?i:s.width(),o.h=a!==n?a:s.height(),r.apply(this,arguments)}if(!s[h]&&this[o])return!1;var r;return t.isFunction(e)?(r=e,i):(r=e.handler,e.handler=i,n)}}}(jQuery,this),function(){"use strict";STAT4YOU.namespace("STAT4YOU.svg.Exporter"),STAT4YOU.svg.Exporter=function(){},STAT4YOU.svg.Exporter.prototype={sanitizeSvg:function(t){return t=t.replace(/zIndex="[^"]+"/g,"").replace(/isShadow="[^"]+"/g,"").replace(/symbolName="[^"]+"/g,"").replace(/jQuery[0-9]+="[^"]+"/g,"").replace(/isTracker="[^"]+"/g,"").replace(/url\([^#]+#/g,"url(#").replace(/ href=/g," xlink:href=").replace(/\n/," ").replace(/<\/svg>.*?$/,"</svg>").replace(/&nbsp;/g,"").replace(/&shy;/g,"").replace(/fill="#F5F5F5"/g,'fill="#FFFFFF"')},submitInDynamicForm:function(t){var e=$('<form action="'+t.url+'" method="POST">');_.each(t.data,function(t,n){var i=$('<input type="hidden">');i.attr("name",n),i.attr("value",t),e.append(i)}),e.submit()},_insertStyleInSvg:function(t,e){var n=t.indexOf(">")+1,i='<defs><style type="text/css"><![CDATA['+e+"]]></style></defs>";return t.substring(0,n)+i+t.substring(n)},addStyleAsync:function(t){var e=this,n=new $.Deferred,i=$.get(STAT4YOU.resourceContext+"/assets/css/map.css");return $.when(i).done(function(i){var r=e._insertStyleInSvg(t,i);n.resolveWith(null,[r])}),n.promise()},mimeTypeFromType:function(t){var e;return e="svg"===t?"image/svg+xml":"pdf"===t?"application/pdf":"image/png"},processSvgElement:function(t,e){var n=$(t).parent(),i=n.html(),r=this.sanitizeSvg(i),a=this;this.addStyleAsync(r).done(function(t){a.submitInDynamicForm({url:STAT4YOU.context+"/chart/export",data:{filename:"chart",type:a.mimeTypeFromType(e),width:n.width(),scale:2,svg:t}})})}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.svg.SVGNode");var t="http://www.w3.org/2000/svg";STAT4YOU.svg.SVGNode=function(e){_.isString(e)?(this.name=e,this.node=document.createElementNS(t,e)):this.node=e,this.attrs={}},STAT4YOU.svg.SVGNode.factory=function(t,e){e=e||1;for(var n=[],i=0;e>i;i++)n.push(new STAT4YOU.svg.SVGNode(t));return n},STAT4YOU.svg.SVGNode.prototype={set:function(t,e){_.isObject(t)?_.each(t,function(t,e){this.attrs[e]=t,this.node.setAttributeNS(null,e,""+t)},this):(this.attrs[t]=e,this.node.setAttributeNS(null,t,""+e))},append:function(t){_.isArray(t)||(t=[t]),_.each(t,function(t){this.node.appendChild(t.node)},this)},appendFirst:function(t){_.isArray(t)||(t=[t]),_.each(t,function(t){this.node.insertBefore(t.node,this.node.firstChild)},this)},getFrame:function(){var t=this.node.getBBox();return{x:t.x,y:t.y,width:t.width,height:t.height}},alignBottomRight:function(t,e,n){var i=e||0,r=n||0,a=this.node.getBBox(),s=t.width-a.width-r,o=t.height-a.height-i;this.set("transform","translate("+s+", "+o+")")},addMargins:function(t){var e=this.getFrame();this.set({width:e.width+2*t,height:e.height+2*t,y:e.y-t,x:e.x-t})}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.modules.dataset.DatasetPermalink"),STAT4YOU.modules.dataset.DatasetPermalink=Backbone.Model.extend({idAttribute:"identifier",urlRoot:STAT4YOU.context+"/api/v1.0/permalinks"})}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset");var t=STAT4YOU.modules.dataset.DatasetPermalink;STAT4YOU.modules.dataset.PermalinkBuilder=function(t){this.filterOptions=t.filterOptions,this.optionsModel=t.optionsModel},STAT4YOU.modules.dataset.PermalinkBuilder.prototype={_url:function(t){var e=window.location.protocol+"//"+window.location.host+STAT4YOU.context+this._relativeUrl(t);return e},_relativeUrl:function(t){var e=this.filterOptions.metadata.getProvider(),n=this.filterOptions.metadata.getIdentifier(),i=this.optionsModel.get("type"),r=t.get("identifier"),a="/providers/"+e+"/datasets/"+n+"/#"+"type/"+i+"/selection/"+r;return a},_createPermalinkModel:function(){var e=JSON.stringify(this.filterOptions.exportSelection());return new t({content:e})},createPermalink:function(t){t||(t={});var e=this,n=$.Deferred(),i=this._createPermalinkModel();return i.save().done(function(){var r=t.relative?e._relativeUrl(i):e._url(i);n.resolveWith(null,[r])}).fail(function(){n.reject()}),n.promise()}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.modules.dataset.DatasetActionsView"),STAT4YOU.modules.dataset.DatasetActionsView=Backbone.View.extend({template:STAT4YOU.templateManager.get("dataset/dataset-actions"),modalTemplate:STAT4YOU.templateManager.get("dataset/dataset-share-modal"),initialize:function(t){this.filterOptions=t.filterOptions,this.permalinkBuilder=t.permalinkBuilder,STAT4YOU.user&&STAT4YOU.user.favourites&&(this.favourites=STAT4YOU.user.favourites,this.favourites.on("add remove reset",this.render,this),this.favourites.fetch()),this.datasetUri=this.filterOptions.metadata.getUri(),_.bindAll(this,"showModal")},events:{"click .share":"clickShare","click .favourite":"clickFavourite"},render:function(){var t=!1;this.favourites&&(t=this.favourites.isFav({uri:this.datasetUri}));var e={user:STAT4YOU.user,isFavourite:t};this.$el.html(this.template(e)),this.$modal=this.$el.find("#shareDatasetModel"),this.$modalBody=this.$modal.find(".modal-body")},clickShare:function(t){t.preventDefault();var e=this,n=this.permalinkBuilder.createPermalink();n.done(function(t){e.showModal(t)})},clickFavourite:function(t){t.preventDefault();var e=this;STAT4YOU.doActionIfRegistered(function(){e.favourites&&e.favourites.toggle(e.datasetUri)})},showModal:function(t){STAT4YOU.track({event:"dataset.share.showModal",datasetUri:this.datasetUri}),this.renderModalBody(t),this.$modal.modal("show")},renderModalBody:function(t){var e={url:t,title:this.filterOptions.metadata.getTitle()};this.$modalBody.html(this.modalTemplate(e));var n={data_track_addressbar:!0},i={url:e.url,title:e.title,templates:{twitter:e.title+" "+e.url+" (via @stat4you)"}};addthis.toolbox(".addthis_toolbox",n,i)}})}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset"),STAT4YOU.modules.dataset.ExportView=Backbone.View.extend({template:STAT4YOU.templateManager.get("dataset/dataset-export"),events:{"click .export-png":"exportPng","click .export-svg":"exportSvg","click .export-pdf":"exportPdf"},_exportIsAllowed:function(){var t=this.model.get("type");return"table"!==t&&"canvasTable"!==t},render:function(){var t={exportIsAllowed:this._exportIsAllowed()};this.$el.html(this.template(t))},_export:function(t,e){t.preventDefault();var n=this;STAT4YOU.track({event:"export.before",type:e}),STAT4YOU.doActionIfRegistered(function(){STAT4YOU.track({event:"export.after",type:e}),n.trigger("export",{type:e})})},exportPng:function(t){this._export(t,"png")},exportSvg:function(t){this._export(t,"svg")},exportPdf:function(t){this._export(t,"pdf")}})}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset"),STAT4YOU.modules.dataset.Main=function(t){this.initialize(t)},STAT4YOU.modules.dataset.Main.prototype={_defaultOptions:{showPage:!0,showOptions:!0,showExport:!0,animation:!0},initialize:function(t){var e=this;t=_.defaults(t,this._defaultOptions),e.attributes=t.attributes,e.metadata=new STAT4YOU.dataset.Metadata(t.dataset),e.filterOptions=new STAT4YOU.widget.FilterOptions({metadata:e.metadata});var n="canvasTable",i=[n,"column","line"];e.metadata.metadata.geographicalCoverage&&i.push("map"),e.filterOptionsByType=_.chain(i).map(function(t){var n=new STAT4YOU.widget.FilterOptions({metadata:e.metadata});return[t,n]}).object().value(),this._setInitialFilterRestrictions(),e.dataset=new STAT4YOU.dataset.Dataset({metadata:e.metadata,filterOptions:this.filterOptions}),e.pageView=t.showPage?new STAT4YOU.modules.dataset.PageView({el:t.el,metadata:e.metadata,attributes:e.attributes}):new STAT4YOU.modules.dataset.DatasetWidgetPageView({el:t.el,metadata:e.metadata,attributes:e.attributes,showOptions:t.showOptions,showExport:t.showExport}),e.pageView.render(),e.optionsModel=new STAT4YOU.modules.dataset.OptionsModel;var r=e.pageView.$el.find(".dataset-export");e.exportView=new STAT4YOU.modules.dataset.ExportView({el:r,model:e.optionsModel}),e.exportView.render(),e.permalinkBuilder=new STAT4YOU.modules.dataset.PermalinkBuilder({filterOptions:e.filterOptions,optionsModel:e.optionsModel});var a=e.pageView.$el.find(".dataset-header-actions");e.datasetActionsView=new STAT4YOU.modules.dataset.DatasetActionsView({el:a,filterOptions:e.filterOptions,permalinkBuilder:e.permalinkBuilder}),e.datasetActionsView.render(),e.router=new STAT4YOU.modules.dataset.Router({defaultType:n}),e.exporter=new STAT4YOU.svg.Exporter,e.infoView=new App.modules.dataset.DatasetInfoView({dataset:e.dataset,datasetAttributes:e.attributes}),e.filterSidebarView=new App.widget.filter.sidebar.FilterSidebarView({filterOptions:e.filterOptions,optionsModel:e.optionsModel}),e.orderSidebarView=new App.widget.filter.sidebar.OrderSidebarView({filterOptions:e.filterOptions,optionsModel:e.optionsModel}),e.visualizationView=new App.modules.dataset.DatasetVisualizationView({dataset:e.dataset,filterOptions:e.filterOptions,optionsModel:e.optionsModel,veElements:i});var s=[e.infoView,e.filterSidebarView,e.orderSidebarView],o=e.pageView.$el.find(".dataset-sidebar-visualization-container");this.sidebarView=new App.components.sidebar.SidebarView({el:o,sideViews:s,contentView:e.visualizationView}),this.sidebarView.render(),this.sidebarView.state.toggleSideView("filterSidebar"),e.fullScreen=new STAT4YOU.FullScreen({container:o}),e.visualizationView.on("enterFullScreen",function(){e.fullScreen.enterFullScreen()}),e.visualizationView.on("exitFullScreen",function(){e.fullScreen.exitFullScreen()}),e.fullScreen.on("didEnterFullScreen",function(){e.visualizationView._didEnterFullScreen(),e.optionsModel.set("fullScreen",!0),STAT4YOU.track({event:"dataset.fullScreen.open",datasetUri:e.metadata.getUri()})}),e.fullScreen.on("didExitFullScreen",function(){e.visualizationView._didExitFullScreen(),e.optionsModel.set("fullScreen",!1),STAT4YOU.track({event:"dataset.fullScreen.close",datasetUri:e.metadata.getUri()})}),e.filterOptions.on("change reset",function(){e.datasetActionsView.render()}),e.optionsModel.on("change:type",function(t,n){e.datasetActionsView.render(),STAT4YOU.track({event:"dataset.view",veType:n,datasetUri:e.metadata.getUri()})}),e.router.on("changeChart",function(t){if(t.selection){var n=new STAT4YOU.modules.dataset.DatasetPermalink({identifier:t.selection}),i=n.fetch();i.success(function(){var i=JSON.parse(n.get("content"));e.filterOptionsByType[t.type].importSelection(i),e.optionsModel.set("type",t.type)})}else e.optionsModel.set("type",t.type)}),e.optionsModel.on("change",function(){e.exportView.render()}),e.optionsModel.on("change:type",function(t,n){e.router.navigate("type/"+n);var i=t.previousAttributes().type;i&&e.filterOptionsByType[i].reset(e.filterOptions,!0),e.filterOptions.reset(e.filterOptionsByType[n],!1),e.dataset.data.updateFilterOptions(),e.visualizationView.loadVisualElement(n)}),e.exportView.on("export",function(t){var n=e.pageView.$el.find("svg").get(0);e.exporter.processSvgElement(n,t.type)}),STAT4YOU.modules.signin.SigninView.prototype.redirectUrl=function(){return e.permalinkBuilder.createPermalink({relative:!0})},$(function(){Backbone.history.start()})},_setInitialFilterRestrictions:function(){this.filterOptionsByType.line.setZoneLengthRestriction({left:{value:1,preferedType:"TIME_DIMENSION"},top:1}),this.filterOptionsByType.column.setSelectedCategoriesRestriction({horizontal:5,columns:10})}}}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset"),STAT4YOU.modules.dataset.OptionsModel=Backbone.Model.extend({defaults:{type:"",fullScreen:!1,filter:!1,options:!0}})}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset"),STAT4YOU.modules.dataset.OptionsView=Backbone.View.extend({template:STAT4YOU.templateManager.get("dataset/dataset-options"),initialize:function(t){this.optionsModel=t.optionsModel,this.buttons=t.buttons,this.listenTo(this.optionsModel,"change:type",this.render)},events:{"click .change-visual-element button":"changeType","click .visual-element-options-edit":"clickFilterLoader","click .visual-element-options-fs":"clickFullScreen"},destroy:function(){this.stopListening()},fullScreenIsAllowed:function(){var t=this.optionsModel.get("type");return"table"!==t},isFullScreen:function(){return this.optionsModel.get("fullScreen")},isFilter:function(){return this.optionsModel.get("filter")},isOptions:function(){return this.optionsModel.get("options")},render:function(){var t=this.optionsModel.get("type"),e=this.fullScreenIsAllowed(),n=this.isFullScreen(),i=this.isFilter(),r=this.isOptions();if(r){var a=this.buttons;this.isFullScreen()&&(a=_.without(a,"table"));var s=_.map(a,function(e){return{title:I18n.t("filter.button."+e),type:e,btnClass:e===t?"active":""}}),o={veTypeButton:s,filter:{active:i,btnClass:i?"active":""},fullScreen:{visible:e,active:n,btnClass:n?"active":""}};this.$el.html(this.template(o))}},changeType:function(t){this.isFilter()&&$(document).trigger("closeFilter");var e=$(t.currentTarget),n=e.data("type");this.optionsModel.set("type",n)},clickFilterLoader:function(){this.isFilter()||this.trigger("launchFilter")},clickFullScreen:function(){this.isFullScreen()?this.trigger("exitFullScreen"):this.fullScreenIsAllowed&&this.trigger("launchFullScreen")}})}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset");var t=["IBESTAT","EC"];STAT4YOU.modules.dataset.PageView=Backbone.View.extend({template:STAT4YOU.templateManager.get("dataset/dataset-page"),initialize:function(t){this.metadata=t.metadata,this.attributes=t.attributes},_providerHasImg:function(){return _.contains(t,this.metadata.getProvider())},render:function(){var t={metadata:this.metadata.toJSON(),providerHasImg:this._providerHasImg(),attributes:this.attributes};return this.$el.html(this.template(t)),$(".dataset-header-title").dotdotdot({watch:window}),this}})}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset"),STAT4YOU.modules.dataset.DatasetWidgetPageView=Backbone.View.extend({template:STAT4YOU.templateManager.get("dataset/dataset-widget-page"),initialize:function(t){this.metadata=t.metadata,this.attributes=t.attributes},render:function(){var t={metadata:this.metadata.toJSON(),attributes:this.attributes,showOptions:this.options.showOptions,showExport:this.options.showExport};return this.$el.html(this.template(t)),this}})}(),function(){"use strict";App.namespace("App.modules.dataset");var t=["IBESTAT","EC"];App.modules.dataset.DatasetInfoView=Backbone.View.extend({template:App.templateManager.get("dataset/dataset-info"),id:"info",title:"Info",icon:"icon-info",initialize:function(t){this.dataset=t.dataset,this.datasetAttributes=t.datasetAttributes},_providerHasImg:function(){return _.contains(t,this.dataset.metadata.getProvider())},render:function(){var t={metadata:this.dataset.metadata.toJSON(),providerHasImg:this._providerHasImg(),attributes:this.datasetAttributes};this.$el.html(this.template(t))}})}(),function(){"use strict";STAT4YOU.namespace("App.modules.dataset"),App.modules.dataset.DatasetVisualizationView=Backbone.View.extend({template:App.templateManager.get("dataset/dataset-visualization"),initialize:function(t){this.container=t.container,this.dataset=t.dataset,this.filterOptions=t.filterOptions,this.optionsModel=t.optionsModel,this.veElements=t.veElements},_initializeVisualElements:function(){var t={el:this.$(".dataset-visualization-visual-element"),dataset:this.dataset,filterOptions:this.filterOptions,animation:this.options.animation};this.ve={column:new STAT4YOU.VisualElement.ColumnChart(t),pie:new STAT4YOU.VisualElement.PieChart(t),line:new STAT4YOU.VisualElement.LineChart(t),canvasTable:new STAT4YOU.VisualElement.CanvasTable(t),map:new STAT4YOU.VisualElement.Map(t)},this.ve.map.on("didLoadVe",this._hideSpinner,this)},_initializeFullScreen:function(){},_showSpinner:function(){var t=STAT4YOU.resourceContext+"images/loadingSpinner.gif";this.$dataSpinner=$("<div class='spinner'><img src='"+t+"'/></div>");var e=this.$el,n=e.height()/2-this.$dataSpinner.height()/2,i=e.width()/2-this.$dataSpinner.width()/2;this.$dataSpinner.css({top:n,left:i}),e.prepend(this.$dataSpinner)},_hideSpinner:function(){this.$dataSpinner&&(this.$dataSpinner.remove(),this.$dataSpinner=null)},loadVisualElement:function(t){var e=this.currentElement;this._removeCurrentElement(),this.currentElement=t,this.ve[this.currentElement].updatingDimensionPositions(e),this.ve[this.currentElement].load()},load:function(){this.loadVisualElement(this.currentElement)},_removeCurrentElement:function(){var t=this._getCurrentVe();t&&(t.destroy(),this.$(".dataset-visualization-visual-element").empty())},_getCurrentVe:function(){return this.currentElement?this.ve[this.currentElement]:void 0},enterFullScreen:function(){this.trigger("enterFullScreen")},exitFullScreen:function(){this.trigger("exitFullScreen")},_willEnterFullScreen:function(){this.trigger("willEnterFullScreen")},_didEnterFullScreen:function(){var t=this._getCurrentVe();t.resizeFullScreen(),this.trigger("didEnterFullScreen")},_willExitFullScreen:function(){this.trigger("willExitFullScreen")},_didExitFullScreen:function(){var t=this._getCurrentVe();t.resizeFullScreen(),this.trigger("didExitFullScreen")},render:function(){var t={};this.$el.html(this.template(t)),this._initializeVisualElements(),this._initializeFullScreen(),this.optionsView=new STAT4YOU.modules.dataset.OptionsView({optionsModel:this.optionsModel,el:this.$(".dataset-visualization-options-bar"),buttons:this.veElements}),this.optionsView.render(),this.optionsView.on("launchFullScreen",this.enterFullScreen,this),this.optionsView.on("exitFullScreen",this.exitFullScreen,this)}})}(),function(){STAT4YOU.namespace("STAT4YOU.modules.dataset"),STAT4YOU.modules.dataset.Router=Backbone.Router.extend({initialize:function(t){this.defaultType=t.defaultType},routes:{"type/:type":"changeChart","type/:type/selection/:selection":"changeChart","":"defaultChart"},changeChart:function(t,e){this.trigger("changeChart",{type:t,selection:e})},defaultChart:function(){this.trigger("changeChart",{type:this.defaultType,selection:void 0})}})}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.dataset.data.ApiResponse"),STAT4YOU.dataset.data.ApiResponse=function(t){return this.response=t,this._mult=null,this._transformIdToPos=null,this._transformPosToPosArrays=null,this._createMult(),this._setUpTransformIdToPos(),this._setUpTransformPosToPosArray(),this},STAT4YOU.dataset.data.ApiResponse.prototype={getDataById:function(t){var e,n=this.response;e=_.isObject(t)?_.map(n.data.format[0],function(e){return t[e]}):t;var i=this._transformIdToPos.apply(this,[e]);return this.getDataByPos(i)},getDataByPos:function(t){var e=this,n=e.response,i=0;return i=e._transformPosToPosArrays.apply(e,[t]),{value:n.data.observation[i]}},_createMult:function(){for(var t=this,e=this.response,n=[],i=1,r=e.data.format[1],a=r.length,s=0;a>s;s++)i*=s>0?r[a-s]:1,n.push(i);t._mult=n},_setUpTransformIdToPos:function(){var t=this,e="",n=this.response,i=n.data.format[0].length;e+="var ds = this.response, pos = [];\n";for(var r=0;i>r;r++)e+="pos.push(ds.data.dimension[ds.data.format[0]["+r+"]].representationIndex[id["+r+"]]);\n";e+="return pos",t._transformIdToPos=Function("id",e)},_setUpTransformPosToPosArray:function(){var t=this,e="",n=this.response,i=t._mult,r=n.data.format[0].length;e+="var ds = this.response, res = 0;\n",e+="res = ";for(var a=0;r>a;a++)e+=i[a]+"*pos["+(r-a-1)+"]",r-1>a&&(e+=" + ");e+=";\n",e+="return res;",t._transformPosToPosArrays=Function("pos",e)}}}(),function(){"use strict";var t=STAT4YOU.dataset.data.ApiResponse;STAT4YOU.namespace("STAT4YOU.dataset.data.ApiRequest"),STAT4YOU.dataset.data.ApiRequest=function(t){this.metadata=t.metadata,this.dimensions=t.dimensions,this.ajaxManager=t.ajaxManager},STAT4YOU.dataset.data.ApiRequest.prototype={url:function(){return STAT4YOU.apiContext+"/datasets/"+this.metadata.getProvider()+"-"+this.metadata.getIdentifier()
},queryParams:function(){var t={};return this.dimensions&&(t.dim=_.map(this.dimensions,function(t){return t.id+":"+t.representations.join("|")}).join(":")),t.fields="-metadata",t},isFetching:function(){return this.xhrId?this.ajaxManager.isFetching(this.xhrId):!0},fetch:function(e){var n,i={url:this.url(),data:this.queryParams(),success:function(n){var i=new t(n);_.isFunction(e)&&e(i)}};return this.ajaxManager?this.xhrId=n=this.ajaxManager.add(i):n=$.ajax(i),n}}}(),function(){"use strict";STAT4YOU.namespace("dataset.data.NumberFormatter"),STAT4YOU.dataset.data.NumberFormatter={},STAT4YOU.dataset.data.NumberFormatter.strToNumber=function(t){var e=null;if(_.isString(t)){var n=t.replace(",","."),i=parseFloat(n);isNaN(i)||(e=i)}return e},STAT4YOU.dataset.data.NumberFormatter.strNumberToLocalizedString=function(t){var e,n,i=_.defaults({},I18n.lookup("number.format"),{separator:".",delimiter:",",strip_insignificant_zeros:!1}),r=parseFloat(t),a=0>r,s=t.replace("-",""),o=s.split("."),l=[];for(r=o[0],e=o[1];r.length>0;)l.unshift(r.substr(Math.max(0,r.length-3),3)),r=r.substr(0,r.length-3);if(n=l.join(i.delimiter),e&&(n+=i.separator+e),a&&(n="-"+n),i.strip_insignificant_zeros){var c={separator:RegExp(i.separator.replace(/\./,"\\.")+"$"),zeros:/0+$/};n=n.replace(c.zeros,"").replace(c.separator,"")}return n}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.dataset.data.BigDataCacheBlock"),STAT4YOU.dataset.data.BigDataCacheBlock=function(t){this.index=t.index,this.origin=t.origin,this.size=t.size},STAT4YOU.dataset.data.BigDataCacheBlock.prototype={isFetching:function(){return!_.isUndefined(this.apiRequest)&&_.isUndefined(this.apiResponse)&&this.apiRequest.isFetching()},isReady:function(){return!_.isUndefined(this.apiRequest)&&!_.isUndefined(this.apiResponse)},getRegion:function(){return{left:{begin:this.origin.x,end:this.origin.x+this.size.width},top:{begin:this.origin.y,end:this.origin.y+this.size.height}}},clearData:function(){this.apiRequest=void 0,this.apiResponse=void 0}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.dataset.data.BigDataCache");var t=STAT4YOU.dataset.data.BigDataCacheBlock;STAT4YOU.dataset.data.BigDataCache=function(t){this.rows=t.rows,this.columns=t.columns,this.size=t.size||30,this.capacity=t.capacity||50,this.simultaneousRequests=t.simultaneousRequests||9,this.lru=new LRUCache(this.capacity),this.ajaxManager=$.manageAjax.create("dataset.data.BigDataCache",{queue:"limit",cacheResponse:!0,queueLimit:9}),this.initialize()},STAT4YOU.dataset.data.BigDataCache.prototype={initialize:function(){this.initializeCacheBlockSize(),this.cacheSize={},this.cacheSize.rows=Math.ceil(this.rows/this.cacheBlockSize.rows),this.cacheSize.columns=Math.ceil(this.columns/this.cacheBlockSize.columns),this.cache=Array(this.cacheSize.rows);for(var t=0;this.cacheSize.rows>t;t++){this.cache[t]=Array(this.cacheSize.columns);for(var e=0;this.cacheSize.columns>e;e++)this._initializeCacheBlock(t,e)}},_initializeCacheBlock:function(e,n){var i={};i.index={x:n,y:e},i.origin={x:n*this.cacheBlockSize.columns,y:e*this.cacheBlockSize.rows},i.size={width:this.cacheBlockSize.columns,height:this.cacheBlockSize.rows},this.cache[e][n]=new t(i)},initializeCacheBlockSize:function(){this.cacheBlockSize={},this.rows>this.size&&this.columns>this.size?(this.cacheBlockSize.rows=this.size,this.cacheBlockSize.columns=this.size):this.rows>this.size?(this.cacheBlockSize.rows=Math.ceil(this.size*this.size/this.columns),this.cacheBlockSize.columns=this.columns,this.cacheBlockSize.rows>this.rows&&(this.cacheBlockSize.rows=this.rows)):this.columns>this.size?(this.cacheBlockSize.rows=this.rows,this.cacheBlockSize.columns=Math.ceil(this.size*this.size/this.rows),this.cacheBlockSize.columns>this.columns&&(this.cacheBlockSize.columns=this.columns)):(this.cacheBlockSize.rows=this.rows,this.cacheBlockSize.columns=this.columns)},_cacheIndexForCell:function(t){return{x:Math.floor(t.x/this.cacheBlockSize.columns),y:Math.floor(t.y/this.cacheBlockSize.rows)}},cacheBlockForCell:function(t){var e=this._cacheIndexForCell(t);return this._cacheBlockForIndex(e)},_blockKeyForLru:function(t){return t.index.x+"#"+t.index.y},_updateLRU:function(t){var e=this._blockKeyForLru(t),n=this.lru.get(e);if(!n){var i=this.lru.put(e,t);i&&this.cache[i.value.index.y][i.value.index.x].clearData()}},_cacheBlockForIndex:function(e){if(e.x>=0&&e.x<this.cacheSize.columns&&e.y>=0&&e.y<this.cacheSize.rows){var n=this.cache[e.y][e.x];if(!n){var i={};i.index={x:e.x,y:e.y},i.origin={x:e.x*this.cacheBlockSize.columns,y:e.y*this.cacheBlockSize.rows},i.size={width:this.cacheBlockSize.columns,height:this.cacheBlockSize.rows},n=this.cache[e.y][e.x]=new t(i)}return this._updateLRU(n),n}},neighbourCacheBlocks:function(t){var e=[];return e.push(this._cacheBlockForIndex({x:t.index.x,y:t.index.y-1})),e.push(this._cacheBlockForIndex({x:t.index.x+1,y:t.index.y-1})),e.push(this._cacheBlockForIndex({x:t.index.x+1,y:t.index.y})),e.push(this._cacheBlockForIndex({x:t.index.x+1,y:t.index.y+1})),e.push(this._cacheBlockForIndex({x:t.index.x,y:t.index.y+1})),e.push(this._cacheBlockForIndex({x:t.index.x-1,y:t.index.y+1})),e.push(this._cacheBlockForIndex({x:t.index.x-1,y:t.index.y})),e.push(this._cacheBlockForIndex({x:t.index.x-1,y:t.index.y-1})),_.compact(e)},getAllCacheBlocks:function(){return _.flatten(this.cache,!0)},isBlockReady:function(t){return _.isUndefined(t)?!1:t.isReady()}}}(),function(){"use strict";var t=STAT4YOU.dataset.data.ApiRequest,e=STAT4YOU.dataset.data.BigDataCache;STAT4YOU.namespace("STAT4YOU.dataset.data.Data"),STAT4YOU.dataset.data.BigData=function(t){this.metadata=t.metadata,this.filterOptions=t.filterOptions,this._initializeAjaxManager(),this.updateFilterOptions()},STAT4YOU.dataset.data.BigData.prototype={isAllSelectedDataLoaded:function(){for(var t=this.cache.getAllCacheBlocks(),e=!0,n=0;t.length>n;n++){var i=t[n];this.cache.isBlockReady(i)||(e=!1)}return e},loadAllSelectedData:function(){var t=this.cache.getAllCacheBlocks(),e=_.map(t,this._loadCacheBlock,this);return $.when.apply($,e)},updateFilterOptions:function(){this._initializeCache()},_initializeCache:function(){this.cache=new e(this.filterOptions.getTableSize())},_initializeAjaxManager:function(){this.ajaxManager=$.manageAjax.create("DataSourceDatasetCache",{queue:"limit",cacheResponse:!0,queueLimit:9})},getDataById:function(t){var e=this.filterOptions.getCellForCategoryIds(t);return this.getDataByCell(e)},getNumberDataById:function(t){return STAT4YOU.dataset.data.NumberFormatter.strToNumber(this.getDataById(t))},_getCategoryIdsForCacheBlock:function(t){var e=t.getRegion();return this.filterOptions.getCategoryIdsForRegion(e)},_loadCacheBlock:function(e,n){var i=this,r=new $.Deferred;if(this.cache.isBlockReady(e))r.resolve();else if(!e.isFetching()){var a=this._getCategoryIdsForCacheBlock(e),s={metadata:this.metadata,dimensions:a};n&&(s.ajaxManager=this.ajaxManager),e.apiRequest=new t(s),e.apiRequest.fetch(function(t){e.apiResponse=t,i.trigger("hasNewData"),r.resolve()})}return r.promise()},getDataByCell:function(t){var e,n=this.cache.cacheBlockForCell(t);if(this.cache.isBlockReady(n)){var i=this.filterOptions.getCategoryIdsForCell(t);e=n.apiResponse.getDataById(i).value}else this._loadCacheBlock(n,!0);var r=this.cache.neighbourCacheBlocks(n);return _.each(r,function(t){this._loadCacheBlock(t,!0)},this),e}},_.extend(STAT4YOU.dataset.data.BigData.prototype,Backbone.Events)}(),function(){"use strict";var t=STAT4YOU.dataset.data.ApiRequest;STAT4YOU.namespace("STAT4YOU.dataset.data.Data"),STAT4YOU.dataset.data.Data=function(t){this.metadata=t.metadata,this.filterOptions=t.filterOptions},STAT4YOU.dataset.data.Data.prototype={loadAllSelectedData:function(){var e=this,n=new $.Deferred;return this.request?n.resolve():(this.request=new t({metadata:this.metadata}),this.request.fetch(function(t){e.apiResponse=t,n.resolve(),e.trigger("hasNewData")})),n.promise()},updateFilterOptions:function(){},isAllSelectedDataLoaded:function(){return!_.isUndefined(this.apiResponse)},_getApiResponse:function(){return this.apiResponse?this.apiResponse:(this.loadAllSelectedData(),void 0)},getDataById:function(t){var e=this._getApiResponse();return e?e.getDataById(t).value:void 0},getNumberDataById:function(t){return STAT4YOU.dataset.data.NumberFormatter.strToNumber(this.getDataById(t))},getDataByCell:function(t){var e=this._getApiResponse();if(e){var n=this.filterOptions.getCategoryIdsForCell(t);return this.getDataById(n)}}},_.extend(STAT4YOU.dataset.data.Data.prototype,Backbone.Events)}(),function(){"use strict";var t=STAT4YOU.dataset.data.Data,e=STAT4YOU.dataset.data.BigData;STAT4YOU.namespace("STAT4YOU.dataset.Dataset"),STAT4YOU.dataset.Dataset=function(t){this.initialize(t)},STAT4YOU.dataset.Dataset.prototype={initialize:function(n){this.metadata=n.metadata,this.filterOptions=n.filterOptions,this.data=this.isBigData()?new e(n):new t(n),this.initializeEvents()},initializeEvents:function(){var t=this;this.filterOptions.on("change reset",function(){t.data.updateFilterOptions()})},isBigData:function(){return this.metadata.getTotalObservations()>1e3}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.dataset.Metadata"),STAT4YOU.dataset.Metadata=function(t){this.initialize(t)},STAT4YOU.dataset.Metadata.prototype={initialize:function(t){this.selectedLanguages=t.selectedLanguages,this.metadata=t.metadata,this.initializeLocalesIndex()},initializeLocalesIndex:function(){var t=this.selectedLanguages;this.localesIndex={primary:t.indexOf(I18n.locale),secondary:t.indexOf(I18n.defaultLocale)},-1===this.localesIndex.primary&&(this.localesIndex.primary=void 0),-1===this.localesIndex.secondary&&(this.localesIndex.secondary=void 0)},localizeLabel:function(t){if(t){var e;return this.localesIndex.primary&&(e=t[this.localesIndex.primary]),!e&&this.localesIndex.secondary&&(e=t[this.localesIndex.secondary]),e||(e=_.first(_.compact(t))),e}},getIdentifier:function(){return this.metadata.identifier},getLanguages:function(){return this.getIdsAndLocalizedLabels(this.metadata.language)},getProvider:function(){return this.metadata.creatorAcronym},getTitle:function(){return this.localizeLabel(this.metadata.title)},getDescription:function(){return this.localizeLabel(this.metadata.description)},getLicense:function(){return this.localizeLabel(this.metadata.license)},getLicenseUrl:function(){return this.metadata.licenseUrl},getPublisher:function(){return this.metadata.publisher},getUri:function(){return this.metadata.uri},getIdsAndLocalizedLabels:function(t){var e=_.map(t.id,function(e){return{id:e,label:this.localizeLabel(t.label[e])}},this);return e},getDimensions:function(){var t=this.metadata.dimension,e=_.map(t.id,function(e,n){var i=!_.isUndefined(t.representation.hierarchy)&&!_.isUndefined(t.representation.hierarchy[e]);return{id:e,label:this.localizeLabel(t.label[e]),type:t.type[n],hierarchy:i}},this);return e},getRepresentations:function(t){var e=this.metadata.dimension.representation,n=this,i=[];return _.each(e.id[t],function(r){var a={id:r,label:n.localizeLabel(e.label[t][r]),normCode:e.normCode[t][r]};e.hierarchy&&e.hierarchy[t]&&e.hierarchy[t][r]&&(a.parent=e.hierarchy[t][r]),i.push(a)}),i},getDimensionsAndRepresentations:function(){var t=this,e=this.getDimensions();return _.each(e,function(e){e.representations=t.getRepresentations(e.id)}),e},getCategories:function(){return this.getIdsAndLocalizedLabels(this.metadata.category)},getDates:function(){return{release:this.metadata.releaseDate,modification:this.metadata.modificationDate,providerRelease:this.metadata.providerReleaseDate,providerModification:this.metadata.providerModificationDate,frecuency:this.metadata.frecuency}},getMeasureDimension:function(){if(this.metadata.measureDimension){var t={};return t.id=this.metadata.measureDimension,t.id&&(t.label=this.localizeLabel(this.metadata.dimension.label[t.id]),t.representation=this.getRepresentations(t.id)),t}},getTotalObservations:function(){var t=this.getDimensionsAndRepresentations(),e=_.chain(t).map(function(t){return t.representations.length}).reduce(function(t,e){return t*e},1).value();return e},getProviderCitation:function(){return this.metadata.providerCitation},toJSON:function(){return{citation:this.getProviderCitation(),provider:this.getProvider(),title:this.getTitle(),description:this.getDescription(),categories:this.getCategories(),languages:this.getLanguages(),license:this.getLicense(),licenseUrl:this.getLicenseUrl(),dates:this.getDates(),measureDimension:this.getMeasureDimension(),dimensions:this.getDimensions()}},getCategoryByNormCode:function(t,e){var n=this.getRepresentations(t),i=_.find(n,function(t){return t.normCode===e});return i},getTimeDimensions:function(){var t=this.getDimensions();return _.where(t,{type:"TIME_DIMENSION"})}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.components.tooltip"),STAT4YOU.components.tooltip.Tooltip=function(t){this.initialize(t)},STAT4YOU.components.tooltip.Tooltip.prototype={delay:300,initialize:function(t){this._mouseMove=_.bind(this._mouseMove,this),this._initializeHtml(),this.setEl(t.el),this.delegate=t.delegate},destroy:function(){this.$tooltip.remove(),this._detachEvents()},setEl:function(t){this._detachEvents(),this.$el=$(t);var e=this.$el.parents(".full-screen:eq(0)"),n=e.length>0;this.$container=n?e:this.$body,this.$viewPort=n?e:this.$container,this.$container.append(this.$tooltip),this._attachEvents()},_initializeHtml:function(){this.$innerTooltip=$('<div class="tooltip-inner"></div>'),this.$tooltip=$('<div class="tooltip in"></div>').append(this.$innerTooltip),this.$body=$("body")},_attachEvents:function(){this.$container.on("mousemove.tooltip",this._mouseMove)},_detachEvents:function(){this.$container&&this.$container.off(".tooltip")},_getViewportSize:function(){return{width:this.$viewPort.width(),height:this.$viewPort.height()}},_getOffset:function(){return this.$el.offset()},_getPosition:function(t){var e={},n={width:this.$tooltip.outerWidth(),height:this.$tooltip.outerHeight()},i=this._getViewportSize(),r={x:i.width-n.width,y:i.height-n.height},a=this._getOffset();return e.x=t.x+a.left+10,e.y=t.y+a.top+10,e.x>r.x&&(e.x=e.x-10-n.width),e.y>r.y&&(e.y=e.y-10-n.height),e},_update:function(t){var e=t.x>0&&t.y>0&&t.x<this.$el.width()&&t.y<this.$el.height();if(e){var n=this.delegate.getTitleAtMousePosition(t);if(n){if(_.isUndefined(this.lastTitle)&&!this.timer){var i=this;this.timer=setTimeout(function(){i.timer=void 0,i.visible=!0,i._update(i.lastPoint)},this.delay)}if(this.visible){this.$innerTooltip.text(n);var r=this._getPosition(t);this.$tooltip.css({display:"block",top:r.y,left:r.x})}}else this._hide(),this.visible=!1;this.lastTitle=n,this.lastPoint=t}else this._hide()},_hide:function(){this.$tooltip.css("display","none")},_mouseMove:function(t){var e=this._getOffset(),n={x:t.pageX-e.left,y:t.pageY-e.top};this._update(n)}}}(),function(){"use strict";App.namespace("App.components.sidebar"),App.components.sidebar.SidebarStateModel=Backbone.Model.extend({defaults:{width:350,minWidth:100,visible:!0},initialize:function(t){this.sideViewsIds=t.sideViewsIds},toggleSideView:function(t){_.contains(this.sideViewsIds,t)&&(this.get("currentSideView")===t?this.set("currentSideView",void 0):this.set("currentSideView",t))},validate:function(t){return t.width<t.minWidth?"width min size is "+t.minWidth:void 0}})}(),function(){"use strict";App.namespace("App.components.sidebar"),App.components.sidebar.SidebarView=Backbone.View.extend({template:App.templateManager.get("components/sidebar/sidebar-container"),initialize:function(t){this.sideViews=t.sideViews,this.contentView=t.contentView;var e={sideViewsIds:_.pluck(this.sideViews,"id")};this.state=new App.components.sidebar.SidebarStateModel(e),this.listenTo(this.state,"change:currentSideView",this._onChangeCurrentSideView),this.listenTo(this.state,"change:width",this._updateSidebar),this.listenTo(this.state,"change:visible",this._updateSidebar),_.bindAll(this,"_onClickSplitter","_onMousemoveSplitter","_onMouseupSplitter")},events:{"click .sidebar-menu-item":"_onClickMenuItem","mousedown .sidebar-splitter":"_onClickSplitter"},_onClickMenuItem:function(t){t.preventDefault();var e=$(t.currentTarget),n=e.data("view-id");this.state.toggleSideView(n)},_updateSidebar:function(){var t=this.state.get("width"),e=this.$menu.width();this.state.get("visible")?(this.$sidebar.css({width:t,left:e}),this.$content.css("padding-left",e+t)):(this.$sidebar.css({width:t,left:-t}),this.$content.css("padding-left",e))},_onClickSplitter:function(t){t.preventDefault(),this._splitterInitialState={pageX:t.pageX,width:this.$sidebar.outerWidth()};var e=this.$el.hasClass("full-screen"),n=e?this.$el:$("body");this.$overlay=$("<div>").addClass("sidebar-overlay").appendTo(n).on("mousemove.sidebar",this._onMousemoveSplitter).on("mouseup.sidebar",this._onMouseupSplitter)},_onMousemoveSplitter:function(t){if(t.stopImmediatePropagation(),1===t.which){var e=t.pageX-this._splitterInitialState.pageX,n=this._splitterInitialState.width+e;this.state.set("width",n,{validate:!0})}else this._onMouseupSplitter()},_onMouseupSplitter:function(){this.$overlay&&this.$overlay.remove()},_getSideView:function(t){return _.find(this.sideViews,function(e){return e.id===t})},_onChangeCurrentSideView:function(t,e){var n=this.$(".sidebar-container");if(e){var i=this._getSideView(e);i.render(),n.toggleClass("sidebar-slideRight",!0),this.state.set("visible",!0),this.$("li[data-view-id='"+e+"']").addClass("active")}else this.state.set("visible",!1);var r=t.previous("currentSideView");if(r){var a=this._getSideView(r);a.destroy&&a.destroy(),this.$("li[data-view-id='"+r+"']").removeClass("active")}},render:function(){var t={};t.menuItems=_.map(this.sideViews,function(t){return{id:t.id,icon:t.icon,title:t.title}}),this.$el.html(this.template(t)),this.$menu=this.$(".sidebar-menu"),this.$sidebar=this.$(".sidebar-sidebar"),this.$sidebarContent=this.$(".sidebar-sidebar-content"),this.$content=this.$(".sidebar-content"),_.each(this.sideViews,function(t){t.setElement(this.$sidebarContent)},this),this.sideViews[0].render(),this.contentView.setElement(this.$content),this.contentView.render()}})}(),function(){"use strict";App.namespace("App.components.searchbar"),App.components.searchbar.SearchbarView=Backbone.View.extend({template:App.templateManager.get("components/searchbar/searchbar"),initialize:function(t){this.modelAttribute=t.modelAttribute},events:{"change input":"onChangeSearchInput","click .searchbar-clear":"onClearSearchInput"},render:function(){var t={};this.$el.html(this.template(t)),this.$searchInput=this.$("input"),this.$searchInput.keyup(_.bind(this.onChangeSearchInput,this))},updateModelAttribute:function(t){this.model.set(this.modelAttribute,t)},onClearSearchInput:function(t){t.preventDefault(),this.$searchInput.val(""),this.updateModelAttribute("")},onChangeSearchInput:function(){var t=this.$searchInput.val();this.model.set(this.modelAttribute,t),this.updateModelAttribute(t)}})}(),function(){"use strict";App.namespace("App.components.accordion"),App.components.accordion.AccordionView=Backbone.Marionette.CompositeView.extend({constructor:function(){Backbone.Marionette.CompositeView.prototype.constructor.apply(this,arguments),this.vent=new Backbone.Wreqr.EventAggregator,this.vent.on("AccordionView:SaveSelection",this.saveSelection,this),this.on("before:item:added",function(t){t.vent=this.vent})},saveSelection:function(t){if(this.currentSelectedModel){var e=this.children.findByModel(this.currentSelectedModel);e&&e.itemDeselect()}this.currentSelectedModel=t}})}(),function(){"use strict";App.namespace("App.components.accordion"),App.components.accordion.AccordionItemView={itemDeselect:function(){this.minimize(),this.model.set({selected:!1})},itemSelect:function(){this.model.get("selected")!==!0&&(this.model.set({selected:!0}),this.maximize(),this.vent.trigger("AccordionView:SaveSelection",this.model))},minimize:function(){this.$el.find(this.elContent).removeClass("in")},maximize:function(){this.$el.find(this.elContent).addClass("in")}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.widget.FilterOptionsDimensionRestriction"),STAT4YOU.widget.FilterOptionsDimensionRestriction=function(t){var e=-1;t&&(e=t.restriction||e,this._categories=t.categories,this._selectedCategories=t.selectedCategories||_.clone(this._categories)),this.setRestriction(e);var n=["setSelectedCategories","setRestriction","setRestrictionWithPriorityOrder","toggleCategorySelection","unselectAll","selectAll","select","unselect"];_.each(n,function(t){this[t]=_.wrap(this[t],this._selectedCategoriesEventWrapper)},this)},STAT4YOU.widget.FilterOptionsDimensionRestriction.prototype={getRestriction:function(){return this._restriction},getSelectedCategories:function(){return _.clone(this._selectedCategories)},setSelectedCategories:function(t){this._selectedCategories=_.clone(t),this._applyRestriction()},setRestriction:function(t){if(!_.isNumber(t))throw Error("Not Number");this._restriction=t,this._applyRestriction()},setRestrictionWithPriorityOrder:function(t,e){this._restriction=t,this._needRemoveElements()&&(this._selectedCategories=_.sortBy(this._selectedCategories,function(t){return _.indexOf(e,t)}).reverse().splice(0,this._restriction))},_needRemoveElements:function(){var t=!1;if(this._restriction>=0){var e=this._selectedCategories.length-this._restriction;t=e>0}return t},_applyRestriction:function(){this._needRemoveElements()&&(this._selectedCategories=this._selectedCategories.splice(0,this._restriction))},isCategorySelected:function(t){return-1!==_.indexOf(this._selectedCategories,t)},toggleCategorySelection:function(t){var e=this.isCategorySelected(t);return e?this._unselectCategory(t):this._selectCategory(t),!e},_unselectCategory:function(t){var e=_.indexOf(this._selectedCategories,t);-1!==e&&this.count()>1&&this._selectedCategories.splice(e,1)},_selectCategory:function(t){this._selectedCategories.push(t),this._needRemoveElements()&&this._selectedCategories.shift()},clone:function(){var t={selectedCategories:_.clone(this._selectedCategories),categories:_.clone(this._categories),restriction:this._restriction};return new STAT4YOU.widget.FilterOptionsDimensionRestriction(t)},unselectAll:function(t){if(t){var e=this._selectedCategories.length-1;this._selectedCategories=[this._selectedCategories.sort()[e]]}else this._selectedCategories=this._selectedCategories.slice(0,1)},selectAll:function(){this._selectedCategories=_.union(this._selectedCategories,this._categories),this._applyRestriction()},areAllSelected:function(){return-1===this._restriction||this._categories.length<this._restriction?this._selectedCategories.length===this._categories.length:this._selectedCategories.length===this._restriction},count:function(){return this._selectedCategories.length},select:function(t){this._selectedCategories=_.unique(t.concat(this._selectedCategories)),this._applyRestriction()},unselect:function(t){var e=this._selectedCategories[0];this._selectedCategories=_.difference(this._selectedCategories,t),0===this._selectedCategories.length&&(this._selectedCategories=[e])},_selectedCategoriesEventWrapper:function(t){var e=_.toArray(arguments),n=_.clone(this._selectedCategories),i=e.slice(1),r=t.apply(this,i),a=_.clone(this._selectedCategories),s=_.last(e),o=_.difference(n,a);_.each(o,function(t){this.trigger("unselect:"+t,{category:t})},this);var l=_.difference(a,n);return _.each(l,function(t){this.trigger("select:"+t,{category:t})},this),(l.length>0||o.length>0)&&(_.isObject(s)&&s.silent||this.trigger("change")),r}},_.extend(STAT4YOU.widget.FilterOptionsDimensionRestriction.prototype,Backbone.Events)}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.widget.FilterOptionsTable"),STAT4YOU.widget.FilterOptionsTable=function(){throw"This is only a mixin"},STAT4YOU.widget.FilterOptionsTable.prototype={_initializeTableInfo:function(){var t=this,e={},n=this.getFixedDimensions();_.each(n,function(n){var i=t.getSelectedCategories(n.id);e[n.id]=i[0].id}),this.tableInfo={top:this._initializeTableInfoForDimensions(this.getTopDimensions()),left:this._initializeTableInfoForDimensions(this.getLeftDimensions()),fixed:e}},_initializeTableInfoForDimensions:function(t){var e=this;if(t.length>0){var n={ids:[],representationsValues:[],representationsIds:[],representationsLengths:[]};return _.each(t,function(t){n.ids.push(t.id);var i=e.getSelectedCategories(t.id);"TIME_DIMENSION"===t.type&&(i=_.sortBy(i,function(t){return t.normCode}).reverse()),n.representationsValues.push(_.pluck(i,"label")),n.representationsIds.push(_.pluck(i,"id")),n.representationsLengths.push(i.length)}),n.representationsMult=STAT4YOU.Table.Utils.rightProductAcumulate(n.representationsLengths),n}return{ids:[void 0],representationsValues:[[""]],representationsIds:[[void 0]],representationsLengths:[1],representationsMult:[1]}},getCategoryIdsForCell:function(t){var e,n,i,r,a={};for(e=0;this.tableInfo.left.ids.length>e;e++)n=Math.floor(t.y/this.tableInfo.left.representationsMult[e])%this.tableInfo.left.representationsLengths[e],i=this.tableInfo.left.representationsIds[e][n],r=this.tableInfo.left.ids[e],r&&(a[r]=i);for(e=0;this.tableInfo.top.ids.length>e;e++)n=Math.floor(t.x/this.tableInfo.top.representationsMult[e])%this.tableInfo.top.representationsLengths[e],i=this.tableInfo.top.representationsIds[e][n],r=this.tableInfo.top.ids[e],r&&(a[r]=i);return _.extend(a,this.tableInfo.fixed),a},getCellForCategoryIds:function(t){var e=this,n={x:0,y:0};return _.each(t,function(t,i){var i=e._getDimension(i);if(i){var r=e._getZoneFromPosition(i.position);if("left"===r||"top"===r){var a=_.indexOf(e.tableInfo[r].ids,i.id),s=_.indexOf(e.tableInfo[r].representationsIds[a],t),o=e.tableInfo[r].representationsMult[a];"left"===r?n.y=n.y+o*s:"top"===r&&(n.x=n.x+o*s)}}}),n},getCategoryIdsForRegion:function(t){for(var e=[],n=t.left.begin;t.left.end>n;n++)for(var i=t.top.begin;t.top.end>i;i++)e.push(this.getCategoryIdsForCell({x:n,y:i}));var r={};return _.each(e,function(t){_.each(t,function(t,e){r[e]||(r[e]=[]),r[e].push(t)})}),r=_.map(r,function(t,e){return{id:e,representations:_.unique(t)}})},_dimensionsTotalSize:function(t){var e=_.reduce(t,function(t,e){return t*e},1);return e},getTableSize:function(){return{columns:this._dimensionsTotalSize(this.tableInfo.top.representationsLengths),rows:this._dimensionsTotalSize(this.tableInfo.left.representationsLengths)}}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.widget.FilterOptions");var t=STAT4YOU.widget.FilterOptionsDimensionRestriction,e=["change","select","unselect"];STAT4YOU.widget.FilterOptions=function(t){this.initialize(t)},STAT4YOU.widget.FilterOptions.prototype={initialize:function(t){this.metadata=t.metadata,this._initializeDimensions(),this._initializeDimensionsMap(),this._initializePositionLimits(),this._initializePositions(),this._initializeDimensionRestrictions(),this._initializeTableInfo(),this.setZoneLengthRestriction({left:-1,top:-1}),this.setSelectedCategoriesRestriction({})},_initializeDimensions:function(){this.dimensions=this.metadata.getDimensionsAndRepresentations();for(var t=0;this.dimensions.length>t;t++){var e=this.dimensions[t];e.number=t;for(var n=0;e.representations.length>n;n++){var i=e.representations[n];i.number=n}}},_initializeDimensionsMap:function(){var t=this;this.dimensionsMap={},_.each(this.dimensions,function(e){t.dimensionsMap[e.id]=e})},_initializePositionLimits:function(){this.positionLimit={left:{begin:0,end:19},sectors:{begin:0,end:0},map:{begin:0,end:0},horizontal:{begin:0,end:0},columns:{begin:20,end:20},lines:{begin:20,end:20},top:{begin:20,end:39},fixed:{begin:40,end:59}}},_initializePositions:function(){for(var t=Math.ceil(this.dimensions.length/2),e=this.dimensions.slice(0,t),n=this.dimensions.slice(t),i=0;e.length>i;i++)e[i].position=this.positionLimit.left.begin+i;for(var i=0;n.length>i;i++)n[i].position=this.positionLimit.top.begin+i},_initializeDimensionRestrictions:function(){_.each(this.dimensions,function(e){var n=_.pluck(e.representations,"id");e.restriction=new t({categories:n})},this),this._bindDimensionRestrictionsEvents()},_bindDimensionRestrictionsEvents:function(){_.each(this.dimensions,function(t){t.restriction.on("all",function(n,i){var r=n.substring(0,n.indexOf(":"));_.contains(e,r)?(i.dimension=t,this.trigger(r+":dimension:"+t.id+":category:"+i.category,i)):this.trigger.apply(this,arguments)},this),t.restriction.on("change",this._initializeTableInfo,this)},this)},_simplifyDimensions:function(t){var e=this;return _.map(t,function(t){return e._simplifyDimension(t)})},_simplifyDimension:function(t){var e=_.pick(t,"id","number","label","type","hierarchy");return e.categories=this._simplifyCategories(t),e},_simplifyCategories:function(t){var e=this;return _.map(t.representations,function(n){return e._simplifyCategory(t,n)})},_simplifyCategory:function(t,e){var n=_.extend({},e);return n.state=t.restriction.isCategorySelected(e.id)?1:0,n},getDimensions:function(){return this._simplifyDimensions(this.dimensions)},_isValidZone:function(t){return"left"===t||"sectors"===t||"map"===t||"horizontal"===t||"columns"===t||"lines"===t||"top"===t||"fixed"===t},_getDimensionsInZone:function(t){if(!this._isValidZone(t))throw"Invalid Zone";var e=this.positionLimit[t];return _.filter(this.dimensions,function(t){return t.position>=e.begin&&t.position<=e.end})},_getDimensionsNotInZone:function(t){var e=this.positionLimit[t];return _.filter(this.dimensions,function(t){return t.position<e.begin||t.position>e.end})},_sortDimensionsByPosition:function(t){return _.sortBy(t,function(t){return t.position})},getLeftDimensions:function(){var t=this._getDimensionsInZone("left");return t=this._sortDimensionsByPosition(t),this._simplifyDimensions(t)},getSectorsDimension:function(){return this.getLeftDimensions()[0]},getMapDimension:function(){return this.getLeftDimensions()[0]},getHorizontalDimension:function(){return this.getLeftDimensions()[0]},getColumnsDimension:function(){return this.getTopDimensions()[0]},getLinesDimension:function(){return this.getTopDimensions()[0]},getDimensionsInZone:function(t){var e=this._getDimensionsInZone(t);return e=this._sortDimensionsByPosition(e),this._simplifyDimensions(e)},getTopDimensions:function(){var t=this._getDimensionsInZone("top");return t=this._sortDimensionsByPosition(t),this._simplifyDimensions(t)},getFixedDimensions:function(){var t=this._getDimensionsInZone("fixed");return t=this._sortDimensionsByPosition(t),this._simplifyDimensions(t)},getDimensionsSize:function(){return this.dimensions.length()},_getDimension:function(t){return _.isString(t)?this.dimensionsMap[t]:_.isNumber(t)?this.dimensions[t]:void 0},getDimension:function(t){var e=this._getDimension(t);return this._simplifyDimension(e)},getCategories:function(t){var e=this;if(void 0===t)return _.map(this.dimensions,function(t){return e._simplifyCategories(t)});var n=this._getDimension(t);return n?this._simplifyCategories(n):void 0},getCategory:function(t,e){var t=this._getDimension(t);if(t){var n;return _.isString(e)?n=_.find(t.representations,function(t){return t.id===e}):_.isNumber(e)&&(n=t.representations[e]),this._simplifyCategory(t,n)}},getSelectedCategories:function(t){if(void 0!==t){var e=this._getDimension(t);if(e){var n=this.getCategories(t);return _.filter(n,function(t){return 1===t.state})}}},toggleCategoryState:function(t,e){var n=this._getDimension(t),i=this.getCategory(t,e),r=n.restriction.toggleCategorySelection(i.id);return r},getZoneFromDimension:function(t){var e=this._getDimension(t);return this._getZoneFromPosition(e.position)},_getZoneFromPosition:function(t){return t>=this.positionLimit.left.begin&&this.positionLimit.left.end>=t?"left":t>=this.positionLimit.top.begin&&this.positionLimit.top.end>=t?"top":t>=this.positionLimit.fixed.begin&&this.positionLimit.fixed.end>=t?"fixed":void 0},_removeDimensionCurrentZone:function(t,e){var n=t.position,i=this._getZoneFromPosition(t.position);t.position=-1,_.each(this._getDimensionsInZone(i),function(t){t.position>n&&(t.position=t.position-1)}),this._initializeTableInfo(),e||this.trigger("change")
},_appendDimensionToZone:function(t,e,n){var i=this._getDimensionsInZone(e),r=_.max(i,function(t){return t.position});t.position=r!=-1/0?r.position+1:this.positionLimit[e].begin,this._applySelectedCategoriesRestriction(n),this._initializeTableInfo(),n||this.trigger("change")},_changeDimensionZone:function(t,e,n){var t=this._getDimension(t);this._removeDimensionCurrentZone(t,n),this._appendDimensionToZone(t,e,n)},changeDimensionZone:function(t,e,n){var i=this.getZoneFromDimension(t);if(i!==e){var r=this.getDimensionsInZone(e),a=this.zoneLengthRestriction[e]>0,s=this.zoneLengthRestriction[i]>0;(a||s)&&this._changeDimensionZone(_.last(r).id,i,!0),this._changeDimensionZone(t,e,!0),this._initializeTableInfo(),n||this.trigger("change")}},swapDimensions:function(t,e,n){var t=this._getDimension(t),e=this._getDimension(e);if(t.id!==e.id){var i=t.position;t.position=e.position,e.position=i,this._applySelectedCategoriesRestriction(!0),this._initializeTableInfo(),n||this.trigger("change")}},_dimensionToMoveLeftOrder:function(){return _.flatten([this.getLeftDimensions(),this.getTopDimensions(),this.getFixedDimensions()])},_dimensionToMoveTopInOrder:function(){return _.flatten([this.getTopDimensions(),this.getLeftDimensions(),this.getFixedDimensions()])},setZoneLengthRestriction:function(t){this.zoneLengthRestriction=t,this._applyZoneLengthRestriction()},_applyZoneLengthRestriction:function(t){var e=this,n=this.zoneLengthRestriction,i=_.isNumber(n.left)?{value:n.left}:n.left,r=_.isNumber(n.top)?{value:n.top}:n.top,a={},s=function(t,e){return t?e.type===t:!0},o=function(t){return _.isUndefined(a[t.number])},l=function(n,i,r,l){var c=_.chain(n).filter(o).filter(_.bind(s,this,r)).take(i).map(function(n){return e._changeDimensionZone(n.number,l,t),a[n.number]=n.number,n}).value();return c.length},c=i.value>0?i.value:0,u=r.value>0?r.value:0,h=i.type?i.type:i.preferedType,d=r.type?r.type:r.preferedType,f=l(this._dimensionToMoveLeftOrder(),c,h,"left"),p=l(this._dimensionToMoveTopInOrder(),u,d,"top");i.preferedType&&l(this._dimensionToMoveLeftOrder(),c-f,void 0,"left"),r.preferedType&&l(this._dimensionToMoveTopInOrder(),u-p,void 0,"top");var g=[];i.value>=0&&g.push(this.getLeftDimensions()),r.value>=0&&g.push(this.getTopDimensions()),_.chain(g).flatten().filter(o).each(function(n){e._changeDimensionZone(n.number,"fixed",t)}),t||this.trigger("zoneLengthRestriction",{restriction:n})},_applySelectedCategoriesRestriction:function(t){var e=this;_.each(this._selectedCategoriesRestriction,function(n,i){var r=e._getDimensionsInZone(i);_.each(r,function(e){if("TIME_DIMENSION"===e.type){var i=_.chain(e.representations).filter(function(t){return null!=t.normCode}).pluck("id").value();e.restriction.setRestrictionWithPriorityOrder(n,i,{silent:t})}else e.restriction.setRestriction(n,{silent:t})})})},setSelectedCategoriesRestriction:function(t){this._selectedCategoriesRestriction=_.extend(t,{fixed:1}),this._applySelectedCategoriesRestriction(),this.trigger("selectedCategoriesRestriction",{restriction:t})},selectAllCategories:function(t){var e=this._getDimension(t);e.restriction.selectAll()},unselectAllCategories:function(t){var t=this._getDimension(t),e="TIME_DIMENSION"===t.type;t.restriction.unselectAll(e)},areAllCategoriesSelected:function(t){var e=this._getDimension(t);return e.restriction.areAllSelected()},selectCategories:function(t,e){var n=this._getDimension(t);return n.restriction.select(e)},unselectCategories:function(t,e){var n=this._getDimension(t);return n.restriction.unselect(e)},clone:function(){var t=new STAT4YOU.widget.FilterOptions({metadata:this.metadata});return t.reset(this),t},reset:function(t,e){this.metadata=t.metadata,this.positionLimit=_.clone(t.positionLimit),this._selectedCategoriesRestriction=_.extend({},t._selectedCategoriesRestriction),this.dimensions=_.map(t.dimensions,function(t){var e=_.pick(t,"id","label","number","position","type","hierarchy");return e.representations=_.map(t.representations,function(t){return _.clone(t)}),e.restriction=t.restriction.clone(),e}),this._initializeDimensionsMap(),this._initializeTableInfo(),this._bindDimensionRestrictionsEvents(),e||this.trigger("reset")},exportSelection:function(){var t={};return _.each(this.dimensions,function(e){t[e.id]={position:e.position,selectedCategories:e.restriction.getSelectedCategories()}}),t},importSelection:function(t){var e=this;_.each(t,function(t,n){var i=e._getDimension(n);i.position=t.position}),this.setSelectedCategoriesRestriction({left:-1,top:-1}),_.each(t,function(t,n){var i=e._getDimension(n);i.restriction.setSelectedCategories(t.selectedCategories)}),this._initializeDimensionsMap(),this._initializeTableInfo()}},_.defaults(STAT4YOU.widget.FilterOptions.prototype,STAT4YOU.widget.FilterOptionsTable.prototype,Backbone.Events)}(),STAT4YOU.namespace("STAT4YOU.widget.filter"),STAT4YOU.widget.filter.FilterDimensionView=Backbone.View.extend({_templateDimension:STAT4YOU.templateManager.get("widget/filter/popup/filter-dimension"),_templateDimensionCategories:STAT4YOU.templateManager.get("widget/filter/popup/filter-dimension-categories"),_templateDimensionCheckbox:STAT4YOU.templateManager.get("widget/filter/popup/filter-dimension-checkbox"),initialize:function(t){var e=this;this.zone=t.zone,this.$el.on("keyup","input",function(t){e._handleFilterCategories(t)})},render:function(t){return this.dimNum=t.number,this.$dimension=$(this._templateDimension(t)),this.$el.html(this.$dimension),this._renderCategories(t),this._renderCheckbox(t),this},_renderCategories:function(){var t=this.model.getDimension(this.dimNum);if("fixed"!=this.zone||this._isExpanded||(t.categories=this.model.getSelectedCategories(this.dimNum)),this.text){var e=this._filterDimensionCategories(t.categories);t.categories=e}return this.$categories=this._templateDimensionCategories(t),$(".div-categories-container",this.$el).html(this.$categories),this._refreshingScrollbar(!1),this},_renderCheckbox:function(){var t=this.model.getDimension(this.dimNum),e=this.model.areAllCategoriesSelected(t.number);return this.$checkbox=this._templateDimensionCheckbox({allSelected:e}),$(".select-categories",this.$el).remove(),this.$el.append(this.$checkbox),this},events:{"click .triangle-right":"_expandCategories","click .button-categories-big":"collapseCategories","click .select-categories.unselectall":"_handleSelectAllCategories","click .select-categories.selectall":"_handleUnselectAllCategories","click .div-category":"_handleToggleCategory","click .div-category-clicked":"_handleToggleCategory"},_handleFilterCategories:function(t){var e=$(t.currentTarget).val();return this._filterCategories(e),!1},_handleSelectAllCategories:function(){return this.model.selectAllCategories(this.dimNum),this._renderCategories(),this._renderCheckbox(),!1},_handleUnselectAllCategories:function(){return this.model.unselectAllCategories(this.dimNum),this._renderCategories(),this._renderCheckbox(),!1},_handleToggleCategory:function(t){var e=$(t.currentTarget),n=e.parents('[class*="div-dimension-short"]');return this._toggleCategory(n.data("number"),e.data("number")),!1},_removeHighlights:function(t){$(t).removeClass("highlight-long"),$(t).removeClass("highlight-short")},_refreshingScrollbar:function(t){var e=$(".div-categories-advanced-container-big",this.$el);if("left"!==this.zone&&"fixed"!==this.zone&&!t){var n=e.width()-20;e.width(n)}if(this._scrollBar=$(".div-categories-big").jScrollPane({showArrows:!1}),"left"!==this.zone&&"fixed"!==this.zone){var n=e.width();e.width(n+20)}},_setExpandedCategoriesStylesGeneral:function(){var t=$(".div-categories-advanced-container",this.$el),e=$(".div-categories",this.$el);$(".categories-options",this.$el);var n=$(".triangle-right",this.$el);t.removeClass("div-categories-advanced-container"),t.addClass("div-categories-advanced-container-big"),e.removeClass("div-categories"),e.addClass("div-categories-big"),n.removeClass("triangle-right"),n.addClass("triangle-top"),this._refreshingScrollbar(!0),"left"===this.zone&&this._setExpandedCategoriesStylesLeft(),this._isExpanded=!0,this._renderCategories()},_setExpandedCategoriesStylesLeft:function(){var t=$(".div-categories-advanced-container-big",this.$el),e=$(".div-categories-big",this.$el),n=$(".categories-options",this.$el),i=Math.round(.6*this.$el.width()+5);t.css("height",i),e.height(i-n.outerHeight());var r=this.$el.outerWidth();t.css("left",r)},_expandCategories:function(){return this.trigger("willExpandCategories",this),this._setExpandedCategoriesStylesGeneral(),this.trigger("didExpandCategories",this),!1},_toggleCategory:function(t,e){this.model.toggleCategoryState(t,e),this._renderCategories(),this._renderCheckbox()},_filterCategories:function(t){this.text=t,this._renderCategories()},_filterDimensionCategories:function(t){var e=this,n=_.filter(t,function(t){var n=t.label.toLowerCase();e.text=e.text.toLowerCase();var i=n.indexOf(e.text);return-1!==i});return n},collapseCategories:function(){if(this._isExpanded){this._isExpanded=!1;var t=this._scrollBar.data("jsp");t.scrollToY(0),t.destroy(),this._scrollBar=null;var e=$(".div-categories-advanced-container-big",this.$el),n=$(".div-categories-big",this.$el);$(".categories-options",this.$el);var i=$(".triangle-top",this.$el);e.removeClass("div-categories-advanced-container-big"),e.addClass("div-categories-advanced-container"),n.removeClass("div-categories-big"),n.addClass("div-categories");var r=e.width();e.width(r-20),i.removeClass("triangle-top"),i.addClass("triangle-right"),this._removeHighlights(n.get(0)),n.attr("style",""),e.attr("style",""),this.text=void 0,$(".categories-filter").val(""),this._renderCategories()}return!1}}),STAT4YOU.namespace("STAT4YOU.widget.filter"),STAT4YOU.widget.filter.FilterView=Backbone.View.extend({_templateExternalContainer:STAT4YOU.templateManager.get("widget/filter/popup/filter-external-container"),_templateTableContainers:STAT4YOU.templateManager.get("widget/filter/popup/filter-table-containers"),_templateColumnContainers:STAT4YOU.templateManager.get("widget/filter/popup/filter-column-containers"),_templateLineContainers:STAT4YOU.templateManager.get("widget/filter/popup/filter-line-containers"),_templatePieContainers:STAT4YOU.templateManager.get("widget/filter/popup/filter-pie-containers"),_templateMapContainers:STAT4YOU.templateManager.get("widget/filter/popup/filter-map-containers"),initialize:function(t){this.filterOptions=t.filterOptions},_renderZones:function(){switch(this.type){case"table":this._renderTableContainers(),this._renderTableDimensions();break;case"canvasTable":this._renderTableContainers(),this._renderTableDimensions();break;case"column":this._renderColumnContainers(),this._renderColumnDimensions();break;case"line":this._renderLineContainers(),this._renderLineDimensions();break;case"pie":this._renderPieContainers(),this._renderPieDimensions();break;case"map":this._renderMapContainers(),this._renderMapDimensions()}},_renderExternalContainer:function(){return this.$filterContainer=$(this._templateExternalContainer()),this.$el.append(this.$filterContainer),this},_renderTableContainers:function(){return this.$filterZonesContainers=$(this._templateTableContainers()),this.$filterContainer.append(this.$filterZonesContainers),this._adjustingLeftContainer(),this},_renderColumnContainers:function(){return this.$filterZonesContainers=$(this._templateColumnContainers()),this.$filterContainer.append(this.$filterZonesContainers),this},_renderLineContainers:function(){return this.$filterZonesContainers=$(this._templateLineContainers()),this.$filterContainer.append(this.$filterZonesContainers),this},_renderPieContainers:function(){return this.$filterZonesContainers=$(this._templatePieContainers()),this.$filterContainer.append(this.$filterZonesContainers),this},_renderMapContainers:function(){return this.$filterZonesContainers=$(this._templateMapContainers()),this.$filterContainer.append(this.$filterZonesContainers),this},_renderTableDimensions:function(){var t={dims:this.model.getLeftDimensions()},e={dims:this.model.getTopDimensions()},n={dims:this.model.getFixedDimensions()};return _.each(t.dims,function(t){this._createDimension(t,"#div-left-dimensions")},this),_.each(e.dims,function(t){this._createDimension(t,"#div-top-dimensions")},this),_.each(n.dims,function(t){this._createDimension(t,"#div-fixed-dimensions")},this),this},_renderColumnDimensions:function(){var t=this.model.getHorizontalDimension(),e=this.model.getColumnsDimension(),n={dims:this.model.getFixedDimensions()};return this._createDimension(t,"#div-dimension-long1"),this._createDimension(e,"#div-dimension-long2"),_.each(n.dims,function(t){this._createDimension(t,"#div-fixed-dimensions")},this),this},_renderLineDimensions:function(){var t=this.model.getHorizontalDimension(),e=this.model.getLinesDimension(),n={dims:this.model.getFixedDimensions()};return this._createDimension(t,"#div-dimension-long1"),this._createDimension(e,"#div-dimension-long2"),_.each(n.dims,function(t){this._createDimension(t,"#div-fixed-dimensions")},this),this},_renderPieDimensions:function(){var t=this.model.getSectorsDimension(),e={dims:this.model.getFixedDimensions()};return this._createDimension(t,"#div-dimension-long1"),_.each(e.dims,function(t){this._createDimension(t,"#div-fixed-dimensions")},this),this},_renderMapDimensions:function(){var t=this.model.getMapDimension(),e={dims:this.model.getFixedDimensions()};return this._createDimension(t,"#div-dimension-long1"),_.each(e.dims,function(t){"GEOGRAPHIC_DIMENSION"===t.type?this._createDimension(t,"#div-fixed-dimensions"):this._createDimensionStatic(t,"#div-fixed-dimensions")},this),this},events:{"click #close":"close","click #button-options":"save","click #button-cancel-filter":"close","click .div-dimension-short":"_handleClickDim","click .div-dimension-short-static":"_handleClickDim","dragstart .div-dimension-short":"_handleDragstart","selectstart .div-dimension-short":"_handleSelectstart","dragover .div-dimension-short":"_handleDragover","dragleave .div-dimension-short":"_handleDragleave","dragend .div-dimension-short":"_handleDragend","dragenter .div-dimension-container":"_handleDragenter","dragover .div-dimension-container":"_handleDragover","dragleave .div-dimension-container":"_handleDragleave","dragend .div-dimension-container":"_handleDragend","drop .div-dimension-container":"_handleDrop","dragenter .div-dimension-long":"_handleDragenter","dragover .div-dimension-long":"_handleDragover","dragleave .div-dimension-long":"_handleDragleave","dragend .div-dimension-long":"_handleDragend","drop .div-dimension-long":"_handleDrop","dragenter .div-dimension-short":"_handleDragenter","drop .div-dimension-short":"_handleDrop","click #filter-container":"_handleCollapseCategories"},_handleClickDim:function(){return!1},_handleDragstart:function(t){var e=$(t.currentTarget);return e.addClass("shaded"),t.originalEvent.dataTransfer.effectAllowed="move",t.originalEvent.dataTransfer.setData("Text",e.attr("id")),!0},_handleSelectstart:function(t){var e=t.currentTarget;return e.dragDrop(),!0},_handleDragover:function(t){var e=$(t.currentTarget);return e.hasClass("div-dimension-short")?e.addClass("highlight-short"):e.addClass("highlight-long"),t.originalEvent.dataTransfer.dropEffect="move",!1},_handleDragleave:function(t){var e=t.currentTarget;return this._removeHighlights(e),!1},_handleDragend:function(){var t=this,e=$(".div-dimension-short").get();return $.each(e,function(e,n){$(n).removeClass("shaded"),t._removeHighlights(n)}),!1},_handleDragenter:function(){return!1},_handleDrop:function(t){var e=t.currentTarget,n=t.originalEvent.dataTransfer.getData("Text"),i=$("#"+n).get(0),r=this._detectMovementAndElementsToMove(e),a=r.targetDimension,s=r.newParent;return r.swapFlag?this.model.swapDimensions($(i).data("number"),$(a).data("number")):this.model.changeDimensionZone($(i).data("number"),$(s).data("zone")),this._removeHighlights(e),this.render(),!1},_handleWillExpandCategories:function(t){return _.each(this._dimensionViews,function(e){e!==t&&e.collapseCategories()}),!1},_handleCollapseCategories:function(){return _.each(this._dimensionViews,function(t){t.collapseCategories()}),!1},_detectMovementAndElementsToMove:function(t){var e=1,n=null,i=null;$(t).hasClass("div-dimension-long")||$(t).hasClass("div-dimension-container")?(n=t,"table"===this.type||"canvasTable"===this.type?(e=0,i=null):i=$(n).children(".div-dimension-short")):(n=$(t).parents(".div-dimension-long, .div-dimension-container").get(0),i=$(t).get(0));var r={};return r.swapFlag=e,r.newParent=n,r.targetDimension=i,r},_removeHighlights:function(t){$(t).removeClass("highlight-long"),$(t).removeClass("highlight-short")},_createDimension:function(t,e){var n=$(e),i=$("<div id='div-dimension-short"+t.number+"' class='div-dimension-short' draggable='true'  data-number='"+t.number+"'/>").appendTo(n),r=new STAT4YOU.widget.filter.FilterDimensionView({model:this.model,el:i,zone:n.data("zone")});r.render(t),this._dimensionViews.push(r)},_createDimensionStatic:function(t,e){var n=$(e),i=$("<div id='div-dimension-short"+t.number+"' class='div-dimension-short-static' draggable='false'  data-number='"+t.number+"'/>").appendTo(n),r=new STAT4YOU.widget.filter.FilterDimensionView({model:this.model,el:i,zone:n.data("zone")});r.render(t),this._dimensionViews.push(r)},_addDimensionListeners:function(){var t=this;_.each(this._dimensionViews,function(e){e.on("willExpandCategories",t._handleWillExpandCategories,t)})},_adjustingLeftContainer:function(){var t=$("#filter-container"),e=$("#div-left-dimensions"),n=$("#div-top-dimensions"),i=t.offset().top,r=t.height(),a=i+r,s=25,o=n.offset().top,l=a-o-s;e.css("width",l),e.css("top",o-i+l+3)},_initializeTmpFilterOptions:function(){this.model=this.filterOptions.clone();var t=this;this.filterOptions.on("selectedCategoriesRestriction",function(e){t.model.setSelectedCategoriesRestriction(e.restriction)}),this.filterOptions.on("zoneLengthRestriction",function(e){t.model.setZoneLengthRestriction(e.restriction)})},_destroyTmpFilterOptions:function(){this.filterOptions.off("selectedCategoriesRestriction"),this.filterOptions.off("zoneLengthRestriction"),this.model=null},launch:function(t){this._initializeTmpFilterOptions(),this.render(t)},render:function(t){this.$filterContainer&&this.$filterContainer.remove(),this._dimensionViews=[],this._renderExternalContainer(),t&&(this.type=t),this._renderZones(),this._addDimensionListeners()},save:function(){this.$filterContainer.remove(),this.filterOptions.reset(this.model),this._destroyTmpFilterOptions(),this.trigger("saveFilter")},close:function(){this._destroyTmpFilterOptions(),this.$filterContainer.remove(),this.trigger("closeFilter")}}),function(){"use strict";App.namespace("App.widget.filter.sidebar"),App.widget.filter.sidebar.FilterSidebarDimensionStateModel=Backbone.Model.extend({defaults:{categoryFilter:"",collapsed:!0,maxHeight:150},isFiltering:function(){var t=this.get("categoryFilter");return t.trim().length>0},isVisibleWithCategoryFilter:function(t){var e=this.get("categoryFilter"),n=!this.isFiltering()||t.toLowerCase().indexOf(e.toLowerCase())>=0;return n}})}(),function(){"use strict";App.namespace("App.widget.filter.sidebar"),App.widget.filter.sidebar.FilterSidebarCategoryView=Backbone.View.extend({template:App.templateManager.get("widget/filter/sidebar/filter-sidebar-category"),className:"filter-sidebar-category",initialize:function(t){this.filterOptions=t.filterOptions,this.stateModel=t.stateModel,this.dimension=t.dimension,this.category=t.category,this.depth=t.depth;var e="dimension:"+this.dimension.id+":category:"+this.category.id;this.listenTo(this.filterOptions,"select:"+e,this.render),this.listenTo(this.filterOptions,"unselect:"+e,this.render),this.listenTo(this.stateModel,"change:categoryFilter",this.onChangeCategoryFilter),this.subcategoryViews=[],this.visible=!0,this.expanded=!0},events:{"click .filter-sidebar-category-label":"toggleModelState","click .category-state":"toggleModelState","click .category-expand":"toggleExpanded"},setVisible:function(t){t!==this.visible&&(this.visible=t,this.$el.toggle(t))},onChangeCategoryFilter:function(){var t=this.stateModel.isVisibleWithCategoryFilter(this.category.label);this.setVisible(t)},toggleExpanded:function(t){t.preventDefault(),this.expanded=!this.expanded,_.each(this.subcategoryViews,function(t){t.setVisible(this.expanded)},this),this.render()},toggleModelState:function(){return this.filterOptions.toggleCategoryState(this.dimension.id,this.category.id),!1},_hasSubcategories:function(){return this.subcategoryViews.length>0},render:function(){var t=this.filterOptions.getCategory(this.dimension.id,this.category.id),e={category:t,hasSubcategories:this._hasSubcategories(),expanded:this.expanded,depth:this.depth};return this.$el.html(this.template(e)),this.$el.css("padding-left",35*this.depth),this.el},addSubcategoryViews:function(t){_.isArray(t)||(t=[t]),this.subcategoryViews=this.subcategoryViews.concat(t)}})}(),function(){"use strict";App.namespace("App.widget.filter.sidebar");var t=App.widget.filter.sidebar.FilterSidebarCategoryView;App.widget.filter.sidebar.FilterSidebarDimensionView=Backbone.View.extend({template:App.templateManager.get("widget/filter/sidebar/filter-sidebar-dimension"),initialize:function(t){this.dimension=t.dimension,this.filterOptions=t.filterOptions,this.optionsModel=t.optionsModel,this.stateModel=new App.widget.filter.sidebar.FilterSidebarDimensionStateModel,this.searchbar=new App.components.searchbar.SearchbarView({model:this.stateModel,modelAttribute:"categoryFilter"})},destroy:function(){this._unbindEvents(),this.remove()},events:{"click .filter-sidebar-selectAll":"_onSelectAll","click .filter-sidebar-unselectAll":"_onUnselectAll","click .filter-sidebar-dimension-title":"_onClickTitle"},_bindEvents:function(){this.listenTo(this.stateModel,"change:collapsed",this._onChangeCollapsed),this.listenTo(this.stateModel,"change:maxHeight",this._onChangeMaxHeight)},_unbindEvents:function(){this.stopListening()},_filteredCategoriesIds:function(){var t=this;return _.chain(this.filterOptions.getCategories(this.dimension.id)).filter(function(e){return t.stateModel.isVisibleWithCategoryFilter(e.label)}).pluck("id").value()},_isFixedDimension:function(){var t=this.filterOptions.getZoneFromDimension(this.dimension.id);return"fixed"===t},render:function(){this.delegateEvents(),this._unbindEvents(),this._bindEvents();var e=this.filterOptions.getZoneFromDimension(this.dimension.id),n="",i="",r={zone:e,zoneLabel:n,zoneFirstLetter:i,dimension:this.dimension,isFixedDimension:this._isFixedDimension(),state:this.stateModel.toJSON()};this.$el.html(this.template(r));var a=_.chain(this.dimension.categories).filter(function(t){return!_.isUndefined(t.parent)}).groupBy("parent").value(),s=_.filter(this.dimension.categories,function(t){return _.isUndefined(t.parent)}),o=this,l=this.$(".filter-sidebar-categories"),c=function(e,n){var i=new t({filterOptions:o.filterOptions,stateModel:o.stateModel,dimension:o.dimension,category:e,depth:n||0}),r=[i];return _.each(a[e.id],function(t){var e=c(t,n+1);i.addSubcategoryViews(e),r=r.concat(e)}),r},u=_.chain(s).map(function(t){return c(t,0)}).flatten(!0).value();return _.each(u,function(t){t.render(),l.append(t.el)}),this.searchbar.setElement(this.$(".filter-sidebar-dimension-searchbar")),this.searchbar.render(),this._onChangeMaxHeight(),this.el},getCollapsedHeight:function(){return this.$(".filter-sidebar-dimension-title").outerHeight(!0)},_onSelectAll:function(t){t.preventDefault(),this.stateModel.isFiltering()?this.filterOptions.selectCategories(this.dimension.id,this._filteredCategoriesIds()):this.filterOptions.selectAllCategories(this.dimension.id)},_onUnselectAll:function(t){t.preventDefault(),this.stateModel.isFiltering()?this.filterOptions.unselectCategories(this.dimension.id,this._filteredCategoriesIds()):this.filterOptions.unselectAllCategories(this.dimension.id)},_onClickTitle:function(){this.stateModel.set("collapsed",!this.stateModel.get("collapsed"))},_onChangeCollapsed:function(){this.$el.find(".collapse").toggleClass("in",!this.stateModel.get("collapsed"))},_onChangeMaxHeight:function(){this.$(".collapse").css("max-height",this.stateModel.get("maxHeight"))}})}(),function(){"use strict";App.namespace("App.widget.filter.sidebar");var t=App.widget.filter.sidebar.FilterSidebarDimensionView;App.widget.filter.sidebar.FilterSidebarView=Backbone.View.extend({template:App.templateManager.get("widget/filter/sidebar/filter-sidebar-view"),id:"filterSidebar",icon:"icon-filter",title:"Filtrar",initialize:function(e){this.filterOptions=e.filterOptions,this.optionsModel=e.optionsModel;var n=this.filterOptions.getDimensions();this.subviews=_.map(n,function(e){return new t({filterOptions:this.filterOptions,dimension:e})},this),_.last(this.subviews).stateModel.set("collapsed",!1)},destroy:function(){this._unbindEvents()},events:{resize:"_onResize"},_bindEvents:function(){this.listenTo(this.filterOptions,"zoneLengthRestriction",this.render),_.each(this.subviews,function(t){this.listenTo(t.stateModel,"change:collapsed",_.bind(this._onSubviewChangeCollapsed,this,t))},this)},_unbindEvents:function(){this.stopListening()},render:function(){this._unbindEvents(),this._bindEvents(),this.filterOptions.getDimensions(),this.$el.html(this.template());var t=this.$(".filter-sidebar-dimensions");_.each(this.subviews,function(e){t.append(e.render())},this),this._onResize()},_onSubviewChangeCollapsed:function(t){t.stateModel.get("collapsed")||_.chain(this.subviews).filter(function(e){return t.cid!==e.cid}).each(function(t){t.stateModel.set("collapsed",!0)})},_onResize:function(){var t=_.reduce(this.subviews,function(t,e){return t+e.getCollapsedHeight()},0),e=this.$el.height()-t;_.each(this.subviews,function(t){t.stateModel.set("maxHeight",e)})}})}(),function(){"use strict";App.namespace("App.widget.filter.sidebar");var t="drag-over";App.widget.filter.sidebar.OrderSidebarView=Backbone.View.extend({id:"orderSidebar",icon:"icon-reorder",title:"Ordenar",template:App.templateManager.get("widget/filter/sidebar/filter-order-view"),initialize:function(t){this.filterOptions=t.filterOptions,this.optionsModel=t.optionsModel},events:{"dragstart .order-sidebar-dimension.draggable":"_onDragstart","dragenter .order-sidebar-dimension.draggable":"_onDragenter","dragover .order-sidebar-dimension.draggable":"_onDragover","dragleave .order-sidebar-dimension.draggable":"_onDragleave","drop .order-sidebar-dimension.draggable":"_onDrop","dragend .order-sidebar-dimension.draggable":"_onDragend","dragenter .order-sidebar-zone.draggable":"_onDragenter","dragover .order-sidebar-zone.draggable":"_onDragover","dragleave .order-sidebar-zone.draggable":"_onDragleave","drop .order-sidebar-zone.draggable":"_onDrop"},destroy:function(){this._unbindEvents()},_bindEvents:function(){this.listenTo(this.filterOptions,"change",this.render),this.listenTo(this.filterOptions,"reset",this.render)},_unbindEvents:function(){this.stopListening()},_getCurrentChartType:function(){return this.optionsModel.get("type")},_getLabelFromZone:function(t){var e=this._getCurrentChartType();return I18n.t("filter.sidebar.order."+e+"."+t)},_renderContextForMap:function(){var t=["left","fixed"],e=_.map(t,function(t){return{id:t,label:this._getLabelFromZone(t),draggable:"left"===t,dimensions:this._dimensionsForZone(t),isFixed:"fixed"===t}},this);return{zones:e}},_renderContext:function(){var t=["top","left","fixed"],e=_.map(t,function(t){return{id:t,label:this._getLabelFromZone(t),draggable:!0,dimensions:this._dimensionsForZone(t),isFixed:"fixed"===t}},this);return{zones:e}},render:function(){this._unbindEvents(),this._bindEvents();var t="map"===this._getCurrentChartType()?this._renderContextForMap():this._renderContext();this.$el.html(this.template(t))},_dimensionsForZone:function(t){var e=this.filterOptions.getDimensionsInZone(t),n="map"===this._getCurrentChartType();return _.each(e,function(e){e.draggable=n?"GEOGRAPHIC_DIMENSION"===e.type:!0,"fixed"===t&&(e.selectedCategory=this.filterOptions.getSelectedCategories(e.id)[0])},this),e},_onDragstart:function(t){var e=$(t.currentTarget);t.originalEvent.dataTransfer.effectAllowed="move",t.originalEvent.dataTransfer.setData("Text",e.data("dimension-id"))},_onDragover:function(e){e.preventDefault();var n=$(e.currentTarget);return n.addClass(t),!1},_onDragenter:function(e){var n=$(e.currentTarget);n.addClass(t)},_onDragleave:function(e){var n=$(e.currentTarget);n.removeClass(t)},_onDrop:function(t){var e=$(t.currentTarget),n=t.originalEvent.dataTransfer.getData("Text");if(e.data("dimension-id")){var i=e.data("dimension-id");this.filterOptions.swapDimensions(n,i)}else{var r=e.data("zone");this.filterOptions.changeDimensionZone(n,r)}return!1},_onDragend:function(){this.$("."+t).removeClass(t)}})}(),function(){STAT4YOU.namespace("STAT4YOU.VisualElement"),STAT4YOU.VisualElement.Base=function(t){this.initialize(t)},STAT4YOU.VisualElement.Base.prototype={initialize:function(t){t=t||{},this.dataset=t.dataset,this.filterOptions=t.filterOptions,this.el=t.el,this.$el=$(this.el),this._initializeChartOptions()},getFixedPermutation:function(){var t=this,e={},n=this.filterOptions.getFixedDimensions();return _.each(n,function(n){var i=t.filterOptions.getSelectedCategories(n.number)[0];e[n.id]=i.id}),e},getTitle:function(){var t=this,e=this.filterOptions.getFixedDimensions(),n=_.map(e,function(e){var n=t.filterOptions.getSelectedCategories(e.number)[0];return n.label});return n.length?I18n.t("filter.text.for")+": "+n.join(", "):""},load:function(){},destroy:function(){},updatingDimensionPositions:function(){},resizeFullScreen:function(){this.destroy(),this.load()},_initializeChartOptions:function(){this._chartOptions={title:{text:null},credits:{text:"stat4you.com",href:"http://www.stat4you.com",position:{y:-5,x:-5}},legend:{layout:"horizontal",backgroundColor:"#FFFFFF",x:5,y:0,borderWidth:0,floating:!1,shadow:!0,navigation:{activeColor:"#3E576F",animation:!0,arrowSize:12,inactiveColor:"#CCC",style:{fontWeight:"bold",color:"#333",fontSize:"12px"}}},exporting:{enabled:!1}}},updateTitle:function(){this.$title.text(this.getTitle())},replaceSeries:function(t,e){for(;t.series.length>0;)t.series[0].remove(!1);_.each(e,function(e){t.addSeries(e,!1,!1)})}},_.extend(STAT4YOU.VisualElement.Base.prototype,Backbone.Events)}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.VisualElement.ColumnChart"),STAT4YOU.VisualElement.ColumnChart=function(t){this.initialize(t),this._type="column",_.extend(this._chartOptions,{chart:{animation:!1,renderTo:"",defaultSeriesType:"column",backgroundColor:"#F5F5F5"},xAxis:{categories:[]},yAxis:{title:{text:""}},tooltip:{formatter:this.tooltipFormatter},plotOptions:{series:{animation:!1},column:{pointPadding:.2,borderWidth:0,events:{legendItemClick:function(){return!1}}}},series:[]})},STAT4YOU.VisualElement.ColumnChart.prototype=new STAT4YOU.VisualElement.Base,_.extend(STAT4YOU.VisualElement.ColumnChart.prototype,{load:function(){this._bindEvents(),this.render()},destroy:function(){this._unbindEvents(),this.chart&&this.chart.destroy()},_bindEvents:function(){this.listenTo(this.filterOptions,"change",this.update);var t=_.debounce(_.bind(this._updateSize,this),200);this.$el.on("resize",function(e){e.stopPropagation(),t()})},_unbindEvents:function(){this.stopListening(),this.$el.off("resize")},updatingDimensionPositions:function(){this.filterOptions.setZoneLengthRestriction({left:1,top:1}),this.filterOptions.setSelectedCategoriesRestriction({horizontal:-1,columns:-1})},render:function(){var t=this;this.dataset.data.loadAllSelectedData().then(function(){t.$el.html(""),t.$title=$("<h3></h3>"),t.updateTitle(),t.$el.append(t.$title),t.$chartContainer=$("<div></div>");var e=t.$el.height()-t.$title.height();t.$chartContainer.height(e),t.$el.append(t.$chartContainer);var n=t.getData();t._chartOptions.series=n.series,t._chartOptions.xAxis.categories=n.xAxis,t._chartOptions.chart.renderTo=t.$chartContainer[0],t.chart=new Highcharts.Chart(t._chartOptions),t.$el.on("resize",function(){})
})},resizeFullScreen:function(){},tooltipFormatter:function(){return"<strong>"+this.series.name+", "+this.x+"</strong>:<br/>"+STAT4YOU.dataset.data.NumberFormatter.strNumberToLocalizedString(""+this.y)},getData:function(){var t=this,e={},n=this.getFixedPermutation(),i=this.filterOptions.getHorizontalDimension(),r=this.filterOptions.getColumnsDimension(),a=this.filterOptions.getSelectedCategories(i.number),s=this.filterOptions.getSelectedCategories(r.number),o=[];_.each(s,function(e){var s={};s.data=[],s.name="",_.each(a,function(a){var o={};o[i.id]=a.id,o[r.id]=e.id,_.extend(o,n);var l=t.dataset.data.getNumberDataById(o);s.data.push(l)}),s.name=e.label,o.push(s)});var l=_.pluck(a,"label");return e.series=o,e.xAxis=l,e},update:function(){this.chart.showLoading();var t=this;this.dataset.data.loadAllSelectedData().then(function(){t.chart.hideLoading(),t.updateTitle();var e=t.getData();t.replaceSeries(t.chart,e.series),t.chart.xAxis[0].setCategories(e.xAxis,!1),t.chart.redraw(!1)})},_updateSize:function(){var t=this.$el.height()-this.$title.height();this.$chartContainer.height(t),this.chart.setSize(this.$chartContainer.width(),this.$chartContainer.height(),!1)}})}(),STAT4YOU.namespace("STAT4YOU.VisualElement.LineChart"),function(){"use strict";STAT4YOU.namespace("STAT4YOU.VisualElement.LineChart"),STAT4YOU.VisualElement.LineChart=function(t){this.initialize(t),this._type="line",this._masterOptions={chart:{animation:!1,renderTo:"",type:"line",borderWidth:0,backgroundColor:null,marginLeft:5,marginRight:5},credits:{enabled:!1},tooltip:{formatter:function(){return!1}},xAxis:{labels:{formatter:function(){return this.value.substring(0,8)}},tickInterval:1},yAxis:{gridLineWidth:0,labels:{enabled:!1},title:{text:null},min:.6,showFirstLabel:!1},title:{text:null},legend:{enabled:!1},plotOptions:{series:{animation:!1},line:{lineWidth:1,marker:{enabled:!1}}},exporting:{enabled:!1}},_.extend(this._chartOptions,{chart:{animation:!1,renderTo:"",type:"line",borderWidth:0,backgroundColor:"#F5F5F5",marginRight:0},tooltip:{formatter:this.tooltipFormatter},xAxis:{labels:{}},yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},plotOptions:{line:{lineWidth:2},series:{animation:!1}}}),this._element=null,this.config={masterHeight:80,xAxisTicks:6};var e=this.dataset.metadata.getTimeDimensions().length>0,n=e?.5:0,i=e?1:.5;this.detailZoomModel=new STAT4YOU.VisualElement.line.DetailZoomModel({start:n,stop:i}),this.detailZoomModel.on("change",_.debounce(this._updateDetail,300),this)},STAT4YOU.VisualElement.LineChart.prototype={load:function(){this._bindEvents(),this.render()},destroy:function(){this._unbindEvents(),this.chart&&this.chart.destroy()},_bindEvents:function(){this.listenTo(this.filterOptions,"change",this.update);var t=_.debounce(_.bind(this._updateSize,this),200);this.$el.on("resize",function(e){e.stopPropagation(),t()})},_unbindEvents:function(){this.stopListening(),this.$el.off("resize")},updatingDimensionPositions:function(){this.filterOptions.setZoneLengthRestriction({left:1,top:1}),this.filterOptions.setSelectedCategoriesRestriction({horizontal:-1,columns:-1})},tooltipFormatter:function(){return"<strong>"+this.series.name+", "+this.x+"</strong>:<br/>"+STAT4YOU.dataset.data.NumberFormatter.strNumberToLocalizedString(""+this.y)},render:function(){var t=this;this.dataset.data.loadAllSelectedData().then(function(){t.$el.empty(),t.$title=$("<h3></h3>"),t.updateTitle(),t.$el.append(t.$title),t._renderContainers(),t._renderMaster(),t._renderDetail()})},_renderContainers:function(){var t=$(this.el).height()-this.config.masterHeight-this.$title.height();this.$detailContainer=$('<div id="detail-container">').css({height:t}).appendTo(this.el),this.$masterContainer=$('<div id="master-container">').css({position:"absolute",top:t+this.$title.height(),height:this.config.masterHeight,width:"100%"}).appendTo(this.el)},_renderMaster:function(){this.getData(),this.detailZoomModel.set("step",1/this.data.xAxis.length),this._masterOptions.chart.renderTo=this.$masterContainer[0],this._masterOptions.series=this.data.series,this._masterOptions.xAxis.categories=this.data.xAxis,this._masterOptions.xAxis.tickInterval=Math.ceil(this.data.xAxis.length/this.config.xAxisTicks),this.masterChart=new Highcharts.Chart(this._masterOptions),this.detailZoomView=new STAT4YOU.VisualElement.line.DetailZoomView({model:this.detailZoomModel,$targetEl:this.$masterContainer}),this.detailZoomView.render()},_renderDetail:function(){var t=this.getDetailData();this._chartOptions.chart.renderTo=this.$detailContainer[0],this._chartOptions.series=t.series,this._chartOptions.xAxis.categories=t.xAxis,this._chartOptions.xAxis.min=t.min,this._chartOptions.xAxis.max=t.max,this._chartOptions.xAxis.tickInterval=t.tickInterval,this.detailChart=new Highcharts.Chart(this._chartOptions)},_updateSize:function(){var t=$(this.el).height()-this.config.masterHeight-this.$title.height();this.$detailContainer.css({height:t}),this.$masterContainer.css({top:t+this.$title.height()}),this.detailChart.setSize(this.$detailContainer.width(),this.$detailContainer.height(),!1),this.masterChart.setSize(this.$masterContainer.width(),this.$masterContainer.height(),!1),this.detailZoomView.updateSize()},update:function(){var t=this;t.detailChart.showLoading(),t.masterChart.showLoading(),this.dataset.data.loadAllSelectedData().then(function(){t.detailChart.hideLoading(),t.masterChart.hideLoading(),t.updateTitle(),t._updateMaster(),t._updateDetail()})},_updateMaster:function(){var t=this.getData();this.replaceSeries(this.masterChart,t.series),this.masterChart.xAxis[0].setCategories(t.xAxis,!1),this.masterChart.redraw()},_updateDetail:function(){if(this.detailChart){var t=this.getDetailData();this.replaceSeries(this.detailChart,t.series),this.detailChart.xAxis[0].update({categories:t.xAxis,min:t.min,max:t.max,tickInterval:t.tickInterval},!1),this.detailChart.redraw(!1)}},getData:function(){var t=this,e={},n=this.getFixedPermutation(),i=this.filterOptions.getHorizontalDimension(),r=this.filterOptions.getColumnsDimension(),a=this.filterOptions.getSelectedCategories(i.number),s=this.filterOptions.getSelectedCategories(r.number),o=[];_.each(s,function(e){var s={};s.data=[],s.name="",_.each(a,function(a){var o={};o[i.id]=a.id,o[r.id]=e.id,_.extend(o,n);var l=t.dataset.data.getNumberDataById(o);s.data.push(l)}),s.name=e.label,o.push(s)});var l=_.pluck(a,"label");return e.series=o,e.xAxis=l,this.data=e,e},getDetailData:function(){var t=this.data.xAxis.length,e=Math.round(t*this.detailZoomModel.get("start")),n=Math.round(t*this.detailZoomModel.get("stop")),i=Math.max(0,e-1),r=Math.min(t,n+1),a=1;if("TIME_DIMENSION"===this.filterOptions.getHorizontalDimension().type){var s=r-i;a=Math.ceil(s/this.config.xAxisTicks)}var o={series:this.data.series,xAxis:this.data.xAxis,min:e,max:n-1,tickInterval:a};return o}},_.defaults(STAT4YOU.VisualElement.LineChart.prototype,STAT4YOU.VisualElement.Base.prototype)}(),STAT4YOU.namespace("STAT4YOU.VisualElement.PieChart"),STAT4YOU.VisualElement.PieChart=function(){var t=function(t){var e=this;this.dataset=t.dataset,this.filterOptions=t.filterOptions,this.el=t.el,e._chartOptions={chart:{renderTo:"",defaultSeriesType:"pie",plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1,marginRight:250,marginLeft:250,backgroundColor:"#F5F5F5"},credits:{text:"stat4you.com",href:"http://www.stat4you.com"},title:{text:"",style:{width:500,height:60}},subtitle:{text:"stat4you",y:80},tooltip:{formatter:function(){return"<b>"+$("<span/>").text(this.point.name).html()+"</b>: "+Math.round(10*this.percentage)/10+" %"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!0,color:"#000000",connectorColor:"#000000",formatter:function(){return $("<span/>").text(this.point.name).html()+": "+Math.round(10*this.percentage)/10+" %"}}}},series:[],exporting:{chartOptions:{title:{text:null},margin:0,style:{width:0,height:0}}}},e._type="pie"};return t.prototype=new STAT4YOU.VisualElement.Base,t.prototype.destroy=function(){this._element&&(this._element.destroy(),this._element=void 0),this.dataset.data.off(null,null,this)},t.prototype.load=function(){this.dataset.data.isAllSelectedDataLoaded()?(this._chartOptions.chart.renderTo=this.el,this._element=new Highcharts.Chart(this._chartOptions),this._dataLoad()):(this.dataset.data.on("hasNewData",this.load,this),this.dataset.data.loadAllSelectedData())},t.prototype.update=function(){this.destroy(),this.load()},t.prototype.updatingDimensionPositions=function(){this.filterOptions.setZoneLengthRestriction({left:1,top:0}),this.filterOptions.setSelectedCategoriesRestriction({sectors:this._ALPHA_MAX_DIM1})},t.prototype._dataLoad=function(){if(this.dataset.data.isAllSelectedDataLoaded()){var e=this;e._element.addSeries({type:"pie",name:"Serie1",data:[]});for(var n=e._element.series[0].data.length,i=0;n>i;i++)e._element.series[0].data[0].remove(!1);var r=!1,a=this.getTitle(),s=this.getFixedPermutation(),o=this.filterOptions.getSectorsDimension(),l=this.filterOptions.getSelectedCategories(o.number);_.each(l,function(t){var n={};n[o.id]=t.id,_.extend(n,s);var i=e.dataset.data.getDataById(n),a={};a.name=t.label;var l;i&&(l=i.replace(",",".")),a.y=parseFloat(l),(isNaN(a.y)||0>a.y)&&(r=!0),e._element.series[0].addPoint(a)});var c=r?I18n.t("filter.text.pieError"):e.dataset.metadata.getProvider();e._element.setTitle({text:a},{text:c})}return t},t}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.VisualElement.CanvasTable"),STAT4YOU.VisualElement.CanvasTable=function(t){this.el=t.el,this.dataset=t.dataset,this.filterOptions=t.filterOptions,this._chartOptions={title:{},columnTop:{dimensions:[]},columnLeft:{dimensions:[]},fixedDimensions:{}},this._type="canvasTable"},STAT4YOU.VisualElement.CanvasTable.prototype={load:function(){this.$el=$(this.el),this.render(),this._bindEvents()},destroy:function(){this.tableScrollManager.destroy(),this.keyboardManager.destroy(),this.tableScrollManager=null,this.keyboardManager=null,this.dataSource=null,this.delegate=null,this.view=null,this._unbindEvents()},_bindEvents:function(){this.listenTo(this.dataset.data,"hasNewData",this.hasNewData),this.listenTo(this.filterOptions,"change",this.update);var t=_.debounce(_.bind(this._updateSize,this),200);this.$el.on("resize",function(e){e.stopPropagation(),t()})},_unbindEvents:function(){this.stopListening(),this.$el.off("resize")},updatingDimensionPositions:function(){this.filterOptions.setZoneLengthRestriction({left:-1,top:-1}),this.filterOptions.setSelectedCategoriesRestriction({left:-1,top:-1})},render:function(){this.dataSource=new STAT4YOU.DataSourceDataset({dataset:this.dataset,filterOptions:this.filterOptions}),this.delegate=new STAT4YOU.Table.Delegate,this.$el.empty();var t=this.getTitle();this.$title=$("<h3>"+t+"</h3>"),this.$el.append(this.$title);var e=this.containerDimensions();this.$canvas=$('<canvas width="'+e.width+'" height="'+e.height+'"></canvas>'),this.$el.append(this.$canvas),this.view=new STAT4YOU.Table.View({canvas:this.$canvas[0],dataSource:this.dataSource,delegate:this.delegate}),this.tableScrollManager=new STAT4YOU.Table.ScrollManager(this.view),this.keyboardManager=new STAT4YOU.Table.KeyboardManager({view:this.view}),this.view.repaint()},hasNewData:function(){this.view&&this.view.forceRepaintBody()},update:function(){this.filterOptions._initializeTableInfo(),this.view.update()},containerDimensions:function(){var t=this.$title.height();return{width:this.$el.width(),height:this.$el.height()-t}},resizeFullScreen:function(){this._updateSize()},_updateSize:function(){var t=this.containerDimensions();this.view.resize(t)}},_.extend(STAT4YOU.VisualElement.CanvasTable.prototype,Backbone.Events),_.defaults(STAT4YOU.VisualElement.CanvasTable.prototype,new STAT4YOU.VisualElement.Base)}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.VisualElement.line.DetailZoomModel"),STAT4YOU.VisualElement.line.DetailZoomModel=Backbone.Model.extend({defaults:{start:0,stop:.5,step:.1},validate:function(t){return 0>t.start||t.start>1?"invalid start":0>t.stop||t.stop>1?"invalid stop":t.start>t.stop?"start must be bigger than stop":void 0},moveStepRight:function(){this.moveDistance(this.get("step"))},moveStepLeft:function(){this.moveDistance(-this.get("step"))},moveDistance:function(t){var e=this.get("start")+t,n=this.get("stop")+t;e=0>e?0:e,n=n>1?1:n,this.set({start:e,stop:n},{validate:!0})}})}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.VisualElement.line.DetailZoomView"),STAT4YOU.VisualElement.line.DetailZoomView=Backbone.View.extend({className:"detailZoomView",events:{"mousedown .bar-left":"mouseDownLeft","mousedown .bar-right":"mouseDownRight","mousedown .selection":"mouseDownSelection","click .arrowBar-left":"clickArrowLeft","click .arrowBar-right":"clickArrowRight"},initialize:function(t){this.$targetEl=t.$targetEl,this.$targetEl.append(this.$el),_.bindAll(this),$(document).bind("mousemove",this.mouseMove),$(document).bind("mouseup",this.mouseUp),this.model.on("change",this.update,this),this.barWidth=10},destroy:function(){$(document).unbind("mouseup"),$(document).unbind("mousemove")},_setHorizontalPosition:function(t,e,n){var i=n-e;0>i&&(i=0),t.css({left:e,width:i})},updateSize:function(){this.render()},render:function(){this.$el.empty(),this.$targetEl.offset();var t={width:this.$targetEl.width(),height:this.$targetEl.height()};this.$el.css({position:"absolute",width:t.width,height:t.height,top:0,left:0});var e={top:0,height:t.height};this.$leftOverlay=$('<div class="overlay overlay-left">').css(e).appendTo(this.$el),this.$rightOverlay=$('<div class="overlay overlay-right">').css(e).appendTo(this.$el),this.$selection=$('<div class="selection">').css(e).appendTo(this.$el),this.$leftBar=$('<div class="bar bar-left">').css(e).appendTo(this.$el),this.$rightBar=$('<div class="bar bar-right">').css(e).appendTo(this.$el),this.$leftArrowBar=$('<div class="arrowBar arrowBar-left"><div class="arrow arrow-left"></div></div>').css(e).appendTo(this.$el),this.$rightArrowBar=$('<div class="arrowBar arrowBar-right"><div class="arrow arrow-right"></div></div>').css(e).appendTo(this.$el),$('<div class="line line-a"></div>').appendTo(this.$leftBar),$('<div class="line line-b"></div>').appendTo(this.$leftBar),$('<div class="line line-a"></div>').appendTo(this.$rightBar),$('<div class="line line-b"></div>').appendTo(this.$rightBar),this.$leftArrowBar.css({left:0,width:this.barWidth}),this.$rightArrowBar.css({left:t.width-this.barWidth,width:this.barWidth}),this.update()},update:function(){var t={width:this.$targetEl.width(),height:this.$targetEl.height()},e=0,n=Math.round(t.width*this.model.get("start")),i=n+this.barWidth,r=Math.round(t.width*this.model.get("stop"))-this.barWidth,a=r+this.barWidth,s=t.width-this.barWidth;this._setHorizontalPosition(this.$leftOverlay,e,i),this._setHorizontalPosition(this.$leftBar,n,i),this._setHorizontalPosition(this.$selection,i,r),this._setHorizontalPosition(this.$rightBar,r,a),this._setHorizontalPosition(this.$rightOverlay,a,s)},mouseDownLeft:function(){return this.leftBarMoving=!0,!1},mouseDownRight:function(){return this.rightBarMoving=!0,!1},mouseDownSelection:function(t){return this.selectionMoving=!0,this.mousePosition=t.pageX,!1},mouseUp:function(){return this.leftBarMoving=!1,this.rightBarMoving=!1,this.selectionMoving=!1,!1},mouseMove:function(t){var e;if(this.leftBarMoving||this.rightBarMoving){if(e=(t.pageX-this.$el.offset().left)/this.$el.width(),this.leftBarMoving)return this.model.set("start",e,{validate:!0}),!1;if(this.rightBarMoving)return this.model.set("stop",e,{validate:!0}),!1}this.selectionMoving&&(e=(t.pageX-this.mousePosition)/this.$el.width(),this.model.set({start:this.model.get("start")+e,stop:this.model.get("stop")+e},{validate:!0}),this.mousePosition=t.pageX)},clickArrowLeft:function(){return this.model.moveStepLeft(),!1},clickArrowRight:function(){return this.model.moveStepRight(),!1}})}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.VisualElement.Map"),STAT4YOU.VisualElement.Map=function(t){this.initialize(t)},STAT4YOU.VisualElement.Map.prototype={initialize:function(t){this.el=t.el,this.$el=$(this.el),this.filterOptions=t.filterOptions,this.dataset=t.dataset,this.shapes=new STAT4YOU.Map.Shapes,this.visible=!1},_bindEvents:function(){var t=this;this.listenTo(this.filterOptions,"change",function(){t.destroy(),t.load()})},_unbindEvents:function(){this.stopListening()},load:function(){this._bindEvents(),this.visible=!0;var t=this,e=this.dataset.data.loadAllSelectedData(),n=this._getNormCodes(),i=this.shapes.fetchShapes(n).done(function(e){t._geoJson=e}),r=this.shapes.fetchContainer(n).done(function(e){t._container=e});$.when(e,i,r).then(function(){t._loadCallback()})},render:function(){this.visible&&this._mapContainerView.render()},destroy:function(){this.visible=!1,this._mapContainerView&&this._mapContainerView.destroy(),this._mapModel&&(this._mapModel.off("change",this._handleTransform),this._mapModel.off("change:currentRangesNum",this._handleRangesNum),this._mapModel.off("zoomExit",this._handleZoomExit),this._listenersSetted=!1),this._unbindEvents()},updatingDimensionPositions:function(){this.filterOptions.setZoneLengthRestriction({left:{value:1,type:"GEOGRAPHIC_DIMENSION"},top:0}),this.filterOptions.setSelectedCategoriesRestriction({map:-1})},_getNormCodes:function(){var t=this.filterOptions.getMapDimension(),e=this.filterOptions.getSelectedCategories(t.id);return _.pluck(e,"normCode")},_checkDataAndShapes:function(){this._areDataAndShapesLoaded()&&this._loadCallback()},_areDataAndShapesLoaded:function(){return this.dataset.data.isAllSelectedDataLoaded()&&this._geoJson&&this._container},_loadCallback:function(){this._dataJson=this._getData(),this._initModel(),this._calculateRanges(),this._initContainerView(),this._setUpListeners(),this.render(),this.trigger("didLoadVe")},_getData:function(){var t=this,e=this.getFixedPermutation(),n=this.filterOptions.getMapDimension(),i=this.filterOptions.getSelectedCategories(n.number),r={};return _.each(i,function(i){if(i.normCode){var a={};a[n.id]=i.id,_.extend(a,e);var s=t.dataset.data.getNumberDataById(a);_.isNumber(s)&&(r[i.normCode]={value:s})}}),r},_initModel:function(){this._mapModel=new STAT4YOU.Map.MapModel},_initContainerView:function(){this._mapContainerView=new STAT4YOU.Map.MapContainerView({el:this.el,dataset:this.dataset,filterOptions:this.filterOptions,mapModel:this._mapModel,geoJson:this._geoJson,container:this._container,dataJson:this._dataJson,width:$(this.el).width(),height:$(this.el).height()})},_setUpListeners:function(){this._listenersSetted||(this._listenersSetted=!0,this._mapModel.on("change",this._handleTransform,this),this._mapModel.on("change:currentRangesNum",this._handleRangesNum,this),this._mapModel.on("zoomExit",this._handleZoomExit,this))},_calculateRanges:function(){var t=_.map(this._dataJson,function(t){return t.value});this.maxValue=_.max(t),this.minValue=_.min(t),this._mapModel.set("minValue",this.minValue),this._mapModel.set("maxValue",this.maxValue),this._mapModel.set("values",t)},_handleTransform:function(){this._mapContainerView.transform()},_handleRangesNum:function(){this._mapContainerView.updateRanges()},_handleZoomExit:function(){this._mapContainerView.zoomExit()}},_.defaults(STAT4YOU.VisualElement.Map.prototype,STAT4YOU.VisualElement.Base.prototype),_.extend(STAT4YOU.VisualElement.Map.prototype,Backbone.Events)}(),LRUCache.prototype.put=function(t,e){var n={key:t,value:e};return this._keymap[t]=n,this.tail?(this.tail.newer=n,n.older=this.tail):this.head=n,this.tail=n,this.size===this.limit?this.shift():(this.size++,void 0)},LRUCache.prototype.shift=function(){var t=this.head;return t&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,t.newer=t.older=void 0,delete this._keymap[t.key]),t},LRUCache.prototype.get=function(t,e){var n=this._keymap[t];if(void 0!==n)return n===this.tail?n.value:(n.newer&&(n===this.head&&(this.head=n.newer),n.newer.older=n.older),n.older&&(n.older.newer=n.newer),n.newer=void 0,n.older=this.tail,this.tail&&(this.tail.newer=n),this.tail=n,e?n:n.value)},LRUCache.prototype.find=function(t){return this._keymap[t]},LRUCache.prototype.set=function(t,e){var n,i=this.get(t,!0);return i?(n=i.value,i.value=e):(n=this.put(t,e),n&&(n=n.value)),n},LRUCache.prototype.remove=function(t){var e=this._keymap[t];if(e)return delete this._keymap[e.key],e.newer&&e.older?(e.older.newer=e.newer,e.newer.older=e.older):e.newer?(e.newer.older=void 0,this.head=e.newer):e.older?(e.older.newer=void 0,this.tail=e.older):this.head=this.tail=void 0,this.size--,e.value},LRUCache.prototype.removeAll=function(){this.head=this.tail=void 0,this.size=0,this._keymap={}},LRUCache.prototype.keys="function"==typeof Object.keys?function(){return Object.keys(this._keymap)}:function(){var t=[];for(var e in this._keymap)t.push(e);return t},LRUCache.prototype.forEach=function(t,e,n){if(e===!0?(n=!0,e=void 0):"object"!=typeof e&&(e=this),n)for(var i=this.tail;i;)t.call(e,i.key,i.value,this),i=i.older;else for(var i=this.head;i;)t.call(e,i.key,i.value,this),i=i.newer},LRUCache.prototype.toJSON=function(){for(var t=[],e=this.head;e;)t.push({key:e.key.toJSON(),value:e.value.toJSON()}),e=e.newer;return t},LRUCache.prototype.toString=function(){for(var t="",e=this.head;e;)t+=e.key+""+":"+e.value,(e=e.newer)&&(t+=" < ");return t},"object"==typeof this&&(this.LRUCache=LRUCache),function(t){function e(e){var n=e.handler,i=(e.namespace||"").toLowerCase().split(" ");i=t.map(i,function(t){return t.split(".")}),(1!==i.length||""!==i[0]&&"autocomplete"!==i[0])&&(e.handler=function(e){if(this===e.target||!/textarea|select/i.test(e.target.nodeName)&&"text"!==e.target.type&&"true"!=$(e.target).prop("contenteditable")){var r="keypress"!==e.type&&t.hotkeys.specialKeys[e.which],a=String.fromCharCode(e.which).toLowerCase(),s="",o={};e.altKey&&"alt"!==r&&(s+="alt_"),e.ctrlKey&&"ctrl"!==r&&(s+="ctrl_"),e.metaKey&&!e.ctrlKey&&"meta"!==r&&(s+="meta_"),e.shiftKey&&"shift"!==r&&(s+="shift_"),r?o[s+r]=!0:(o[s+a]=!0,o[s+t.hotkeys.shiftNums[a]]=!0,"shift_"===s&&(o[t.hotkeys.shiftNums[a]]=!0));for(var l=0,c=i.length;c>l;l++)if(o[i[l]])return n.apply(this,arguments)}})}t.hotkeys={version:"0.8+",specialKeys:{8:"backspace",9:"tab",13:"return",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"insert",46:"del",96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9",106:"*",107:"+",109:"-",110:".",111:"/",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",144:"numlock",145:"scroll",188:",",190:".",191:"/",224:"meta"},shiftNums:{"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":": ","'":'"',",":"<",".":">","/":"?","\\":"|"}},t.each(["keydown","keyup","keypress"],function(){t.event.special[this]={add:e}})}(jQuery),$(function(){function t(t){return jQuery.hotkeys.specialKeys[t.which]||String.fromCharCode(t.which).toLowerCase()}window.keydown={},$(document).bind("keydown",function(e){keydown[t(e)]=!0}),$(document).bind("keyup",function(e){keydown[t(e)]=!1})}),function(t){"use strict";var e={},n={};t.manageAjax=function(){function n(n,i){return e[n]=new t.manageAjax._manager(n,i),e[n]}function i(t){e[t]&&(e[t].clear(!0),delete e[t])}var r={create:n,destroy:i};return r}(),t.manageAjax._manager=function(e,n){this.requests={},this.inProgress=0,this.name=e,this.qName=e,this.opts=t.extend({},t.manageAjax.defaults,n),n&&n.queue&&n.queue!==!0&&"string"==typeof n.queue&&"clear"!==n.queue&&(this.qName=n.queue)},t.manageAjax._manager.prototype={add:function(e,n){"object"==typeof e?n=e:"string"==typeof e&&(n=t.extend(n||{},{url:e})),n=t.extend({},this.opts,n);var i=n.complete||t.noop,r=n.success||t.noop,a=n.beforeSend||t.noop,s=n.error||t.noop,o="string"==typeof n.data?n.data:t.param(n.data||{}),l=n.type+n.url+o,c=this,u=this._createAjax(l,n,r,i);if(n.preventDoubleRequests&&n.queueDuplicateRequests&&(n.preventDoubleRequests&&(n.queueDuplicateRequests=!1),setTimeout(function(){throw"preventDoubleRequests and queueDuplicateRequests can't be both true"},0)),!this.requests[l]||!n.preventDoubleRequests){u.xhrID=l,n.xhrID=l,n.beforeSend=function(t,e){var n=a.call(this,t,e);return n===!1&&c._removeXHR(l),t=null,n},n.complete=function(t,e){c._complete.call(c,this,i,t,e,l,n),t=null},n.success=function(t,e,i){c._success.call(c,this,r,t,e,i,n),i=null},n.error=function(t,e,i){var r="",a="";"timeout"!==e&&t&&(r=t.status,a=t.responseXML||t.responseText),s?s.call(this,t,e,i,n):setTimeout(function(){throw e+"| status: "+r+" | URL: "+n.url+" | data: "+o+" | thrown: "+i+" | response: "+a},0),t=null};var h=t(document);if(n.queue||n.queueDuplicateRequests&&this.requests[l]){if("limit"===n.queue){var d=h.queue(this.qName);d.length>=n.queueLimit&&d.shift()}return t.queue(document,this.qName,u),!(this.inProgress<n.maxRequests)||this.requests[l]&&n.queueDuplicateRequests||t.dequeue(document,this.qName),l}return u()}},isFetching:function(t){return void 0!==this.getData(t)},_createAjax:function(e,i,r,a){var s=this;return function(){return i.beforeCreate.call(i.context||s,e,i)!==!1?(s.inProgress++,1===s.inProgress&&t.event.trigger(s.name+"AjaxStart"),i.cacheResponse&&n[e]&&(!n[e].cacheTTL||0>n[e].cacheTTL||(new Date).getTime()-n[e].timestamp<n[e].cacheTTL?(s.requests[e]={},setTimeout(function(){s._success.call(s,i.context||i,r,n[e]._successData,"success",n[e],i),s._complete.call(s,i.context||i,a,n[e],"success",e,i)},0)):delete n[e]),i.cacheResponse&&n[e]||(i.async?s.requests[e]=t.ajax(i):t.ajax(i)),e):void 0}},_removeXHR:function(e){(this.opts.queue||this.opts.queueDuplicateRequests)&&t.dequeue(document,this.qName),this.inProgress--,this.requests[e]=null,delete this.requests[e]},clearCache:function(){n={}},_isAbort:function(t,e,n){if(!n.abortIsNoSuccess||!t&&!e)return!1;var i=!(t&&0!==t.readyState&&this.lastAbort!==n.xhrID);return t=null,i},_complete:function(e,n,i,r,a,s){this._isAbort(i,r,s)&&(r="abort",s.abort.call(e,i,r,s)),n.call(e,i,r,s),t.event.trigger(this.name+"AjaxComplete",[i,r,s]),s.domCompleteTrigger&&t(s.domCompleteTrigger).trigger(this.name+"DOMComplete",[i,r,s]).trigger("DOMComplete",[i,r,s]),this._removeXHR(a),this.inProgress||t.event.trigger(this.name+"AjaxStop"),i=null},_success:function(e,i,r,a,s,o){var l=this;if(this._isAbort(s,a,o))return s=null,void 0;if(o.abortOld&&t.each(this.requests,function(t){return t===o.xhrID?!1:(l.abort(t),void 0)}),o.cacheResponse&&!n[o.xhrID]&&(s||(s={}),n[o.xhrID]={status:s.status,statusText:s.statusText,responseText:s.responseText,responseXML:s.responseXML,_successData:r,cacheTTL:o.cacheTTL,timestamp:(new Date).getTime()},"getAllResponseHeaders"in s)){var c,u=s.getAllResponseHeaders(),h=function(){c||(c={},t.each(u.split("\n"),function(t,e){var n=e.indexOf(":");c[e.substr(0,n)]=e.substr(n+2)}))};t.extend(n[o.xhrID],{getAllResponseHeaders:function(){return u},getResponseHeader:function(t){return h(),t in c?c[t]:null}})}i.call(e,r,a,s,o),t.event.trigger(this.name+"AjaxSuccess",[s,o,r]),o.domSuccessTrigger&&t(o.domSuccessTrigger).trigger(this.name+"DOMSuccess",[r,o]).trigger("DOMSuccess",[r,o]),s=null},getData:function(e){if(e){var n=this.requests[e];return!n&&this.opts.queue&&(n=t.grep(t(document).queue(this.qName),function(t){return t.xhrID===e})[0]),n}return{requests:this.requests,queue:this.opts.queue?t(document).queue(this.qName):[],inProgress:this.inProgress}},abort:function(e){var n;if(e)return n=this.getData(e),n&&n.abort?(this.lastAbort=e,n.abort(),this.lastAbort=!1):t(document).queue(this.qName,t.grep(t(document).queue(this.qName),function(t){return t!==n})),n=null,void 0;var i=this,r=[];t.each(this.requests,function(t){r.push(t)}),t.each(r,function(t,e){i.abort(e)})},clear:function(e){t(document).clearQueue(this.qName),e&&this.abort()}},t.manageAjax._manager.prototype.getXHR=t.manageAjax._manager.prototype.getData,t.manageAjax.defaults={beforeCreate:t.noop,abort:t.noop,abortIsNoSuccess:!0,maxRequests:1,cacheResponse:!1,async:!0,domCompleteTrigger:!1,domSuccessTrigger:!1,preventDoubleRequests:!0,queueDuplicateRequests:!1,cacheTTL:-1,queue:!1},t.each(t.manageAjax._manager.prototype,function(n,i){0!==n.indexOf("_")&&t.isFunction(i)&&(t.manageAjax[n]=function(i,r){if(!e[i]){if("add"!==n)return;t.manageAjax.create(i,r)}var a=Array.prototype.slice.call(arguments,1);e[i][n].apply(e[i],a)})})}(jQuery),function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;e.length>n&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var n=(new Date).getTime(),i=Math.max(0,16-(n-t)),r=window.setTimeout(function(){e(n+i)},i);return t=n+i,r}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.Utils"),STAT4YOU.Table.Utils.floorIndex=function(t,e){var n,i=_.lastIndexOf(t,e);return n=-1!==i?i:_.sortedIndex(t,e)-1},STAT4YOU.Table.Utils.acumulate=function(t,e){var n,i=Array(t),r=0;for(n=0;t>=n;n++)i[n]=r,r+=e(n);return i},STAT4YOU.Table.Utils.rightProductAcumulate=function(t){var e=t.slice(1);e.push(1);for(var n=t.length-2;n>=0;n--)e[n]=e[n]*e[n+1];return e},STAT4YOU.Table.Utils.divideArray=function(t){var e=t.length,n=Math.ceil(e/2),i=Math.floor(e/2);return[t.slice(0,n),t.slice(e-i,e)]},STAT4YOU.Table.Utils.permuteDimensionCodes=function(t){var e=[],n=function(t,i){if(t&&t.length>0){var r=_.first(t),a=_.rest(t);_.each(r.representations,function(t){i[r.id]=t.id,n(a,i)})}else e.push(_.clone(i))};return n(t,{}),e}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.Point"),STAT4YOU.Table.Point=function(t,e){this.x=t,this.y=e},STAT4YOU.Table.Point.prototype.distance=function(t){return new STAT4YOU.Table.Point(this.x-t.x,this.y-t.y)},STAT4YOU.Table.Point.prototype.plus=function(t){return new STAT4YOU.Table.Point(this.x+t.x,this.y+t.y)},STAT4YOU.Table.Point.prototype.clone=function(){return _.clone(this)},STAT4YOU.Table.Point.prototype.negate=function(){return new STAT4YOU.Table.Point(-this.x,-this.y)},STAT4YOU.Table.Point.prototype.eq=function(t){return t?this.x===t.x&&this.y===t.y:!1}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.Cell"),STAT4YOU.Table.Cell=function(t,e){this.x=t,this.y=e},STAT4YOU.Table.Cell.prototype.clone=function(){return new STAT4YOU.Table.Cell(this.x,this.y)},STAT4YOU.Table.Cell.prototype.eq=function(t){return this.x===t.x&&this.y===t.y}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.Size"),STAT4YOU.Table.Size=function(t,e){this.width=t,this.height=e},STAT4YOU.Table.isZero=function(){return 0===this.width&&0===this.height}}(),function(){"use strict";var t=STAT4YOU.Table.Point,e=STAT4YOU.Table.Size;STAT4YOU.namespace("STAT4YOU.Table.Rectangle"),STAT4YOU.Table.Rectangle=function(){2===arguments.length?(this.setPoint(arguments[0]),this.setSize(arguments[1])):4===arguments.length&&(this.setPoint(new t(arguments[0],arguments[1])),this.setSize(new e(arguments[2],arguments[3])))},STAT4YOU.Table.Rectangle.prototype.getPoint=function(){return new STAT4YOU.Table.Point(this.x,this.y)},STAT4YOU.Table.Rectangle.prototype.setPoint=function(t){this.x=t.x,this.y=t.y},STAT4YOU.Table.Rectangle.prototype.getSize=function(){return new STAT4YOU.Table.Size(this.width,this.height)},STAT4YOU.Table.Rectangle.prototype.setSize=function(t){this.width=t.width,this.height=t.height},STAT4YOU.Table.Rectangle.prototype.topLeftPoint=function(){return this.getPoint()},STAT4YOU.Table.Rectangle.prototype.topRightPoint=function(){var t=this.getPoint();return t.x=t.x+this.width,t},STAT4YOU.Table.Rectangle.prototype.bottomLeftPoint=function(){var t=this.getPoint();return t.y=t.y+this.height,t},STAT4YOU.Table.Rectangle.prototype.bottomRightPoint=function(){var t=this.getPoint();
return t.x=t.x+this.width,t.y=t.y+this.height,t},STAT4YOU.Table.Rectangle.prototype.containsPoint=function(t){var e=t.x>=this.x&&t.x<this.x+this.width&&t.y>=this.y&&t.y<this.y+this.height;return e},STAT4YOU.Table.Rectangle.createFromPointWithOffset=function(t){return new STAT4YOU.Table.Rectangle(t.x-5,t.y-5,10,10)}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.DataSourceDataset"),STAT4YOU.DataSourceDataset=function(t){this.dataset=t.dataset,this.filterOptions=t.filterOptions},STAT4YOU.DataSourceDataset.prototype={leftHeaderColumns:function(){return this.filterOptions.tableInfo.left.representationsValues.length},leftHeaderValues:function(){return this.filterOptions.tableInfo.left.representationsValues},topHeaderRows:function(){return this.filterOptions.tableInfo.top.representationsValues.length},topHeaderValues:function(){return this.filterOptions.tableInfo.top.representationsValues},cellAtIndex:function(t){return this.dataset.data.getDataByCell(t)},cellExists:function(t){var e=this.filterOptions.getTableSize();return t.y>=0&&t.x>=0&&e.rows>t.y&&e.columns>t.x},rows:function(){return this.filterOptions.getTableSize().rows},columns:function(){return this.filterOptions.getTableSize().columns},topHeaderTooltipValues:function(){for(var t=this.topHeaderValues(),e=this.filterOptions.getTopDimensions(),n=[],i=0;t.length>i;i++){n[i]=[];for(var r=0;t[i].length>r;r++)e[i]&&(n[i][r]=e[i].label+" : "+t[i][r])}return n},leftHeaderTooltipValues:function(){for(var t=this.leftHeaderValues(),e=this.filterOptions.getLeftDimensions(),n=[],i=0;t.length>i;i++){n[i]=[];for(var r=0;t[i].length>r;r++)e[i]&&(n[i][r]=e[i].label+" : "+t[i][r])}return n}},_.extend(STAT4YOU.DataSourceDataset.prototype,Backbone.Events)}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.Delegate"),STAT4YOU.Table.Delegate=function(){this.size=new STAT4YOU.Table.Size(150,25),this.minSize=new STAT4YOU.Table.Size(50,25),this.style={bodyCell:{font:"12px Helvetica,Arial,sans-serif",color:"#191919",background:function(t,e){var n=e.isSelectionActive({rows:[t.y]}),i=e.isSelectionActive({columns:[t.x]});return n&&i?"#E8F1FF":n||i?"#F5F9FF":"#fff"},border:{color:"#DDD",width:"1px",horizontal:!0,vertical:!1},margin:{right:5}},headerCell:{font:"12px Helvetica, Arial, sans-serif",color:"#191919",background:function(t,e){return e.isSelectionActive(t)?"#C8C8C8":"#E6E6E6"},border:{color:"#C0C0C0",width:"1px"},shadow:{show:!1,color:"rgba(0, 0, 0, 0.2)",blur:"10",offset:1},margin:{right:5,left:5}},scroll:{color:function(t,e){return e.mouseZone&&-1!==e.mouseZone.indexOf(t)?"#DD7735":e.lastClickZone&&-1!==e.lastClickZone.indexOf(t)?"#DD7735":"#CCCCCC"},minSize:30,lineWidth:7}},this.columnWidthOffsets=[],this.leftHeaderColumnWidthOffsets=[]},STAT4YOU.Table.Delegate.prototype={rowHeight:function(){return this.size.height},columnWidth:function(t){var e=this.columnWidthOffsets[t],n=_.isUndefined(e)?this.size.width:this.size.width+e,i=this.minSize.width>n?this.minSize.width:n;return i},leftHeaderColumnWidth:function(t){var e=100,n=this.leftHeaderColumnWidthOffsets[t],i=_.isUndefined(n)?e:e+n;return this.minSize.width>i?this.minSize.width:i},topHeaderRowHeight:function(){return 25},_isNumber:function(t){var e=parseFloat(t);return!_.isNaN(e)},format:function(t){return t?(t=t.replace(",","."),this._isNumber(t)?STAT4YOU.dataset.data.NumberFormatter.strNumberToLocalizedString(t):t):void 0},resizableColumns:function(){return!0},resizeColumnWidth:function(t,e){var n=t-1;this.columnWidthOffsets[n]=_.isUndefined(this.columnWidthOffsets[n])?e:this.columnWidthOffsets[n]+e},resizeLeftHeaderColumnWidth:function(t,e){var n=t-1;_.isUndefined(this.leftHeaderColumnWidthOffsets[n])?this.leftHeaderColumnWidthOffsets[n]=e:this.leftHeaderColumnWidthOffsets[n]+=e}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.Zone");var t=STAT4YOU.Table.Point,e=STAT4YOU.Table.Rectangle,n=STAT4YOU.Table.Size;STAT4YOU.Table.Zone=function(t){this.initialize(t)},STAT4YOU.Table.Zone.prototype.initialize=function(i){i||(i={}),this.ctx=i.context,this.viewPort=new e(new t(0,0),new n(0,0)),this.size=new n(0,0),this.origin=new t(0,0),this.needRepaint=!1},STAT4YOU.Table.Zone.prototype.setSize=function(t){this.size=t},STAT4YOU.Table.Zone.prototype.setViewPort=function(t){this.viewPort=t,this.needRepaint=!0,this.limitPointToValidOrigin(this.origin)},STAT4YOU.Table.Zone.prototype.setOrigin=function(t){this.origin=t,this.needRepaint=!0},STAT4YOU.Table.Zone.prototype.limitPointToValidOrigin=function(e){var n=new t(this.size.width-this.viewPort.width,this.size.height-this.viewPort.height);return e.x>n.x&&(e.x=n.x),0>e.x&&(e.x=0),e.y>n.y&&(e.y=n.y),0>e.y&&(e.y=0),e},STAT4YOU.Table.Zone.prototype.move=function(t){var e=this.origin.distance(t);this.limitPointToValidOrigin(e),this.setOrigin(e)},STAT4YOU.Table.Zone.prototype.absolutePoint2RelativePoint=function(t){return t.distance(this.origin).plus(this.viewPort.getPoint())},STAT4YOU.Table.Zone.prototype.relativePoint2AbsolutePoint=function(t){return t.distance(this.viewPort.getPoint()).plus(this.origin)},STAT4YOU.Table.Zone.prototype.isRelativePointVisible=function(t){return t.x>=this.viewPort.x&&t.x<this.viewPort.width+this.viewPort.x&&t.y>=this.viewPort.y&&t.y<this.viewPort.height+this.viewPort.y},STAT4YOU.Table.Zone.prototype.isRelativeRectangleVisible=function(t){var e=t.topLeftPoint(),n=t.bottomRightPoint(),i=e.x<=this.viewPort.x+this.viewPort.width&&n.x>=this.viewPort.x&&e.y<=this.viewPort.y+this.viewPort.height&&n.y>=this.viewPort.y;return i},STAT4YOU.Table.Zone.prototype.clear=function(){this.ctx.clearRect(this.viewPort.x,this.viewPort.y,this.viewPort.width,this.viewPort.height)}}(),function(){"use strict";var t=STAT4YOU.Table.Cell,e=STAT4YOU.Table.Size,n=STAT4YOU.Table.Point,i=STAT4YOU.Table.Utils,r=STAT4YOU.Table.Rectangle;STAT4YOU.namespace("STAT4YOU.Table.BodyZone"),STAT4YOU.Table.BodyZone=function(t){STAT4YOU.Table.Zone.prototype.initialize.apply(this,arguments),this.initialize(t)},STAT4YOU.Table.BodyZone.prototype={initialize:function(t){t||(t={}),this.dataSource=t.dataSource,this.delegate=t.delegate,this.view=t.view,this.calculateIncrementalSize()},calculateIncrementalSize:function(){if(this.dataSource&&this.delegate){var t=this,n=this.dataSource.rows(),r=this.dataSource.columns(),a=i.acumulate(n,function(e){return t.delegate.rowHeight(e)}),s=i.acumulate(r,function(e){return t.delegate.columnWidth(e)});this.incrementalCellSize={rows:a,columns:s};var o=s[s.length-1],l=a[a.length-1];this.setSize(new e(o,l))}},firstCell:function(){var e=i.floorIndex(this.incrementalCellSize.columns,this.origin.x),n=i.floorIndex(this.incrementalCellSize.rows,this.origin.y);return new t(e,n)},cell2AbsolutePoint:function(t){var e=this.incrementalCellSize.columns[t.x],i=this.incrementalCellSize.rows[t.y];return new n(e,i)},relativePoint2Cell:function(e){var n=this.relativePoint2AbsolutePoint(e),r=i.floorIndex(this.incrementalCellSize.columns,n.x),a=i.floorIndex(this.incrementalCellSize.rows,n.y);return new t(r,a)},cellSize:function(t){var n=this.delegate.columnWidth(t.x),i=this.delegate.rowHeight(t.y);return new e(n,i)},isCellVisible:function(t){if(!this.dataSource.cellExists(t))return!1;var e=this.cellSize(t),n=this.absolutePoint2RelativePoint(this.cell2AbsolutePoint(t)),i=new r(n,e);return this.isRelativeRectangleVisible(i)},visibleRowsAndColumns:function(){for(var t=!0,e=!0,n=this.firstCell(),i=n.clone();t;)i.x=i.x+1,t=this.isCellVisible(i);for(var r=n.clone();e;)r.y=r.y+1,e=this.isCellVisible(r);return{rows:{begin:n.y,end:r.y},columns:{begin:n.x,end:i.x}}},paintInfo:function(){for(var t,e=!0,n=!0,i=this.dataSource.rows(),a=this.dataSource.columns(),s=this.firstCell(),o=this.absolutePoint2RelativePoint(this.cell2AbsolutePoint(s)),l=this.cellSize(s),c=[],u=[],h=s.x,d=o.x;e&&a>h;)t=this.delegate.columnWidth(h),c.push({x:d,index:h,width:t}),h+=1,d+=t,e=this.isRelativeRectangleVisible(new r(d,o.y,t,l.height));for(var f=s.y,p=o.y;n&&i>f;)t=this.delegate.rowHeight(f),u.push({y:p,index:f,height:t}),f+=1,p+=t,n=this.isRelativeRectangleVisible(new r(o.x,p,l.width,t));return{rows:u,columns:c}},repaint:function(){this.clear(),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x,this.viewPort.y,this.viewPort.width,this.viewPort.height),this.ctx.clip();var t=this.visibleRowsAndColumns(),e=this.paintInfo();this.paintCells(e),this.paintGrid(t),this.ctx.restore(),this.needRepaint=!1},paintGrid:function(e){this.ctx.save(),this.ctx.beginPath();var n=new t(e.columns.end,e.rows.end),i=this.absolutePoint2RelativePoint(this.cell2AbsolutePoint(n)),r=i.y,a=i.x;if(this.delegate.style.bodyCell.border.vertical)for(var s=e.columns.begin;e.columns.end>s;s++){var o=new t(s,e.rows.begin),l=this.absolutePoint2RelativePoint(this.cell2AbsolutePoint(o));this.ctx.moveTo(l.x+.5,this.viewPort.y),this.ctx.lineTo(l.x+.5,r)}if(this.delegate.style.bodyCell.border.horizontal)for(var c=e.rows.begin;e.rows.end>c;c++){var o=new t(e.columns.begin,c),l=this.absolutePoint2RelativePoint(this.cell2AbsolutePoint(o));this.ctx.moveTo(this.viewPort.x,l.y+.5),this.ctx.lineTo(a,l.y+.5)}this.ctx.rect(this.viewPort.x+.5,this.viewPort.y+.5,this.viewPort.width-1,this.viewPort.height-1),this.ctx.strokeStyle=this.delegate.style.bodyCell.border.color,this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()},paintCells:function(i){var r,a,s;this.ctx.textAlign="right",this.ctx.font=this.delegate.style.bodyCell.font,this.ctx.textBaseline="middle";var o=this.delegate.style.bodyCell.margin.right;for(s=0;i.columns.length>s;s++){var l=i.columns[s];for(a=0;i.rows.length>a;a++){var c=i.rows[a],u=new t(l.index,c.index),h=new n(l.x,c.y),d=new e(l.width,c.height),f=this.dataSource.cellAtIndex(u);_.isFunction(this.delegate.format)&&(f=this.delegate.format(f)),this.ctx.beginPath(),this.ctx.rect(h.x,h.y,d.width,d.height),r=_.isFunction(this.delegate.style.bodyCell.background)?this.delegate.style.bodyCell.background(u,this.view):this.delegate.style.bodyCell.background,this.ctx.fillStyle=r,this.ctx.fill(),this.ctx.closePath(),void 0!==f&&(this.ctx.fillStyle=this.delegate.style.bodyCell.color,this.ctx.fillText(f,h.x+d.width-o,h.y+d.height/2))}}}},_.defaults(STAT4YOU.Table.BodyZone.prototype,STAT4YOU.Table.Zone.prototype)}(),function(){"use strict";var t=(STAT4YOU.Table.Cell,STAT4YOU.Table.Size,STAT4YOU.Table.Point),e=(STAT4YOU.Table.Utils,STAT4YOU.Table.Rectangle);STAT4YOU.namespace("STAT4YOU.Table.RightScrollZone"),STAT4YOU.Table.RightScrollZone=function(t){STAT4YOU.Table.Zone.prototype.initialize.apply(this,arguments),this.initialize(t)},STAT4YOU.Table.RightScrollZone.prototype={initialize:function(t){t&&(this.bodyZone=t.bodyZone,this.delegate=t.delegate,this.view=t.view,this.lineWidth=7,this.minSize=10,this.delegate&&(this.lineWidth=this.delegate.style.scroll.lineWidth||this.lineWidth,this.minSize=this.delegate.style.scroll.minSize||this.minSize))},getScrollPosition:function(){var t=this.getScrollSize(),e=this.bodyZone.origin.y/(this.bodyZone.size.height-this.viewPort.height)*(this.viewPort.height-t);return Math.floor(e)},getScrollSize:function(){var t=this.viewPort.height*this.viewPort.height/this.bodyZone.size.height;return this.minSize>t?t=this.minSize:t>this.viewPort.height&&(t=this.viewPort.height),t},scrollRectangle:function(){var t,n,i,r,a=this.paintInfo();return t=this.viewPort.x,n=a.begin.y-this.lineWidth,i=this.viewPort.width,r=a.end.y-a.begin.y+2*this.lineWidth,new e(t,n,i,r)},isVisible:function(){var t=this.getScrollSize();return t!==this.viewPort.height},paintInfo:function(){var e=this.getScrollPosition(),n=this.getScrollSize(),i=new t,r=new t,a=Math.ceil(this.lineWidth/2);return i.x=Math.floor(this.viewPort.x+this.viewPort.width/2)+.5,i.y=Math.floor(this.viewPort.y+e)+a,r.x=i.x,r.y=i.y+n-2*a,{begin:i,end:r}},repaint:function(){if(this.isVisible()){var t=this.paintInfo();this.ctx.save(),this.clear(),this.ctx.beginPath(),this.ctx.moveTo(t.begin.x,t.begin.y),this.ctx.lineTo(t.end.x,t.end.y),this.ctx.lineWidth=this.lineWidth,this.ctx.lineCap="round";var e;e=_.isFunction(this.delegate.style.scroll.color)?this.delegate.style.scroll.color("rightScrollZone",this.view):this.delegate.style.scroll.color,this.ctx.strokeStyle=e,this.ctx.stroke(),this.ctx.restore()}},move:function(t){t.y&&(STAT4YOU.Table.Zone.prototype.move.apply(this,arguments),this.needRepaint=!0)}},_.defaults(STAT4YOU.Table.RightScrollZone.prototype,STAT4YOU.Table.Zone.prototype)}(),function(){"use strict";var t=STAT4YOU.Table.Point,e=STAT4YOU.Table.Rectangle;STAT4YOU.namespace("STAT4YOU.Table.BottomScrollZone"),STAT4YOU.Table.BottomScrollZone=function(t){STAT4YOU.Table.Zone.prototype.initialize.apply(this,arguments),this.initialize(t)},STAT4YOU.Table.BottomScrollZone.prototype={initialize:function(t){t&&(this.bodyZone=t.bodyZone,this.delegate=t.delegate,this.view=t.view,this.lineWidth=7,this.minSize=10,this.delegate&&(this.lineWidth=this.delegate.style.scroll.lineWidth||this.lineWidth,this.minSize=this.delegate.style.scroll.minSize||this.minSize))},getScrollPosition:function(){var t=this.getScrollSize(),e=this.bodyZone.origin.x/(this.bodyZone.size.width-this.viewPort.width)*(this.viewPort.width-t);return Math.floor(e)},getScrollSize:function(){var t=this.viewPort.width*this.viewPort.width/this.bodyZone.size.width;return this.minSize>t?t=this.minSize:t>this.viewPort.width&&(t=this.viewPort.width),t},scrollRectangle:function(){var t,n,i,r,a=this.paintInfo();return t=a.begin.x-this.lineWidth,n=this.viewPort.y,i=a.end.x-a.begin.x+2*this.lineWidth,r=this.viewPort.height,new e(t,n,i,r)},isVisible:function(){var t=this.getScrollSize();return t!==this.viewPort.width},paintInfo:function(){var e=this.getScrollPosition(),n=this.getScrollSize(),i=new t,r=new t,a=Math.ceil(this.lineWidth/2);return i.x=Math.floor(this.viewPort.x+e)+a,i.y=Math.floor(this.viewPort.y+this.viewPort.height/2)+.5,r.x=i.x+n-2*a,r.y=i.y,{begin:i,end:r}},repaint:function(){if(this.isVisible()){var t=this.paintInfo();this.ctx.save(),this.clear(),this.ctx.beginPath(),this.ctx.moveTo(t.begin.x,t.begin.y),this.ctx.lineTo(t.end.x,t.end.y),this.ctx.lineWidth=this.lineWidth,this.ctx.lineCap="round";var e;e=_.isFunction(this.delegate.style.scroll.color)?this.delegate.style.scroll.color("bottomScrollZone",this.view):this.delegate.style.scroll.color,this.ctx.strokeStyle=e,this.ctx.stroke(),this.ctx.restore()}this.needRepaint=!1},move:function(t){t.x&&(STAT4YOU.Table.Zone.prototype.move.apply(this,arguments),this.needRepaint=!0)}},_.defaults(STAT4YOU.Table.BottomScrollZone.prototype,STAT4YOU.Table.Zone.prototype)}(),function(){"use strict";var t=STAT4YOU.Table.Size,e=STAT4YOU.Table.Rectangle,n=STAT4YOU.Table.Utils,i=STAT4YOU.Table.Point;STAT4YOU.namespace("STAT4YOU.Table.LeftHeaderZone"),STAT4YOU.Table.LeftHeaderZone=function(t){STAT4YOU.Table.Zone.prototype.initialize.apply(this,arguments),this.initialize(t)},_.extend(STAT4YOU.Table.LeftHeaderZone.prototype,STAT4YOU.Table.Zone.prototype),STAT4YOU.Table.LeftHeaderZone.prototype.initialize=function(t){t||(t={}),this.bodyZone=t.bodyZone,this.dataSource=t.dataSource,this.delegate=t.delegate,this.view=t.view,this.calculateIncrementalSize()},STAT4YOU.Table.LeftHeaderZone.prototype.calculateIncrementalSize=function(){if(this.dataSource&&this.delegate){var e=this,i=this.dataSource.leftHeaderColumns(),r=n.acumulate(i,function(t){return e.delegate.leftHeaderColumnWidth(t,e.view)});this.incrementalCellSize={rows:this.bodyZone.incrementalCellSize.rows,columns:r};var a=r[r.length-1],s=this.bodyZone.size.height;this.setSize(new t(a,s))}},STAT4YOU.Table.LeftHeaderZone.prototype.paintInfo=function(){for(var t=this.bodyZone.paintInfo(),e=this.dataSource.leftHeaderColumns(),i=this.dataSource.leftHeaderValues(),r=this.dataSource.leftHeaderTooltipValues(),a=_.map(i,function(t){return t.length}),s=n.rightProductAcumulate(a),o=[],l=0;e>l;l++){o[l]=[];for(var c=this.delegate.leftHeaderColumnWidth(l,this.view),u=this.incrementalCellSize.columns[l],h=0;t.rows.length>h;h++){var d=t.rows[h],f=Math.floor(d.index/s[l]),p=f*s[l];if(0===o[l].length||_.last(o[l]).index!=p){var g=this.incrementalCellSize.rows[p]-this.bodyZone.origin.y+this.viewPort.y,m=p+s[l],v=this.incrementalCellSize.rows[m]-this.incrementalCellSize.rows[p],d=f%a[l],y=i[l][d];o[l].push({index:p,indexEnd:m,height:v,y:g,x:u,width:c,content:y,tooltip:r[l][d]})}}}return this.lastPaintInfo=o,o},STAT4YOU.Table.LeftHeaderZone.prototype.cellAtPoint=function(t){return _.find(_.flatten(this.lastPaintInfo,!0),function(n){var i=new e(n.x,n.y,n.width,n.height);return i.containsPoint(t)})},STAT4YOU.Table.LeftHeaderZone.prototype.titleAtPoint=function(t){var e=this.cellAtPoint(t);return e?e.tooltip:void 0},STAT4YOU.Table.LeftHeaderZone.prototype.rowsAtPoint=function(t){var e=this.cellAtPoint(t);return e?_.range(e.index,e.indexEnd):void 0},STAT4YOU.Table.LeftHeaderZone.prototype.repaint=function(){this.clear(),this.paintShadow(),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x,this.viewPort.y,this.viewPort.width+.5,this.viewPort.height),this.ctx.clip();var t=this.paintInfo();this.paintCells(t),this.paintBorders(),this.ctx.restore(),this.needRepaint=!1},STAT4YOU.Table.LeftHeaderZone.prototype.paintShadow=function(){this.delegate.style.headerCell.shadow.show&&0!==this.bodyZone.origin.x&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x,this.viewPort.y,this.viewPort.width+.5+30,this.viewPort.height),this.ctx.clip(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x,this.viewPort.y,this.viewPort.width,this.viewPort.height),this.ctx.shadowColor=this.delegate.style.headerCell.shadow.color,this.ctx.shadowBlur=this.delegate.style.headerCell.shadow.blur,this.ctx.shadowOffsetX=this.delegate.style.headerCell.shadow.offset,this.ctx.shadowOffsetY=0,this.ctx.fill(),this.ctx.restore())},STAT4YOU.Table.LeftHeaderZone.prototype.paintBorders=function(){this.dataSource.leftHeaderColumns(),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x+.5,this.viewPort.y+.5,this.viewPort.width,this.viewPort.height-1),this.ctx.strokeStyle=this.delegate.style.headerCell.border.color,this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()},STAT4YOU.Table.LeftHeaderZone.prototype.paintCells=function(t){this.ctx.save(),this.ctx.lineWidth=this.delegate.style.headerCell.border.width,this.ctx.strokeStyle=this.delegate.style.headerCell.border.color,this.ctx.font=this.delegate.style.headerCell.font,this.ctx.textBaseline="top",this.ctx.textAlign="left";for(var e,n=this.delegate.style.headerCell.margin.left,i=0;t.length>i;i++)for(var r=t[i],a=0;r.length>a;a++){var s=r[a];if(this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(s.x,s.y,s.width+.5,s.height+.5),this.ctx.clip(),this.ctx.beginPath(),this.ctx.rect(s.x+.5,s.y+.5,s.width,s.height),_.isFunction(this.delegate.style.headerCell.background)){var o={rows:_.range(s.index,s.indexEnd)};e=this.delegate.style.headerCell.background(o,this.view)}else e=this.delegate.style.headerCell.background;this.ctx.fillStyle=e,this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath(),this.ctx.fillStyle=this.delegate.style.headerCell.color,this.ctx.fillText(s.content,s.x+n,s.y+n),this.ctx.restore()}this.ctx.restore()},STAT4YOU.Table.LeftHeaderZone.prototype.separatorIndexInRectangle=function(t){for(var e=0;this.incrementalCellSize.columns.length>e;e++){var n=this.incrementalCellSize.columns[e];if(t.containsPoint(new i(n+this.viewPort.x,t.y)))return e}}}(),function(){"use strict";var t=STAT4YOU.Table.Size,e=STAT4YOU.Table.Rectangle,n=STAT4YOU.Table.Utils,i=STAT4YOU.Table.Point;STAT4YOU.namespace("STAT4YOU.Table.TopHeaderZone"),STAT4YOU.Table.TopHeaderZone=function(t){STAT4YOU.Table.Zone.prototype.initialize.apply(this,arguments),this.initialize(t)},_.extend(STAT4YOU.Table.TopHeaderZone.prototype,STAT4YOU.Table.Zone.prototype),STAT4YOU.Table.TopHeaderZone.prototype.initialize=function(t){t||(t={}),this.bodyZone=t.bodyZone,this.dataSource=t.dataSource,this.delegate=t.delegate,this.view=t.view,this.calculateIncrementalSize()},STAT4YOU.Table.TopHeaderZone.prototype.calculateIncrementalSize=function(){if(this.dataSource&&this.delegate){var e=this,i=this.dataSource.topHeaderRows(),r=n.acumulate(i,function(t){return e.delegate.topHeaderRowHeight(t,e.view)});this.incrementalCellSize={rows:r,columns:this.bodyZone.incrementalCellSize.columns};var a=r[r.length-1],s=this.bodyZone.size.width;this.setSize(new t(s,a))}},STAT4YOU.Table.TopHeaderZone.prototype.paintInfo=function(){for(var t=this.bodyZone.paintInfo(),e=this.dataSource.topHeaderRows(),i=this.dataSource.topHeaderValues(),r=this.dataSource.topHeaderTooltipValues(),a=_.map(i,function(t){return t.length}),s=n.rightProductAcumulate(a),o=[],l=0;e>l;l++){o[l]=[];for(var c=this.delegate.topHeaderRowHeight(l,this.view),u=this.incrementalCellSize.rows[l],h=0;t.columns.length>h;h++){var d=t.columns[h],f=Math.floor(d.index/s[l]),p=f*s[l];if(0===o[l].length||_.last(o[l]).index!=p){var g=this.incrementalCellSize.columns[p]-this.bodyZone.origin.x+this.viewPort.x,m=p+s[l],v=this.incrementalCellSize.columns[m]-this.incrementalCellSize.columns[p],d=f%a[l],y=i[l][d];o[l].push({index:p,indexEnd:m,height:c,y:u,x:g,width:v,content:y,tooltip:r[l][d]})}}}return this.lastPaintInfo=o,o},STAT4YOU.Table.TopHeaderZone.prototype.cellAtPoint=function(t){return _.find(_.flatten(this.lastPaintInfo,!0),function(n){var i=new e(n.x,n.y,n.width,n.height);return i.containsPoint(t)})},STAT4YOU.Table.TopHeaderZone.prototype.titleAtPoint=function(t){var e=this.cellAtPoint(t);return e?e.tooltip:void 0},STAT4YOU.Table.TopHeaderZone.prototype.columnsAtPoint=function(t){var e=this.cellAtPoint(t);return e?_.range(e.index,e.indexEnd):void 0},STAT4YOU.Table.TopHeaderZone.prototype.repaint=function(){this.clear(),this.paintShadow(),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x,this.viewPort.y,this.viewPort.width,this.viewPort.height),this.ctx.clip();var t=this.paintInfo();this.paintCells(t),this.paintGrid(),this.ctx.restore(),this.needRepaint=!1},STAT4YOU.Table.TopHeaderZone.prototype.paintShadow=function(){this.delegate.style.headerCell.shadow.show&&0!==this.bodyZone.origin.y&&(this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x,this.viewPort.y,this.viewPort.width+.5,this.viewPort.height+30),this.ctx.clip(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x,this.viewPort.y,this.viewPort.width,this.viewPort.height+.5),this.ctx.shadowColor=this.delegate.style.headerCell.shadow.color,this.ctx.shadowBlur=this.delegate.style.headerCell.shadow.blur,this.ctx.shadowOffsetX=0,this.ctx.shadowOffsetY=this.delegate.style.headerCell.shadow.offset,this.ctx.fill(),this.ctx.restore())},STAT4YOU.Table.TopHeaderZone.prototype.paintGrid=function(){this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(this.viewPort.x+.5,this.viewPort.y+.5,this.viewPort.width-1,this.viewPort.height+.5),this.ctx.strokeStyle=this.delegate.style.headerCell.border.color,this.ctx.closePath(),this.ctx.stroke(),this.ctx.restore()},STAT4YOU.Table.TopHeaderZone.prototype.paintCells=function(t){this.ctx.save(),this.ctx.lineWidth=this.delegate.style.headerCell.border.width,this.ctx.strokeStyle=this.delegate.style.headerCell.border.color,this.ctx.font=this.delegate.style.headerCell.font,this.ctx.textBaseline="middle",this.ctx.textAlign="left";for(var e,n=this.delegate.style.headerCell.margin.left,i=0;t.length>i;i++)for(var r=t[i],a=0;r.length>a;a++){var s=r[a];if(this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(s.x,s.y,s.width+.5,s.height+.5),this.ctx.clip(),this.ctx.beginPath(),this.ctx.rect(s.x+.5,s.y+.5,s.width,s.height),_.isFunction(this.delegate.style.headerCell.background)){var o={columns:_.range(s.index,s.indexEnd)};e=this.delegate.style.headerCell.background(o,this.view)}else e=this.delegate.style.headerCell.background;this.ctx.fillStyle=e,this.ctx.fill(),this.ctx.stroke(),this.ctx.closePath(),this.ctx.fillStyle=this.delegate.style.headerCell.color,this.ctx.fillText(s.content,s.x+ +n,Math.ceil(s.y+s.height/2)),this.ctx.restore()}this.ctx.restore()},STAT4YOU.Table.TopHeaderZone.prototype.separatorIndexInRectangle=function(t){this.lastPaintInfo||this.paintInfo();for(var e=_.last(this.lastPaintInfo),n=0;e.length>n;n++){var r=e[n];if(t.containsPoint(new i(r.x,t.y)))return r.index;if(t.containsPoint(new i(r.x+r.width,t.y)))return r.indexEnd}}}(),function(){"use strict";var t=STAT4YOU.Table.Point;STAT4YOU.namespace("STAT4YOU.Table.SpinnerZone"),STAT4YOU.Table.SpinnerZone=function(t){STAT4YOU.Table.Zone.prototype.initialize.apply(this,arguments),this.initialize(t)},_.extend(STAT4YOU.Table.SpinnerZone.prototype,STAT4YOU.Table.Zone.prototype),STAT4YOU.Table.SpinnerZone.prototype.initialize=function(t){this.speed=t.speed||.005,this.spinnerSize=t.spinnerSize||4,this.onAjax=!1,_.bindAll(this,"ajaxStart","ajaxStop","loop"),$(document).bind("ajaxStart.spinnerZone",this.ajaxStart),$(document).bind("ajaxStop.spinnerZone",this.ajaxStop)},STAT4YOU.Table.SpinnerZone.prototype.destroy=function(){$(document).unbind(".spinnerZone")},STAT4YOU.Table.SpinnerZone.prototype.ajaxStart=function(){this.onAjax||(this.onAjax=!0,this.loop())},STAT4YOU.Table.SpinnerZone.prototype.ajaxStop=function(){this.onAjax=!1,this.clear()},STAT4YOU.Table.SpinnerZone.prototype.loop=function(){this.onAjax&&(this.repaint(),window.requestAnimationFrame(this.loop))},STAT4YOU.Table.SpinnerZone.prototype.repaint=function(){this.ctx.save();var e=(new Date).getTime();this.clear();for(var n=0;this.spinnerSize>n;n++){var i=(e*this.speed-n*Math.PI/this.spinnerSize)%Math.PI,r=Math.sin(i);this.ctx.fillStyle="rgba(255, 153, 0, "+r+")";var a=this.absolutePoint2RelativePoint(new t(20*n,10));this.ctx.fillRect(a.x,a.y,10,10)}this.ctx.restore()}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.View");var t=STAT4YOU.Table.Cell,e=STAT4YOU.Table.Size,n=STAT4YOU.Table.Point,i=STAT4YOU.Table.BodyZone,r=STAT4YOU.Table.RightScrollZone,a=STAT4YOU.Table.BottomScrollZone,s=STAT4YOU.Table.LeftHeaderZone,o=STAT4YOU.Table.TopHeaderZone,l=STAT4YOU.Table.Rectangle,c=STAT4YOU.Table.SpinnerZone,u=STAT4YOU.components.tooltip.Tooltip;STAT4YOU.Table.View=function(t){_.isString(t.el)?this.canvas=document.getElementById(t.el):t.canvas&&(this.canvas=t.canvas),this.$canvas=$(this.canvas),this.dataSource=t.dataSource,this.delegate=t.delegate,this.canvas&&this.canvas.getContext&&(this.ctx=this.canvas.getContext("2d")),this.selection={rows:[],columns:[]},this.initializeZones(),this.initializeTooltip()},STAT4YOU.Table.View.prototype.initializeZones=function(){this.scrollSize=10,this.spinnerSize=new e(70,30),this.bodyZone=new i({context:this.ctx,dataSource:this.dataSource,delegate:this.delegate,view:this}),this.leftHeaderZone=new s({context:this.ctx,bodyZone:this.bodyZone,dataSource:this.dataSource,delegate:this.delegate,view:this}),this.topHeaderZone=new o({context:this.ctx,bodyZone:this.bodyZone,dataSource:this.dataSource,delegate:this.delegate,view:this}),this.rightScrollZone=new r({context:this.ctx,bodyZone:this.bodyZone,delegate:this.delegate,view:this}),this.bottomScrollZone=new a({context:this.ctx,bodyZone:this.bodyZone,delegate:this.delegate,view:this}),this.spinnerZone&&this.spinnerZone.destroy(),this.spinnerZone=new c({context:this.ctx}),this.spinnerZone.setSize(this.spinnerSize),this.setZonesViewPorts(),this.zones=[this.bodyZone,this.rightScrollZone,this.bottomScrollZone,this.leftHeaderZone,this.topHeaderZone]},STAT4YOU.Table.View.prototype.getSize=function(){return new e(this.canvas.width,this.canvas.height)},STAT4YOU.Table.View.prototype.setZonesViewPorts=function(){var t=this.getSize();this.leftHeaderZone.calculateIncrementalSize(),this.topHeaderZone.calculateIncrementalSize(),this.bodyZone.calculateIncrementalSize(),this.leftHeaderZone.setViewPort(new l(0,this.topHeaderZone.size.height,this.leftHeaderZone.size.width,t.height-this.topHeaderZone.size.height-this.scrollSize-this.spinnerZone.size.height)),this.topHeaderZone.setViewPort(new l(this.leftHeaderZone.size.width,0,t.width-this.leftHeaderZone.size.width-this.scrollSize,this.topHeaderZone.size.height)),this.bodyZone.setViewPort(new l(this.leftHeaderZone.size.width,this.topHeaderZone.size.height,t.width-this.leftHeaderZone.size.width-this.scrollSize,t.height-this.topHeaderZone.size.height-this.scrollSize-this.spinnerZone.size.height)),this.rightScrollZone.setViewPort(new l(t.width-this.scrollSize,this.topHeaderZone.size.height,this.scrollSize,t.height-this.topHeaderZone.size.height-this.scrollSize-this.spinnerZone.size.height)),this.bottomScrollZone.setViewPort(new l(this.leftHeaderZone.size.width,this.bodyZone.viewPort.bottomLeftPoint().y,t.width-this.leftHeaderZone.size.width-this.scrollSize,this.scrollSize)),this.spinnerZone.setViewPort(new l(this.bodyZone.viewPort.bottomRightPoint().x-this.spinnerZone.size.width,t.height-this.spinnerZone.size.height,this.spinnerZone.size.width,this.spinnerZone.size.height))},STAT4YOU.Table.View.prototype.initializeTooltip=function(){var t=this;this.tooltipDelegate={getTitleAtMousePosition:function(e){return t.getTitleAtMousePosition(e)}},this.tooltip=new u({el:this.$canvas,delegate:this.tooltipDelegate})},STAT4YOU.Table.View.prototype.clear=function(){var t=this.getSize();this.ctx.clearRect(0,0,t.width,t.height)},STAT4YOU.Table.View.prototype.repaint=function(){_.each(this.zones,function(t){t.needRepaint&&t.repaint()})},STAT4YOU.Table.View.prototype.forceRepaintBody=function(){this.bodyZone.repaint()},STAT4YOU.Table.View.prototype.forceRepaint=function(){this.clear(),this.leftHeaderZone.calculateIncrementalSize(),this.topHeaderZone.calculateIncrementalSize(),this.bodyZone.repaint(),this.leftHeaderZone.repaint(),this.topHeaderZone.repaint(),this.bottomScrollZone.repaint(),this.rightScrollZone.repaint()},STAT4YOU.Table.View.prototype.move=function(t){var e=this;_.each(e.zones,function(e){e.move(t)}),e.repaint()},STAT4YOU.Table.View.prototype.moveToBegin=function(){var t=new n(0,this.bodyZone.origin.y);this.move(t)},STAT4YOU.Table.View.prototype.moveToEnd=function(){var t=new n(0,-this.bodyZone.size.height);this.move(t)},STAT4YOU.Table.View.prototype.pagedown=function(){var t=new n(0,-this.bodyZone.viewPort.height);this.move(t)},STAT4YOU.Table.View.prototype.pageup=function(){var t=new n(0,this.bodyZone.viewPort.height);this.move(t)},STAT4YOU.Table.View.prototype.scrollDistance=function(t){if(0===t.x){var e=Math.round(this.bodyZone.size.height*t.y/this.rightScrollZone.viewPort.height);this.move(new n(0,e))}else{var i=Math.round(this.bodyZone.size.width*t.x/this.bottomScrollZone.viewPort.width);this.move(new n(i,0))}},STAT4YOU.Table.View.prototype.stepScroll=function(t){var e,i;0===t.x?(e=this.rightScrollZone.scrollRectangle(),i=e.y>t.y?1:-1,this.scrollDistance(new n(0,10*i))):(e=this.bottomScrollZone.scrollRectangle(),i=e.x>t.x?1:-1,this.scrollDistance(new n(10*i,0)))},STAT4YOU.Table.View.prototype.zoneFromPoint=function(t){var e,n,i=l.createFromPointWithOffset(t);return this.leftHeaderZone.separatorIndexInRectangle(i)>0?e="leftHeaderZone-separator":_.isUndefined(this.topHeaderZone.separatorIndexInRectangle(i))?this.leftHeaderZone.viewPort.containsPoint(t)?e="leftHeaderZone":this.topHeaderZone.viewPort.containsPoint(t)?e="topHeaderZone":this.bodyZone.viewPort.containsPoint(t)?e="bodyZone":this.rightScrollZone.viewPort.containsPoint(t)?(n=this.rightScrollZone.scrollRectangle(),e=n.containsPoint(t)?"rightScrollZone-scrollBar":"rightScrollZone"):this.bottomScrollZone.viewPort.containsPoint(t)&&(n=this.bottomScrollZone.scrollRectangle(),e=n.containsPoint(t)?"bottomScrollZone-scrollBar":"bottomScrollZone"):e="topHeaderZone-separator",e},STAT4YOU.Table.View.prototype.update=function(){this.setZonesViewPorts(),this.forceRepaint()},STAT4YOU.Table.View.prototype.resize=function(t){this.canvas.width=t.width,this.canvas.height=t.height,this.update(),this.tooltip.setEl(this.$canvas)},STAT4YOU.Table.View.prototype.isSelectionActive=function(t){return!_.difference(t.rows,this.selection.rows).length&&!_.difference(t.columns,this.selection.columns).length},STAT4YOU.Table.View.prototype.toggleArrays=function(t,e){var n,i=_.difference(e,t);return n=i.length?_.union(t,i):_.difference(t,e)
},STAT4YOU.Table.View.prototype.toggleSelection=function(t){this.selection.rows=this.toggleArrays(this.selection.rows,t.rows),this.selection.rows.sort(),this.selection.columns=this.toggleArrays(this.selection.columns,t.columns),this.selection.columns.sort()},STAT4YOU.Table.View.prototype.setActiveCell=function(e){var i;if(e instanceof t)i=e;else if(e instanceof n){var r=this.zoneFromPoint(e);if("bodyZone"===r||"leftHeaderZone"===r||"topHeaderZone"===r){if("bodyZone"===r){i=this.bodyZone.relativePoint2Cell(e);var a=1===this.selection.rows.length&&1===this.selection.columns.length,s=this.selection.rows[0]===i.y&&this.selection.columns[0]===i.x;this.selection=a&&s?{rows:[],columns:[]}:{rows:[i.y],columns:[i.x]}}else if("leftHeaderZone"===r){var o=this.leftHeaderZone.rowsAtPoint(e);this.toggleSelection({rows:o})}else{var l=this.topHeaderZone.columnsAtPoint(e);this.toggleSelection({columns:l})}this.leftHeaderZone.needRepaint=!0,this.topHeaderZone.needRepaint=!0,this.bodyZone.needRepaint=!0,this.repaint()}}},STAT4YOU.Table.View.prototype.setMousePosition=function(t,e){this.mouseInCanvas=e.target===this.canvas,this.mousePosition=t,this.setMouseZone(t)},STAT4YOU.Table.View.prototype.setMouseZone=function(t){var e=this.zoneFromPoint(t),n=this.mouseZone!==e;this.mouseZone=e,n&&(this.rightScrollZone.repaint(),this.bottomScrollZone.repaint())},STAT4YOU.Table.View.prototype.getTitleAtMousePosition=function(t){return"leftHeaderZone"===this.mouseZone?this.leftHeaderZone.titleAtPoint(t):"topHeaderZone"===this.mouseZone?this.topHeaderZone.titleAtPoint(t):void 0},STAT4YOU.Table.View.prototype.setLastClickZone=function(t){var e=this.lastClickZone!==t;this.lastClickZone=t,e&&(this.rightScrollZone.repaint(),this.bottomScrollZone.repaint())},STAT4YOU.Table.View.prototype.destroy=function(){this.tooltip.destroy()},STAT4YOU.Table.View.prototype.columnSeparatorIndex=function(t){var e=l.createFromPointWithOffset(t);return this.topHeaderZone.separatorIndexInRectangle(e)},STAT4YOU.Table.View.prototype.leftColumnHeaderSeparatorIndex=function(t){var e=l.createFromPointWithOffset(t);return this.leftHeaderZone.separatorIndexInRectangle(e)},STAT4YOU.Table.View.prototype.resizeColumnWidth=function(t,e){this.delegate.resizeColumnWidth(t,e.x),this.clear(),this.bodyZone.calculateIncrementalSize(),this.setZonesViewPorts(),this.repaint()},STAT4YOU.Table.View.prototype.resizeLeftHeaderColumnWidth=function(t,e){this.delegate.resizeLeftHeaderColumnWidth(t,e.x),this.clear(),this.bodyZone.calculateIncrementalSize(),this.setZonesViewPorts(),this.repaint()}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Table.ScrollManager");var t=STAT4YOU.Table.Point;STAT4YOU.Table.Rectangle;var e=STAT4YOU.Table.ScrollManager=function(t){this.view=t,this.canvas=t.canvas,this.$canvas=$(this.canvas),this.lastPoint=void 0,this.$body=$("body"),this.$document=$(document),this.eventNamespace=".scrollManager",_.bindAll(this,"mousemove","mousedown","mouseup","mousewheel","dblclick","mouseleave"),this.bindEvents()};e.prototype.destroy=function(){this.$body.removeClass("move move-updown col-resize move-lefright"),this.unbindEvents()},e.prototype.pointFromEvent=function(t){var e,n=this.pointFromTouchEvent(t);return e=n?n:this.pointFromMouseEvent(t)},e.prototype.pointFromMouseEvent=function(e){var n=this.$canvas.offset(),i=e.pageX-n.left,r=e.pageY-n.top;return new t(i,r)},e.prototype.pointFromTouchEvent=function(e){if(e.targetTouches&&1===e.targetTouches.length){var n=this.$canvas.offset(),i=e.targetTouches[0];return new t(i.pageX-n.left,i.pageY-n.top)}},e.prototype.bindEvents=function(){this.bindMouseEvents(),this.bindTouchEvents()},e.prototype.bindTouchEvents=function(){var t=this;this.canvas.addEventListener("touchmove",function(e){t.mousemove(e)},!1),this.canvas.addEventListener("touchstart",function(e){t.mousedown(e)},!1),this.canvas.addEventListener("touchend",function(e){t.mouseup(e)},!1)},e.prototype.bindMouseEvents=function(){this.$canvas.on("mousedown"+this.eventNamespace,this.mousedown),this.$canvas.on("dblclick"+this.eventNamespace,this.dblclick),this.$canvas.on("mousemove"+this.eventNamespace,this.mousemove),this.$canvas.on("mouseleave"+this.eventNamespace,this.mouseleave),this.$canvas.on("mousewheel",this.mousewheel)},e.prototype.unbindEvents=function(){this.$document.off(this.eventNamespace)},e.prototype.mousemove=function(t){var e=this.pointFromEvent(t);if(this.changeCursor(e),this.lastPoint){var n=e.distance(this.lastPoint);"rightScrollZone-scrollBar"===this.lastZone?(n=n.negate(),n.x=0,this.view.scrollDistance(n)):"bottomScrollZone-scrollBar"===this.lastZone?(n=n.negate(),n.y=0,this.view.scrollDistance(n)):"leftHeaderZone"===this.lastZone?(n.x=0,this.view.move(n)):"topHeaderZone"===this.lastZone?(n.y=0,this.view.move(n)):"bodyZone"===this.lastZone?this.view.move(n):"leftHeaderZone-separator"===this.lastZone?this.view.resizeLeftHeaderColumnWidth(this.lastLeftColumnSeparator,n):"topHeaderZone-separator"===this.lastZone&&this.view.resizeColumnWidth(this.lastColumnSeparator,n),this.lastPoint=e}this.view.setMousePosition(e,t)},e.prototype.mousedown=function(e){var n=this.pointFromEvent(e),i=this.view.zoneFromPoint(n);this.lastPoint=n,this.lastZone=i,this.lastColumnSeparator=this.view.columnSeparatorIndex(n),this.lastLeftColumnSeparator=this.view.leftColumnHeaderSeparatorIndex(n),this.view.setLastClickZone(i);var r=this;return"rightScrollZone"===i?r.repeatUntil(function(){r.view.stepScroll(new t(0,n.y))},function(){return i===r.view.zoneFromPoint(n)&&n.eq(r.lastPoint)},100):"bottomScrollZone"===i&&r.repeatUntil(function(){r.view.stepScroll(new t(n.x,0))},function(){return i===r.view.zoneFromPoint(n)&&n.eq(r.lastPoint)},100),this.$canvas.off("mousemove"+this.eventNamespace),this.$canvas.off("mouseleave"+this.eventNamespace),this.$document.one("mouseup"+this.eventNamespace,this.mouseup),this.$document.on("mousemove"+this.eventNamespace,this.mousemove),!1},e.prototype.mouseup=function(t){this.lastPoint=void 0,this.lastZone=void 0,this.view.setLastClickZone(this.lastZone);var e=this.pointFromEvent(t);this.changeCursor(e),this.$document.off("mousemove"+this.eventNamespace),this.$canvas.on("mousemove"+this.eventNamespace,this.mousemove),this.$canvas.on("mouseleave"+this.eventNamespace,this.mouseleave)},e.prototype.mouseleave=function(t){var e=this.pointFromEvent(t);this.changeCursor(e)},e.prototype.repeatUntil=function(t,e,n){var i=function(){e()&&(t(),setTimeout(i,n))};i()},e.prototype.mousewheel=function(t,e,n,i){return this.view.move(new STAT4YOU.Table.Point(60*n,60*i)),!1},e.prototype.changeCursor=function(t){if(!this.lastPoint){var e,n=this.view.zoneFromPoint(t);"bodyZone"===n?e="move":"leftHeaderZone"===n?e="move-updown":"leftHeaderZone-separator"===n?e="col-resize":"topHeaderZone"===n?e="move-leftright":"topHeaderZone-separator"===n&&(e="col-resize"),e&&this.$body.addClass(e);var i=_.without(["move","move-updown","move-leftright","col-resize"],e).join(" ");this.$body.removeClass(i)}},e.prototype.dblclick=function(t){var e=this.pointFromEvent(t);this.view.setActiveCell(e)}}(),function(){"use strict";var t=STAT4YOU.Table.Point;STAT4YOU.namespace("STAT4YOU.Table.KeyboardManager"),STAT4YOU.Table.KeyboardManager=function(t){this.init(t)},STAT4YOU.Table.KeyboardManager.prototype={init:function(t){this.view=t.view,this.speed=15,this.wait=1e3/60,_.bindAll(this,"loop","arrow","home","end","pageup","pagedown"),this.bindEvents()},destroy:function(){this.unbindEvents()},bindEvents:function(){var t=$(document);t.bind("keydown.up keydown.right keydown.down keydown.left",this.arrow),t.bind("keydown.home",this.home),t.bind("keydown.end",this.end),t.bind("keydown.pageup",this.pageup),t.bind("keydown.pagedown",this.pagedown)},unbindEvents:function(){var t=$(document);t.unbind("keydown.up keydown.right keydown.down keydown.left",this.arrow),t.unbind("keydown.home",this.home),t.unbind("keydown.end",this.end),t.unbind("keydown.pageup",this.pageup),t.unbind("keydown.pagedown",this.pagedown)},isArrowKeyPressed:function(){return keydown.up||keydown.right||keydown.down||keydown.left},home:function(){return this.view.moveToBegin(),!1},end:function(){return this.view.moveToEnd(),!1},pageup:function(){return this.view.pageup(),!1},pagedown:function(){return this.view.pagedown(),!1},arrow:function(){return this.timer||this.loop(),!1},loop:function(){if(this.isArrowKeyPressed()){var e=new t(0,0);keydown.left?e.x=this.speed:keydown.right&&(e.x=-this.speed),keydown.up?e.y=this.speed:keydown.down&&(e.y=-this.speed),this.view.move(e),this.timer=setTimeout(this.loop,this.wait)}else this.timer=void 0}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Map"),STAT4YOU.Map.TooltipDelegate=function(t){this.initialize(t)},STAT4YOU.Map.TooltipDelegate.prototype={initialize:function(t){this.text=null,this._dataset=t.dataset,this._filterOptions=t.filterOptions,this._dataJson=t.dataJson,_.bindAll(this,"mouseOut","mouseOver")},mouseOut:function(){this.text=null},mouseOver:function(t){if(t.properties.contour)this.text=null;else{var e=t.properties.normCode,n=this._getLabelFromNormCode(e),i=this._getValueFromNormCode(e);this.text=n+" : "+i}},_getLabelFromNormCode:function(t){return this._dataset.metadata.getCategoryByNormCode(this._filterOptions.getMapDimension().id,t).label},_getValueFromNormCode:function(t){var e=this._dataJson[t];return e?STAT4YOU.dataset.data.NumberFormatter.strNumberToLocalizedString(""+e.value):"."},getTitleAtMousePosition:function(){return this.text}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Map.GeoJsonConverter"),STAT4YOU.Map.GeoJsonConverter={shapeListToGeoJson:function(t,e){var n={type:"FeatureCollection"};return n.features=_.chain(t).compact().map(function(t){var n={type:"Feature",id:t.normCode,properties:{normCode:t.normCode},geometry:{type:t.geometryType,coordinates:t.shape}};return e&&_.extend(n.properties,e),n}).value(),n},geoJsonToShapeList:function(t){return _.map(t.features,function(t){return{normCode:t.properties.normCode,geometryType:t.geometry.type,shape:t.geometry.coordinates,hierarchy:this._hierarchyByNormCode(t.properties.normCode)}},this)},_hierarchyByNormCode:function(t){var e=-1;if(t){var n=["WORLD","CONTINENT","COUNTRY","ADM-LEVEL-1","ADM-LEVEL-2","ISLAND","ADM-LEVEL-3"],i=t.substring(t.lastIndexOf("_")+1);e=_.indexOf(n,i)}return e}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Map.MapContainerView"),STAT4YOU.Map.MapContainerView=Backbone.View.extend({_errorTemplate:STAT4YOU.templateManager.get("widget/map/map-error"),initialize:function(t){this._dataset=t.dataset,this._filterOptions=t.filterOptions,this._mapModel=t.mapModel,this._width=t.width,this._height=t.height,this.geoJson=t.geoJson,this.container=t.container,this.dataJson=t.dataJson,this.$el.empty(),this._initInternalViews()},render:function(){this.mapView.canRender()?(this.zoomView.render(),this.rangesView.render(),this.mapView.render()):this.$el.html(this._errorTemplate())},destroy:function(){this.mapView.destroy(),this.zoomView.destroy(),this.rangesView.destroy()},transform:function(){this.mapView.transform(),this.zoomView.transform()},updateRanges:function(){this.mapView.updateRanges(),this.rangesView.updateRanges()},zoomExit:function(){this.mapView.zoomExit()},_initInternalViews:function(){this._initMapView(),this._initZoomView(),this._initLeyendView(),this._initRangesView()},_initMapView:function(){var t=$('<div class="svgContainer"></div>').appendTo(this.$el);this.mapView=new STAT4YOU.Map.MapView({el:t,dataset:this._dataset,filterOptions:this._filterOptions,model:this._mapModel,shapeList:this.geoJson,container:this.container,dataJson:this.dataJson,width:this._width,height:this._height})},_initZoomView:function(){var t=$('<div id="zoom-container"/>').appendTo(this.$el);this.zoomView=new STAT4YOU.Map.ZoomView({el:t.get(0),model:this._mapModel,width:this._width,height:this._height})},_initLeyendView:function(){},_initRangesView:function(){var t=$('<div id="ranges-container"/>').appendTo(this.$el);this.rangesView=new STAT4YOU.Map.RangesView({el:t.get(0),model:this._mapModel,width:this._width,height:this._height})}})}(),function(){"use strict";var t=STAT4YOU.Map.GeoJsonConverter;STAT4YOU.namespace("STAT4YOU.Map.MapView"),STAT4YOU.Map.MapView=Backbone.View.extend({initialize:function(t){this._dataset=t.dataset,this._filterOptions=t.filterOptions,this._width=t.width,this._height=t.height,this._shapeList=t.shapeList,this._container=t.container,this._dataJson=t.dataJson,this.tooltipDelegate=new STAT4YOU.Map.TooltipDelegate(t),_.bindAll(this,"_calculateColor"),this._onResize=_.debounce(_.bind(this._onResize,this),200)},events:{mousewheel:"_handleMousewheel",dblclick:"_handleDblclick",resize:"_onResize"},render:function(){this._calculateOriginAndScale(),this._createProjection(),this._createSvgContainerAndTooltip(),this._createQuantizer(),this._createMapContent(),this._legendView=new STAT4YOU.Map.LegendView({el:this._svg[0],model:this.model,container:this.el}),this._legendView.render(),this._creditsView=new STAT4YOU.Map.CredistView({el:this._svg[0],container:this.el}),this._creditsView.render(),this.model.set({currentScale:2}),this.delegateEvents()},destroy:function(){this._svg&&this._svg.remove(),this.tooltip&&this.tooltip.destroy(),this.undelegateEvents()},transform:function(){var t=this.model.get("currentScale"),e=this.model.get("x"),n=this.model.get("y"),i=this.model.get("animationDelay");i?this._regions.transition().duration(i).attr("transform","scale("+t+")translate("+e+","+n+")"):this._regions.attr("transform","scale("+t+")translate("+e+","+n+")")},zoomExit:function(){this._centered=null,this._regions.selectAll("path").classed("active",this._centered)},updateRanges:function(){this._legendView.render(),this._createQuantizer(),this._repaintRegions()},canRender:function(){return this._shapeListOrderByHierarchy().length>0},_updateSize:function(){if(this._svg){var t=this.$el.width(),e=this.$el.height();(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.destroy(),this.render())}},_calculateOriginAndScale:function(){this._origin=this._calculateNewOriginAndBounds(),this._scale=this._calculateNewScale({x:this._minX,y:this._minY},{x:0,y:0},this._origin)},_calculateNewOriginAndBounds:function(){var t=_.chain(this._shapeList).compact().pluck("shape").flatten().value(),e=_.filter(t,function(t,e){return 0===e%2}),n=_.filter(t,function(t,e){return 0!==e%2});this._maxX=_.max(e),this._minX=_.min(e),this._maxY=_.max(n),this._minY=_.min(n);var i=this._minX+(this._maxX-this._minX)/2,r=this._minY+(this._maxY-this._minY)/2;return[i,r]},_calculateNewScale:function(t,e,n){var i=d3.geo.albers().origin(n).translate([0,0]),r=i.scale(),a=i([t.x,t.y])[0],s=-this._width/2*r/a,o=i([t.x,t.y])[1],l=-this._height/2*r/o;return Math.abs(s)<Math.abs(l)?Math.abs(s)/2.3:Math.abs(l)/2.3},_createProjection:function(){this._projection=d3.geo.albers().origin(this._origin).scale(this._scale).translate([0,0]),this._path=d3.geo.path().projection(this._projection),this._dnd=d3.behavior.drag(),this._dnd.on("drag",_.bind(this._handleDrag,this)),this._dnd.on("dragstart",_.bind(this._handleDragstart,this)),this._dnd.on("dragend",_.bind(this._handleDragend,this))},_createSvgContainerAndTooltip:function(){this._svg=d3.select(this.el).append("svg:svg").attr("width",this._width).attr("height",this._height).attr("xmlns","http://www.w3.org/2000/svg").attr("version","1.1").attr("class","map"),this._svg.append("rect").attr("class","background").attr("width",this._width).attr("height",this._height).on("click",_.bind(this._handleClick,this)).call(this._dnd),this.tooltip&&this.tooltip.destroy(),this.tooltip=new STAT4YOU.components.tooltip.Tooltip({el:this.el,delegate:this.tooltipDelegate})},_shapeListOrderByHierarchy:function(){return _.chain(this._shapeList).compact().sortBy(function(t){return t.hierarchy}).value()},_createMapContent:function(){var e=this;this._width=this.$el.width(),this._height=this.$el.height(),this._regions=this._svg.append("svg:g").attr("transform","translate("+this._width/2+","+this._height/2+")").append("g").attr("id","regions").call(this._dnd),this._createQuantizer();var n=t.shapeListToGeoJson(this._shapeListOrderByHierarchy()),i=t.shapeListToGeoJson([this._container],{contour:!0}),r=_.union(i.features,n.features);this._regions.selectAll("path").data(r).enter().append("svg:path").attr("d",this._path).attr("class",_.bind(this._calculateColor,this)).on("click",_.bind(e._handleClick,this)).on("mouseover",e.tooltipDelegate.mouseOver).on("mouseout",e.tooltipDelegate.mouseOut)},_createQuantizer:function(){this.model.get("minValue"),this.model.get("maxValue");var t=this.model.get("currentRangesNum");this._quantizer=d3.scale.quantile().domain(this.model.get("values")).range(d3.range(t))},_repaintRegions:function(){var t=this;this._regions.selectAll("path").attr("class",t._calculateColor).classed("active",function(e){return e===t._centered})},_calculateColor:function(t){if(t.properties.normCode&&!t.properties.contour){var e=this._dataJson[t.properties.normCode];if(!e)return"noAvailable";var n=e.value;if(!isNaN(n)){var i=this.model.get("currentRangesNum");return"color"+i+"-"+this._quantizer(n)}}else if(t.properties.contour)return"contour"},_newCenterOffset:function(t){var e=[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],n=this._projection(e);return n[0]*=-1,n[1]*=-1,n},_newScaleCenteredInObject:function(t){var e=[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],n={x:t[0][0],y:t[0][1]},i={x:0,y:this._height},r=this._calculateNewScale(n,i,e),a=r/this._scale;return a=this.model.transformToValidScaleFactor(a)},_handleClick:function(t){var e=this;this.model.get("maxScale");var n=this.model.get("minScale"),i=[0,0],r=n;if(t&&t.properties.normCode&&!t.properties.contour){this._centered=t,this._regions.selectAll("path").classed("active",this._centered&&function(t){return t===e._centered});var a=d3.geo.bounds(t);i=this._newCenterOffset(a),r=this._newScaleCenteredInObject(a),this.model.set({currentScale:r,x:i[0],y:i[1],animationDelay:1e3})}else this._centered=null,this._regions.selectAll("path").classed("active",!1)},_handleDrag:function(){var t=this.model.get("x"),e=this.model.get("y");return t+=this.model.scaleMovement(d3.event.dx),e+=this.model.scaleMovement(d3.event.dy),this.model.set({x:t,y:e,animationDelay:0}),!0},_handleDragstart:function(){return this.$el.addClass("grabbing"),!0},_handleDragend:function(){return this.$el.removeClass("grabbing"),!0},_offsetFromMouseEvent:function(t){var e=this.$el.offset(),n=t.pageX-(e.left+this._width/2),i=t.pageY-(e.top+this._height/2);return{left:n,top:i}},_handleMousewheel:function(t,e,n,i){var r=this._offsetFromMouseEvent(t);return this.model.zoomMouseWheel({delta:i,xOffset:r.left,yOffset:r.top}),!1},_handleDblclick:function(t){var e=this._offsetFromMouseEvent(t);this.model.zoomMouseWheel({delta:1,xOffset:e.left,yOffset:e.top})},_onResize:function(){this._updateSize(),this.tooltip.setEl(this.el)}})}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Map.ZoomView"),STAT4YOU.Map.ZoomView=Backbone.View.extend({_templateZoom:STAT4YOU.templateManager.get("widget/map/map-zoom"),events:{"click #exit-zoom":"_handleZoomExit","click #more-zoom":"_handleZoomIn","click #less-zoom":"_handleZoomOut"},initialize:function(t){this._width=t.width,this._height=t.height,this._setUpListeners()},render:function(){this.$zoomContainer=$(this._templateZoom()),this.$el.append(this.$zoomContainer),this._storeCSSInfo()},destroy:function(){this.$el.remove(),this.$el.unbind("mousewheel")},transform:function(){var t=this._zoomDecrement()*this._currentZoom(),e=$("#current-zoom");e.css("top",this._baseZoomLineTop-t)},_setUpListeners:function(){_.bindAll(this),this.$el.bind("mousewheel",this._handleMousewheel)},_storeCSSInfo:function(){this.$currentZoom=$("#current-zoom"),this.$zoomLine=$("#zoom-line"),this._baseZoomLineTop=parseInt(this.$currentZoom.css("top"),10)},_zoomDecrement:function(){var t=this.model.numZoomLevels();return this._calculateDecrementPixels(this.$zoomLine.height(),this.$currentZoom.height(),t)},_calculateDecrementPixels:function(t,e,n){return(t-e)/n},_currentZoom:function(){return this.model.currentZoomLevel()},_handleZoomExit:function(){this.model.zoomExit()},_handleZoomIn:function(){this.model.zoomIn()},_handleZoomOut:function(){this.model.zoomOut()},_handleMousewheel:function(t,e){return e>0?this.model.zoomIn():0>e&&this.model.zoomOut(),!1}})}(),function(){STAT4YOU.namespace("STAT4YOU.Map.LegendView");var t=STAT4YOU.svg.SVGNode;STAT4YOU.Map.LegendView=Backbone.View.extend({render:function(){this.destroy();var e=this._createRanges(),n=new t("g");n.set({"class":"legend"});var i=new t("text");i.set({y:10});var r=this.model.get("currentRangesNum"),a=_.map(e,function(e,n){var i=new t("tspan");return i.node.textContent=e,i.set({x:"15"}),n>0&&i.set({dy:"20"}),i}),s=_.map(e,function(e,n){var i=new t("rect");return i.set({width:10,height:10,x:0,y:20*n,"class":"color"+r+"-"+n}),i});i.append(a),n.append(i),n.append(s),this.el.appendChild(n.node);var o=10,l=new t("rect");n.appendFirst(l),l.set(n.getFrame()),l.addMargins(o),l.set({"class":"legendBg",rx:5,ry:5});var c=this._createShadow(l);n.appendFirst(c),this.group=n,new t(this.el);var u={width:$(this.options.container).width(),height:$(this.options.container).height()};this.group.alignBottomRight(u,50,-7)},_createShadow:function(e){var n=t.factory("rect",3),i=e.node.getBBox(),r={rx:e.attrs.rx,ry:e.attrs.ry},a=[5,3,1],s=[.05,.1,.15];_.each(n,function(t,e){t.set(i),t.set(r),t.set({fill:"none",stroke:"black",transform:"translate(1,1)"}),t.set({"stroke-width":a[e]}),t.set({"stroke-opacity":s[e]})});var o=new t("g");return o.append(n),o},destroy:function(){this.group&&this.group.node.parentNode.removeChild(this.group.node)},_createQuantizer:function(){this.model.get("minValue"),this.model.get("maxValue");var t=this.model.get("currentRangesNum"),e=this.model.get("values");return d3.scale.quantile().domain(e).range(d3.range(t))},_createRanges:function(){for(var t=this.model.get("minValue"),e=this.model.get("maxValue"),n=this._createQuantizer(),i=n.quantiles(),r=[],a=_.flatten([t,i,e],!0),s=0;a.length-1>s;s++)r[s]=this._createRange(a[s],a[s+1]);return r},_createRange:function(t,e){var n=STAT4YOU.dataset.data.NumberFormatter.strNumberToLocalizedString(t.toFixed(2)),i=STAT4YOU.dataset.data.NumberFormatter.strNumberToLocalizedString(e.toFixed(2));return n+" < "+i}})}(),function(){STAT4YOU.namespace("STAT4YOU.Map.CredistView");var t=STAT4YOU.svg.SVGNode;STAT4YOU.Map.CredistView=Backbone.View.extend({render:function(){var e=new t("text");e.node.textContent="stat4you.com",e.set({"class":"credits"});var n=new t(this.el);n.append(e);var i={width:$(this.options.container).width(),height:$(this.options.container).height()};e.alignBottomRight(i,0,0)}})}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Map.RangesView"),STAT4YOU.Map.RangesView=Backbone.View.extend({_templateRanges:STAT4YOU.templateManager.get("widget/map/map-ranges"),events:{"mousedown #draggable":"_handleMouseDown","click #line":"_handleClick"},initialize:function(){this._pressed=!1,this._setUpListeners()},render:function(){this.$RangesContainer=$(this._templateRanges()),this.$el.html(this.$RangesContainer),this._storeInitialCSSInfo(),this._setDraggingDivPositionAndPageX()},destroy:function(){this.$el.remove(),$(document).unbind("mousemove"),$(document).unbind("mouseup"),this.$el.unbind("mousewheel")},updateRanges:function(){this.render()},_setUpListeners:function(){_.bindAll(this),$(document).bind("mousemove",this._handleMouseMove),$(document).bind("mouseup",this._handleMouseUp),this.$el.bind("mousewheel",this._handleMousewheel)},_storeInitialCSSInfo:function(){var t=this.model.get("minRangesNum"),e=this.model.get("maxRangesNum"),n=e-t+1;this.$currentRange=$("#draggable"),this.$rangesLine=$("#line"),this._maxLeft=this.$rangesLine.width(),this._increment=this._calculateIncrementPixels(this._maxLeft,n)},_calculateIncrementPixels:function(t,e){var n=e-1;return t/n},_getDraggableDivLeft:function(){var t=this.model.get("currentRangesNum");return(t-1)*this._increment},_setDraggingDivPositionAndPageX:function(){this._draggableDivLeft=this._getDraggableDivLeft(),this.$currentRange.css("left",this._draggableDivLeft),this._draggablePageX=this.$currentRange.offset().left},_isMovementLongEnough:function(t){var e;return e=Math.abs(t)>=this._increment?!0:!1},_movingLeft:function(){var t=this.model.get("currentRangesNum"),e=this.model.get("minRangesNum");t>e&&this.model.set("currentRangesNum",t-1)},_movingRight:function(){var t=this.model.get("currentRangesNum"),e=this.model.get("maxRangesNum");e>t&&this.model.set("currentRangesNum",t+1)},_handleMouseDown:function(t){this._pressed=!0,this._draggablePageX=t.pageX,t.preventDefault()},_handleMouseUp:function(){this._pressed=!1},_handleMouseMove:function(t){if(this._pressed){var e=t.pageX-this._draggablePageX;this._isMovementLongEnough(e)&&(e>0?this._movingRight():0>e&&this._movingLeft())}},_handleMousewheel:function(t,e){return e>0?this._movingRight():0>e&&this._movingLeft(),!1},_handleClick:function(t){var e=t.pageX-this._draggablePageX;return e>0?this._movingRight():0>e&&this._movingLeft(),!1}})}(),function(){STAT4YOU.namespace("STAT4YOU.Map.MapModel"),STAT4YOU.Map.MapModel=Backbone.Model.extend({defaults:{minScale:1,maxScale:32,scaleFactor:2,currentScale:1,x:0,y:0,animationDelay:0,minValue:0,maxValue:40,values:[1],minRangesNum:1,maxRangesNum:10,currentRangesNum:5},zoomExit:function(){this.set({currentScale:2,x:0,y:0,animationDelay:1e3}),this.trigger("zoomExit")},zoomIn:function(){var t=this.get("currentScale"),e=this.get("scaleFactor"),n=t*e;this.isRequestedZoomAllowed(1)&&this.set({currentScale:n,animationDelay:500})},zoomOut:function(){var t=this.get("currentScale"),e=this.get("scaleFactor"),n=t/e;this.isRequestedZoomAllowed(-1)&&this.set({currentScale:n,animationDelay:500})},zoomMouseWheel:function(t){var e=this.get("currentScale"),n=Math.pow(2,t.delta)*e;n>this.get("maxScale")&&(n=this.get("maxScale")),this.get("minScale")>n&&(n=this.get("minScale"));var i=this.get("x")-this.scaleMovement(t.xOffset,e)+this.scaleMovement(t.xOffset,n),r=this.get("y")-this.scaleMovement(t.yOffset,e)+this.scaleMovement(t.yOffset,n);this.set({currentScale:n,x:i,y:r,animationDelay:0})},currentZoomLevel:function(){var t=this.get("currentScale");return this._log2(t)},numZoomLevels:function(){var t=this.get("maxScale");return this._log2(t)},transformToValidScaleFactor:function(t){var e=this._log2(t),n=parseInt(e),i=Math.pow(2,n);return this.isNewScaleFactorTooBig(i)?i=this.get("maxScale"):this.isNewScaleFactorTooSmall(i)&&(i=this.get("minScale")),i},isRequestedZoomAllowed:function(t){var e=this.get("currentScale"),n=this.get("maxScale"),i=this.get("minScale");return t>0?n>e:e>i},isNewScaleFactorTooBig:function(t){var e=this.get("maxScale");return t>e},isNewScaleFactorTooSmall:function(t){var e=this.get("minScale");return e>t},scaleMovement:function(t,e){var n=e||this.get("currentScale");return t/n},_log2:function(t){return Math.log(t)/Math.log(2)}})}(),function(){STAT4YOU.namespace("STAT4YOU.Map.ShapesApi"),STAT4YOU.Map.ShapesApi=function(){},STAT4YOU.Map.ShapesApi.prototype={_prepareRequestParams:function(t,e){var n={normCodes:_.compact(t)},i={url:e,dataType:"json"};return n.normCodes.length>100?(i.type="POST",i.contentType="application/json",i.data=JSON.stringify(n)):(i.type="GET",i.data=n,i.traditional=!0),i},getShapes:function(t){var e=STAT4YOU.apiContext+"/maps/shapes",n=this._prepareRequestParams(t,e);return $.ajax(n).then(function(t){return STAT4YOU.Map.GeoJsonConverter.geoJsonToShapeList(t)})},getContainer:function(t){var e=STAT4YOU.apiContext+"/maps/container",n=this._prepareRequestParams(t,e);return $.ajax(n)}}}(),function(){"use strict";var t=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB;window.IDBTransaction||window.webkitIDBTransaction||window.msIDBTransaction,window.IDBKeyRange||window.webkitIDBKeyRange||window.msIDBKeyRange;var e="shapes",n="shapes";STAT4YOU.namespace("STAT4YOU.Map.ShapesStore"),STAT4YOU.Map.ShapesStore=function(){var t;return t=STAT4YOU.Map.ShapesStore.hasIndexedDbSupport()?new STAT4YOU.Map.ShapesIndexedDbStore:new STAT4YOU.Map.ShapesHashStore},STAT4YOU.Map.ShapesStore.hasIndexedDbSupport=function(){return!_.isUndefined(t)},STAT4YOU.Map.ShapesIndexedDbStore=function(){},STAT4YOU.Map.ShapesIndexedDbStore.prototype={_dbOpen:function(){var i=new $.Deferred;if(this._db)i.resolveWith(null,[this._db]);else{var r=parseInt(STAT4YOU.configuration["map.version"],10)||1,a=t.open(e,r),s=this;a.onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains(n)&&e.deleteObjectStore(n),e.createObjectStore(n,{keyPath:"normCode",autoIncrement:!1})},a.onerror=function(){i.reject()},a.onsuccess=function(t){s._db=t.target.result,i.resolveWith(null,[s._db])}}return i.promise()},_dbExecute:function(t){var e=new $.Deferred,n=this._dbOpen();return n.done(function(n){t(n,e)}),n.fail(function(){console.log("Error opening db")}),e.promise()},save:function(t){t=_.isArray(t)?t:[t];var e=this,i=this._dbExecute(function(i,r){var a=i.transaction([n],"readwrite");a.onerror=e._dbError;var s=a.objectStore(n);_.each(t,function(t){s.put(t)}),a.oncomplete=function(){r.resolve()},a.onerror=function(){r.reject()}});return i},get:function(t){var e=this,i=this._dbExecute(function(i,r){var a=i.transaction([n]);a.onerror=e._dbError;var s,o=a.objectStore(n);_.isArray(t)?(s=[],_.each(t,function(t){t?o.get(t).onsuccess=function(t){s.push(t.target.result)}:s.push(void 0)})):t&&(o.get(t).onsuccess=function(t){s=t.target.result}),a.oncomplete=function(){r.resolveWith(null,[s])},a.onerror=function(){var t="Error";r.rejectWith(null,[t])}});return i},clear:function(){var t=this,e=this._dbExecute(function(e,i){var r=e.transaction([n],"readwrite");r.onerror=t._dbError;var a=r.objectStore(n),s=a.clear();s.onsuccess=function(){i.resolve()},s.onerror=function(){var t="Error";i.rejectWith(null,[t])}});return e}},STAT4YOU.Map.ShapesHashStore=function(){this.clear()},STAT4YOU.Map.ShapesHashStore.prototype={_getShape:function(t){return this._cache[t]},get:function(t){var e;e=_.isArray(t)?_.map(t,this._getShape,this):this._getShape(t);var n=new $.Deferred;return n.resolveWith(null,[e]),n},_saveShape:function(t){this._cache[t.normCode]=t},_emptyResolvedPromise:function(){var t=new $.Deferred;return t.resolve(),t.promise()},save:function(t){return _.isArray(t)?_.each(t,this._saveShape,this):this._saveShape(t),this._emptyResolvedPromise()},clear:function(){return this._cache={},this._emptyResolvedPromise()}}}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.Map.Shapes"),STAT4YOU.Map.Shapes=function(){this.store=new STAT4YOU.Map.ShapesStore,this.api=new STAT4YOU.Map.ShapesApi},STAT4YOU.Map.Shapes.prototype={_mixDbAndApiShapes:function(t,e){for(var n=[],i=0;t.length>i;i++)n[i]=_.isUndefined(t[i])?e.splice(0,1)[0]:t[i];return n},fetchShapes:function(t){var e=this,n=this.store.get(t).then(function(n){var i,r=_.chain(n).compact().pluck("normCode").value(),a=_.difference(_.compact(t),r);return 0!==a.length?(i=new $.Deferred,e.api.getShapes(a).done(function(t){e.store.save(t),i.resolveWith(null,[e._mixDbAndApiShapes(n,t)])}).fail(i.reject)):i=n,i});return n},fetchContainer:function(t){var e=this,n=_.compact(t);if(0==n.length)return(new $.Deferred).resolveWith(null,[[]]).promise();var i=this.api.getContainer(t).then(function(t){var n=t.normCode;return e.fetchShapes([n])}).then(function(t){return t?t[0]:void 0});return i}},_.extend(STAT4YOU.Map.Shapes.prototype,Backbone.Events)}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.VisualElementManager"),STAT4YOU.VisualElementManager=function(t){this._initialize(t)},STAT4YOU.VisualElementManager.prototype={_initialize:function(t){this._options=t,this.container=t.container,this.dataset=t.dataset,this.filterOptions=t.filterOptions,this._initializeVisualElements(),this._initializeFullScreen()},_initializeVisualElements:function(){var t={el:this._options.container.vecontainer,dataset:this.dataset,filterOptions:this.filterOptions,animation:this._options.animation};
this.ve={column:new STAT4YOU.VisualElement.ColumnChart(t),pie:new STAT4YOU.VisualElement.PieChart(t),line:new STAT4YOU.VisualElement.LineChart(t),canvasTable:new STAT4YOU.VisualElement.CanvasTable(t),map:new STAT4YOU.VisualElement.Map(t)},this.ve.map.on("didLoadVe",this._hideSpinner,this)},_initializeFullScreen:function(){this.fullScreen=new STAT4YOU.FullScreen({container:this.container.external}),this.fullScreen.on("willEnterFullScreen",this._willEnterFullScreen,this),this.fullScreen.on("didEnterFullScreen",this._didEnterFullScreen,this),this.fullScreen.on("willExitFullScreen",this._willExitFullScreen,this),this.fullScreen.on("didExitFullScreen",this._didExitFullScreen,this)},_showSpinner:function(){var t=STAT4YOU.resourceContext+"images/loadingSpinner.gif";this.$dataSpinner=$("<div class='spinner'><img src='"+t+"'/></div>");var e=$(this._options.container.vecontainer),n=e.height()/2-this.$dataSpinner.height()/2,i=e.width()/2-this.$dataSpinner.width()/2;this.$dataSpinner.css({top:n,left:i}),e.append(this.$dataSpinner)},_hideSpinner:function(){this.$dataSpinner&&(this.$dataSpinner.remove(),this.$dataSpinner=null)},loadVisualElement:function(t){var e=this.currentElement;this._removeCurrentElement(),this.currentElement=t,this._showSpinner(),this.ve[this.currentElement].updatingDimensionPositions(e),this.ve[this.currentElement].load()},load:function(){this.loadVisualElement(this.currentElement)},_removeCurrentElement:function(){var t=this._getCurrentVe();t&&(t.destroy(),$(this.container.vecontainer).empty())},_getCurrentVe:function(){return this.currentElement?this.ve[this.currentElement]:void 0},enterFullScreen:function(){this.fullScreen.enterFullScreen()},exitFullScreen:function(){this.fullScreen.exitFullScreen()},_willEnterFullScreen:function(){$(this._options.container.vecontainer).hide(),this.trigger("willEnterFullScreen")},_didEnterFullScreen:function(){$(this._options.container.vecontainer).show();var t=this._getCurrentVe();t.resizeFullScreen(),this.trigger("didEnterFullScreen")},_willExitFullScreen:function(){$(this._options.container.vecontainer).hide(),this.trigger("willExitFullScreen")},_didExitFullScreen:function(){$(this._options.container.vecontainer).show();var t=this._getCurrentVe();t.resizeFullScreen(),this.trigger("didExitFullScreen")}},_.extend(STAT4YOU.VisualElementManager.prototype,Backbone.Events)}(),function(){"use strict";STAT4YOU.namespace("STAT4YOU.FullScreen"),STAT4YOU.FullScreen=function(t){this.initialize(t)};var t="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element;STAT4YOU.FullScreen.prototype={FS_RESIZE_DELAY:300,events:{change:"fullscreenchange webkitfullscreenchange mozfullscreenchange",error:"mozfullscreenerror webkitfullscreenerror"},initialize:function(t){this.$container=t.container instanceof $?t.container:$(t.container),this.container=this.$container[0],this.$document=$(document),_.bindAll(this,"exitFullScreen","_keydown","_didExitFullScreen")},_getRequestFullScreen:function(){return this.container.requestFullscreen||this.container.webkitRequestFullScreen||this.container.mozRequestFullScreen||this.container.msRequestFullScreen},_getRequestExitFullScreen:function(){return document.exitFullscreen||document.mozCancelFullScreen||document.webkitCancelFullScreen},browserHasFullScreenSupport:function(){var t=this._getRequestFullScreen();return!_.isUndefined(t)},_enterFullScreenSupport:function(){this._getRequestFullScreen().call(this.container,t&&Element.ALLOW_KEYBOARD_INPUT),this._setFullScreenCss()},_enterFullScreenNoSupport:function(){this._setFullScreenCss()},enterFullScreen:function(){var t=this;if(this.trigger("willEnterFullScreen"),this.browserHasFullScreenSupport()){var e=function(){setTimeout(function(){t.$document.unbind(t.events.change,e),t.trigger("didEnterFullScreen"),t._addExitFullScreenListeners()},this.FS_RESIZE_DELAY)};t.$document.bind(t.events.change,e),t._enterFullScreenSupport()}else t._enterFullScreenNoSupport(),t._addExitFullScreenListeners(),t.trigger("didEnterFullScreen")},_addExitFullScreenListeners:function(){this.browserHasFullScreenSupport()?(this.$document.bind(this.events.change,this._didExitFullScreen),this.$document.bind(this.events.error,this._didExitFullScreen)):this.$document.bind("keydown",this._keydown)},_removeExitFullScreenListeners:function(){this.$document.unbind(this.events.change,this._didExitFullScreen),this.$document.unbind(this.events.error,this._didExitFullScreen),this.$document.unbind("keydown",this._keydown)},_keydown:function(t){27===t.which&&this.exitFullScreen()},exitFullScreen:function(){this.trigger("willExitFullScreen"),this.browserHasFullScreenSupport()?this._exitFullScreenSupport():this._exitFullScreenNoSupport()},_exitFullScreenSupport:function(){var t=this._getRequestExitFullScreen();t.call(document)},_exitFullScreenNoSupport:function(){this._didExitFullScreen()},_didExitFullScreen:function(){var t=this;setTimeout(function(){t._removeFullScreenCss(),t._removeExitFullScreenListeners(),t.trigger("didExitFullScreen")},this.FS_RESIZE_DELAY)},_setFullScreenCss:function(){this.browserHasFullScreenSupport()?this.$container.addClass("full-screen"):(this.$container.addClass("full-screen-no-support"),$(".navbar-fixed-top").css("position","static"))},_removeFullScreenCss:function(){this.browserHasFullScreenSupport()?this.$container.removeClass("full-screen"):(this.$container.removeClass("full-screen-no-support"),$(".navbar-fixed-top").css("position","fixed"))}},_.extend(STAT4YOU.FullScreen.prototype,Backbone.Events)}();